console.log("Marketo App > Running");window.mkto_live_extension_state="MarketoLive extension is alive!";var currentUrl=window.location.href,extensionMinVersion="5.0.0",devExtensionId="aahhkppadknlakhbppohbeolcfdhmocf",prodExtensionId="onibnnoghllldiecboelbpcaeggfiohl",extensionId=prodExtensionId,mktoAppDomain="^https:\/\/app-[a-z0-9]+\.marketo\.com",mktoDesignerDomain="^https:\/\/[a-z0-9]+-[a-z0-9]+\.marketodesigner\.com",mktoDesignerHost="na-sjp.marketodesigner.com",mktoWizard=mktoAppDomain+"/m#",mktoEmailDesigner=mktoDesignerDomain+"/ds",mktoLandingPageDesigner=mktoDesignerDomain+"/lpeditor/",mktoEmailInsightsLink="http://www.marketolive.com/en/analytics/email-insights-summit-demo-1",mktoEmailDeliverabilityToolsLink="https://250ok.com/login",mktoDemoAccountMatch="^mktodemoaccount",mktoMyMarketoFragment="MM0A1",mktoCalendarFragment="CAL",mktoAnalyticsFragment="AR",mktoReportFragmentRegex=new RegExp("^AR[^!]+!$","i"),mktoModelerFragmentRegex=new RegExp("^RCM[^!]+!$","i"),mktoAnalyticsFragmentMatch=new RegExp("^AR[^!]+!$|^RCM[^!]+!$","i"),mktoModelerPreviewFragmentRegex=new RegExp("preview=true&approved=true/#RCM[^!]+!$","i"),mktoAnalyticsDefaultFragment="AH0A1ZN17",mktoAccountBasedMarketingFragment="ABM0A1",mktoAdBridgeSmartListFragment="SL1119566B2LA1",mktoAdminSalesforceFragment="SF0A1",mktoAdminRcaCustomFieldSync="CFS0B2",mktoPersonDetailPath="/leadDatabase/loadLeadDetail",mktoDefaultDiyLandingPageResponsiveEditFragment="LPE11822",mktoDefaultWorkspaceAssetId="15",mktoJapaneseWorkspaceAssetId="19848",mktoFinservWorkspaceAssetId="20806",mktoHealthcareWorkspaceAssetId="20826",mktoHigherEdWorkspaceAssetId="20846",mktoManufacturingWorkspaceAssetId="26410",mktoTechnologyWorkspaceAssetId="26489",mktoTravelLesiureWorkspaceAssetId="27588",mktoUserWorkspaceId=172,userWorkspaceName="My Workspace",waitAfterDiscard=2000,restoreEmailInsights,origEmailInsightsTileLink,origEmailInsightsMenuItemLink,currUrlFragment,currCompFragment,userName,accountString,adminUserNamesMatch="^mktodemolivemaster@marketo\.com$|^admin(\.[a-z]{0,2})?@(marketolive.com$|mktodemoaccount)|^mktodemoaccount[a-z0-9]*@marketo\.com$|^marketodemo.*@gmail\.com$",mktoAccountStringMaster="mktodemolivemaster",mktoAccountStringQe="globalsales",mktoAccountString106="mktodemoaccount106",mktoAccountString106d="mktodemoaccount106d",mktoAccountStringsMatch="^"+mktoAccountString106+"$|^"+mktoAccountString106d+"$",mktoWorkingFoldersToHide=new RegExp("^(Manufacturing|Health ?Care|Telecommunications)$","i"),mktoOperationalFolder=new RegExp("^_Operational","i"),mktoMasterMarketingActivitiesEnglishFragment="MA19A1",mktoMarketingActivitiesDefaultFragment="MA15A1",mktoMarketingActivitiesUserFragment="MA19802A1",mktoMarketingActivitiesJapaneseFragment="MA19848A1",mktoMarketingActivitiesFinservFragment="MA20806A1",mktoMarketingActivitiesHealthcareFragment="MA20826A1",mktoMarketingActivitiesHigherEdFragment="MA20846A1",mktoMarketingActivitiesManufacturingFragment="MA26410A1",mktoMarketingActivitiesTechnologyFragment="MA26489A1",mktoMarketingActivitiesTravelLeisureFragment="MA27588A1",mktoMasterLeadDatabaseEnglishFragment="ML0A1ZN5",mktoLeadDatabaseDefaultFragment="ML0A1ZN2",mktoLeadDatabaseUserFragment="ML0A1ZN19788",mktoLeadDatabaseJapaneseFragment="ML0A1ZN19834",mktoLeadDatabaseFinservFragment="ML0A1ZN20792",mktoLeadDatabaseHealthcareFragment="ML0A1ZN20812",mktoLeadDatabaseHigherEdFragment="ML0A1ZN20832",mktoLeadDatabaseManufacturingFragment="ML0A1ZN26396",mktoLeadDatabaseTechnologyFragment="ML0A1ZN26475",mktoLeadDatabaseTravelLeisureFragment="ML0A1ZN27574",mktoAdminEmailEmailFragment="EA0A1",mktoAdminWebServicesFragment="MW0A1",mktoDisableButtonsFragmentMatch="^("+mktoMasterMarketingActivitiesEnglishFragment+"|"+mktoMarketingActivitiesDefaultFragment+"|"+mktoMarketingActivitiesUserFragment+"|"+mktoMarketingActivitiesJapaneseFragment+"|"+mktoMarketingActivitiesFinservFragment+"|"+mktoMarketingActivitiesHealthcareFragment+"|"+mktoMarketingActivitiesHigherEdFragment+"|"+mktoMarketingActivitiesManufacturingFragment+"|"+mktoMarketingActivitiesTechnologyFragment+"|"+mktoMarketingActivitiesTravelLeisureFragment+"|"+mktoMasterLeadDatabaseEnglishFragment+"|"+mktoLeadDatabaseDefaultFragment+"|"+mktoLeadDatabaseUserFragment+"|"+mktoLeadDatabaseJapaneseFragment+"|"+mktoLeadDatabaseFinservFragment+"|"+mktoLeadDatabaseHealthcareFragment+"|"+mktoLeadDatabaseHigherEdFragment+"|"+mktoLeadDatabaseManufacturingFragment+"|"+mktoLeadDatabaseTechnologyFragment+"|"+mktoLeadDatabaseTravelLeisureFragment+"|"+mktoAdminEmailEmailFragment+"|"+mktoAdminWebServicesFragment+")$",mktoOppInfluenceAnalyzerFragment="AR1559A1!",mktoProgramAnalyzerFragment="AR1544A1!",mktoModelerFragment="RCM70A1!",mktoSuccessPathAnalyzerFragment="AR1682A1!",mktoAnalyzersFragmentMatch="^"+mktoOppInfluenceAnalyzerFragment+"$|^"+mktoProgramAnalyzerFragment+"$|^"+mktoModelerFragment+"$|^"+mktoSuccessPathAnalyzerFragment+"$",mktoMobilePushNotificationFragment="MPN",mktoInAppMessageFragment="IAM",mktoSmsMessageFragment="SMS",mktoSocialAppFragment="SOA",mktoOtherAssetsFragmentMatch="^"+mktoMobilePushNotificationFragment+"|^"+mktoInAppMessageFragment+"|^"+mktoSmsMessageFragment+"|^"+mktoSocialAppFragment,mktoAbmDiscoverMarketoCompaniesFragment="ABMDM",mktoAbmDiscoverCrmAccountsFragment="ABMDC",mktoAbmNamedAccountFragment="NA",mktoAbmFragmentMatch="^"+mktoAbmDiscoverMarketoCompaniesFragment+"$|^"+mktoAbmDiscoverCrmAccountsFragment+"$|^"+mktoAbmNamedAccountFragment+"$",mktoEmailEditFragment="EME",mktoEmailPreviewFragmentRegex=new RegExp("^EME[0-9]+&isPreview","i"),mktoEmailPreviewFragment2="EME[0-9]+&isPreview",mktoEmailPreviewFragment="EMP",mktoEmailTemplateEditFragment="EMTE",mktoLandingPageEditFragment="LPE",mktoLandingPagePreviewFragment="LPP",mktoLandingPagePreviewDraftFragment="LPPD",mktoLandingPageTemplateEditFragment="LPTE",mktoLandingPageTemplatePreviewFragment="LPTPD",mktoFormEditFragment="FOE",mktoFormPreviewFragment="FOP",mktoFormPreviewDraftFragment="FOPD",mktoPushNotificationEditFragment="MPNE",mktoMobilePushNotificationPreviewFragment="MPNP",mktoInAppMessageEditFragment="IAME",mktoInAppMessagePreviewFragment="IAMP",mktoSmsMessageEditFragment="SME",mktoSocialAppEditFragment="SOAE",mktoSocialAppPreviewFragment="SOAP",mktoAbTestEditFragment="EBE",mktoEmailTestGroupEditFragment="CCE",mktoSnippetEditFragment="SNE",mktoSnippetPreviewFragment="SNP",mktoDesignersFragmentMatch="^"+mktoEmailEditFragment+"$|^"+mktoEmailPreviewFragment2+"|^"+mktoEmailPreviewFragment+"$|^"+mktoEmailTemplateEditFragment+"$|^"+mktoLandingPageEditFragment+"$|^"+mktoLandingPagePreviewFragment+"$|^"+mktoLandingPagePreviewDraftFragment+"$|^"+mktoLandingPageTemplateEditFragment+"$|^"+mktoLandingPageTemplatePreviewFragment+"$|^"+mktoFormEditFragment+"$|^"+mktoFormPreviewFragment+"$|^"+mktoFormPreviewDraftFragment+"$|^"+mktoPushNotificationEditFragment+"$|^"+mktoMobilePushNotificationPreviewFragment+"$|^"+mktoInAppMessageEditFragment+"$|^"+mktoInAppMessagePreviewFragment+"$|^"+mktoSmsMessageEditFragment+"$|^"+mktoSocialAppEditFragment+"$|^"+mktoSocialAppPreviewFragment+"$|^"+mktoAbTestEditFragment+"$|^"+mktoEmailTestGroupEditFragment+"$|^"+mktoSnippetEditFragment+"$|^"+mktoSnippetPreviewFragment+"$",mktoDefaultWorkspaceId=1,mktoJapaneseWorkspaceId=173,mktoFinservWorkspaceId=174,mktoHealthcareWorkspaceId=175,mktoHigherEdWorkspaceId=176,mktoManufacturingWorkspaceId=184,mktoTechnologyWorkspaceId=185,mktoTravelLesiureWorkspaceId=186,mktoUnknownWorkspaceId=-1,mktoGoldenWorkspacesMatch="^"+mktoDefaultWorkspaceId+"$|^"+mktoJapaneseWorkspaceId+"$|^"+mktoFinservWorkspaceId+"$|^"+mktoHealthcareWorkspaceId+"$|^"+mktoHigherEdWorkspaceId+"$|^"+mktoManufacturingWorkspaceId+"$|^"+mktoTechnologyWorkspaceId+"$|^"+mktoTravelLesiureWorkspaceId+"$|^"+mktoUnknownWorkspaceId+"$",origMenuShowAtFunc,APP=APP||{};APP.getCookie=function(cookieName){console.log("Marketo App > Getting: Cookie "+cookieName);var name=cookieName+'=',cookies=document.cookie.split(';'),currCookie;for(var ii=0;ii<cookies.length;ii++){currCookie=cookies[ii].trim();if(currCookie.indexOf(name)==0){return currCookie.substring(name.length,currCookie.length);}}
console.log("Marketo App > Getting: Cookie "+cookieName+" not found");return null;};APP.webRequest=function(url,params,method,async,responseType,callback){console.log("Web Request > "+url+"\n"+params);var xmlHttp=new XMLHttpRequest(),result;xmlHttp.onreadystatechange=function(){if(callback&&xmlHttp.readyState==4&&xmlHttp.status==200)
result=callback(xmlHttp.response);}
if(async&&xmlHttp.responseType){xmlHttp.responseType=responseType;}
xmlHttp.open(method,url,async);xmlHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8");xmlHttp.setRequestHeader("X-Requested-With","XMLHttpRequest");xmlHttp.send(params);return result;};APP.validateDemoExtensionCheck=function(isValidExtension){console.log("Marketo App > Validating: Demo Extension Check");if(isValidExtension){window.mkto_live_extension_state="MarketoLive extension is alive!";console.log("Marketo App > Validating: Demo Extension IS Valid");}else if(MktPage&&MktPage.validateDemoExtension){window.mkto_live_extension_state=null;MktPage.validateDemoExtension(new Date());console.log("Marketo App > Validating: Demo Extension IS NOT Valid");}};APP.getWorkspaceName=function(workspaceId){var workspaceName;switch(workspaceId){case mktoDefaultWorkspaceId:workspaceName="Default";break;case mktoJapaneseWorkspaceId:workspaceName="デモ";break;case mktoFinservWorkspaceId:workspaceName="Financial Services";break;case mktoHealthcareWorkspaceId:workspaceName="Healthcare";break;case mktoHigherEdWorkspaceId:workspaceName="Higher Education";break;case mktoManufacturingWorkspaceId:workspaceName="Manufacturing";break;case mktoTechnologyWorkspaceId:workspaceName="Technology";break;case mktoTravelLesiureWorkspaceId:workspaceName="Travel Leisure";break;case mktoUserWorkspaceId:workspaceName=userWorkspaceName;break;default:workspaceName="Unknown";break;}
return workspaceName;};APP.disablePropertyPanelSaving=function(){console.log("Marketo App > Disabling: Saving of Landing Page Property Panel & Sync Error Message");if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.controller&&Mkt3.controller.editor&&Mkt3.controller.editor.LandingPagePropertyPanel&&Mkt3.controller.editor.LandingPagePropertyPanel.prototype&&Mkt3.controller.editor.LandingPagePropertyPanel.prototype.fireSyncProperties){Mkt3.controller.editor.LandingPagePropertyPanel.prototype.fireSyncProperties=function(){console.log("Marketo App > Executing: Disable Saving of Landing Page Property Panel & Sync Error Message");};}};APP.disableConfirmationMessage=function(){console.log("Marketo App > Disabling: Smart Campaign Delete Confirmation Message");if(typeof(Mkt)!=="undefined"&&Mkt3&&Mkt.widgets&&Mkt.widgets.DataPanel&&Mkt.widgets.DataPanel.prototype&&Mkt.widgets.DataPanel.prototype.clickClose){Mkt.widgets.DataPanel.prototype.clickClose=function(){console.log("Marketo App > Executing: Disable Smart Campaign Delete Confirmation Message");var hasChanges=this.hasSettings(),showTriggerWarning=false;if(this.isSmartlist&&this.dpMeta.trigger){var triggerCount=this.dpMgr.getTriggers().length;if(triggerCount==1){showTriggerWarning=true;}}
if(hasChanges||showTriggerWarning){var title=MktLang.getStr('DataFormPanel.Delete_arg0',[this.dpTypeName(true)]),name=this.dpMeta.displayName||this.dpMeta.name,msg=MktLang.getStr('DataFormPanel.Are_you_sure_you_want_to_delete_arg0_arg1',[this.dpTypeName(),MktLang.getDBStr(name)]);if(showTriggerWarning){msg+=MktLang.getStr("DataFormPanel.Triggered_campaigns_must_contain_trigger_remain_active");}
if(this.dpMgr.isSmartlist&&!this.dpMeta.trigger&&this.dpMgr.smartListRuleLogic.customMode()){msg+=MktLang.getStr('DataFormPanel.Reminder')+MktLang.getStr('DataFormPanel.Check_your_advanced_filter_rules_after_any_insert_delete_reorder');}
if(typeof(MktCanvas)!=="undefined"&&MktCanvas&&MktCanvas.getActiveTab()&&MktCanvas.getActiveTab().config&&MktCanvas.getActiveTab().config.accessZoneId){console.log("Marketo App > Closing: Smart Campaign Delete Confirmation Message");this._doClose();}else{Ext4.Msg.confirmDelete({title:title,msg:msg,minHeight:300,fn:function(buttonId){if(buttonId==='ok'){this._doClose();}},scope:this});}}else{this._doClose();}};}};APP.overrideHomeTiles=function(restoreEmailInsightsTile){console.log("Marketo App > Overriding: My Marketo Home Tiles");if(typeof(MktCanvas)!=="undefined"&&MktCanvas&&MktCanvas.getEl()&&MktCanvas.getEl().dom&&MktCanvas.getEl().dom.nextSibling&&MktCanvas.getEl().dom.nextSibling.childNodes&&MktCanvas.getEl().dom.nextSibling.childNodes[0]&&MktCanvas.getEl().dom.nextSibling.childNodes[0].childNodes&&MktCanvas.getEl().dom.nextSibling.childNodes[0].childNodes[0]&&MktCanvas.getEl().dom.nextSibling.childNodes[0].childNodes[0].childNodes&&MktCanvas.getEl().dom.nextSibling.childNodes[0].childNodes[0].childNodes[0]&&MktCanvas.getEl().dom.nextSibling.childNodes[0].childNodes[0].childNodes[0].childNodes&&MktCanvas.getEl().dom.nextSibling.childNodes[0].childNodes[0].childNodes[0].childNodes[0]&&MktCanvas.getEl().dom.nextSibling.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes&&MktCanvas.getEl().dom.nextSibling.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0]&&MktCanvas.getEl().dom.nextSibling.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes&&MktCanvas.getEl().dom.nextSibling.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0]&&MktCanvas.getEl().dom.nextSibling.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes){console.log("Marketo App > Executing: Override My Marketo Home Tiles");var container=MktCanvas.getEl().dom.nextSibling.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0],containerComponent=MktCanvas.lookupComponent(container),tilesTextContent=containerComponent.el.dom.textContent.replace(/([a-z])([A-Z])/g,"$1,$2").replace(/([A-Z])([A-Z][a-z])/g,"$1,$2").split(','),hrefMatch=new RegExp(" href=\"[^\"]*\" ","g"),idMatch,spareTileClone,emailInsightsTile,emailInsightsTileOuterHTML,deliverabilityToolsTile,deliverabilityToolsTileOuterHTML,ii;for(ii=0;ii<tilesTextContent.length;ii++){if(tilesTextContent[ii]=="Email Insights"){emailInsightsTile=MktCanvas.lookupComponent(container.childNodes[ii]);}else if(tilesTextContent[ii]=="Deliverability Tools"){deliverabilityToolsTile=MktCanvas.lookupComponent(container.childNodes[ii]);}}
if(emailInsightsTile){if(origEmailInsightsTileLink==null){origEmailInsightsTileLink=emailInsightsTile.el.dom.outerHTML.match(hrefMatch)[0].split('"')[1];}
if(restoreEmailInsightsTile&&origEmailInsightsTileLink!=null){emailInsightsTile.el.dom.outerHTML=emailInsightsTile.el.dom.outerHTML.replace(hrefMatch," href=\""+origEmailInsightsTileLink+"\" ");}else{emailInsightsTile.el.dom.outerHTML=emailInsightsTile.el.dom.outerHTML.replace(hrefMatch," href=\""+mktoEmailInsightsLink+"\" ");}}else{emailInsightsTileOuterHTML='<div class="x4-btn mkt3-homeTile x4-btn-default-small x4-icon-text-left x4-btn-icon-text-left x4-btn-default-small-icon-text-left x-panel" style="height: 150px;" id="homeTile-1084"><em id="homeTile-1084-btnWrap"><a id="homeTile-1084-btnEl" href="'+mktoEmailInsightsLink+'" class="x4-btn-center" target="_blank" role="link" style="width: 150px; height: 150px;"><span id="homeTile-1084-btnInnerEl" class="x4-btn-inner" style="width: 150px; height: 150px; line-height: 150px;">Email Insights</span><span id="homeTile-1084-btnIconEl" class="x4-btn-icon mki3-email-insights-svg"></span></a></em><div class="x-panel-bwrap" id="ext-gen164"><div class="x-panel-body x-panel-body-noheader" id="ext-gen165"></div></div></div>';idMatch=new RegExp("homeTile-1084","g");spareTileClone=MktCanvas.lookupComponent(container.childNodes[container.childNodes.length-1]).cloneConfig();emailInsightsTileOuterHTML=emailInsightsTileOuterHTML.replace(idMatch,spareTileClone.id);spareTileClone.el.dom.outerHTML=emailInsightsTileOuterHTML;container.appendChild(container.childNodes[container.childNodes.length-2]);container.appendChild(spareTileClone.el.dom);}
if(deliverabilityToolsTile){deliverabilityToolsTile.el.dom.outerHTML=deliverabilityToolsTile.el.dom.outerHTML.replace(hrefMatch," href=\""+mktoEmailDeliverabilityToolsLink+"\" ");}else{deliverabilityToolsTileOuterHTML='<div class="x4-btn mkt3-homeTile x4-btn-default-small x4-icon-text-left x4-btn-icon-text-left x4-btn-default-small-icon-text-left" style="height: 150px;" id="homeTile-1036"><em id="homeTile-1036-btnWrap"><a id="homeTile-1036-btnEl" href="'+mktoEmailDeliverabilityToolsLink+'" class="x4-btn-center" target="_blank" role="link" style="width: 150px; height: 150px;"><span id="homeTile-1036-btnInnerEl" class="x4-btn-inner" style="width: 150px; height: 150px; line-height: 150px;">Deliverability Tools</span><span id="homeTile-1036-btnIconEl" class="x4-btn-icon mki3-mail-sealed-svg"></span></a></em></div>';idMatch=new RegExp("homeTile-1036","g");spareTileClone=MktCanvas.lookupComponent(container.childNodes[container.childNodes.length-1]).cloneConfig();deliverabilityToolsTileOuterHTML=deliverabilityToolsTileOuterHTML.replace(idMatch,spareTileClone.id);spareTileClone.el.dom.outerHTML=deliverabilityToolsTileOuterHTML;container.appendChild(container.childNodes[container.childNodes.length-2]);container.appendChild(spareTileClone.el.dom);}}};APP.overrideSuperballMenuItems=function(restoreEmailInsightsMenuItem){console.log("Marketo App > Overriding: Superball Menu Items");if(typeof(MktPage)!=="undefined"&&MktPage&&MktPage.showSuperMenu){MktPage.showSuperMenu=function(){console.log("Marketo App > Executing: Override Superball Menu Items");var logoEl=Ext.get(Ext.DomQuery.selectNode('.mkt-app-logo')),menu=logoEl.menu,menuTop=55;if(!menu){menu=logoEl.menu=Ext4.widget('appNavigationMenu',{listeners:{boxready:function(view){var logoRegion=logoEl.getRegion();if(logoRegion.bottom>menuTop){view.setBodyStyle('padding-top',logoRegion.bottom-menuTop+10+'px');view.updateLayout();}
menu.setZIndex(logoEl.getStyle('zIndex')-5);},beforerender:function(view){view.addCls(view.componentCls+'-hidden');},show:function(view){view.removeCls(view.componentCls+'-hidden');logoEl.ignoreNextClick=true;logoEl.removeClass(logoEl.attentionCls);if(!MktPage.savedState.isUsedSuperMenu){MktPage.savedState.isUsedSuperMenu=true;MktSession.ajaxRequest('user/saveUserPref',{serializeParms:{key:'isUsedSuperMenu',data:MktPage.savedState.isUsedSuperMenu}});}},beforehide:function(view){view.addCls(view.componentCls+'-hidden');},hide:function(){(function(){logoEl.ignoreNextClick=false;}).defer(250);}}});if(typeof(menu)!=="undefined"&&menu&&menu.items&&menu.items.items){console.log("Marketo App > Working: Override Superball Menu Items");var ii,currSuperBallMenuItem,emailInsightsMenuItem,deliverabilityToolsMenuItem,clonedMenuItem;for(ii=0;ii<menu.items.items.length;ii++){currSuperBallMenuItem=menu.items.items[ii];if(currSuperBallMenuItem.text=="Email Insights"){emailInsightsMenuItem=currSuperBallMenuItem;}else if(currSuperBallMenuItem.text=="Deliverability Tools"){deliverabilityToolsMenuItem=currSuperBallMenuItem;}}
if(emailInsightsMenuItem){if(origEmailInsightsMenuItemLink==null){origEmailInsightsMenuItemLink=emailInsightsMenuItem.href;}
if(restoreEmailInsightsMenuItem&&origEmailInsightsMenuItemLink!=null){emailInsightsMenuItem.href=origEmailInsightsMenuItemLink;}else{emailInsightsMenuItem.href=mktoEmailInsightsLink;}
emailInsightsMenuItem.update();}else{clonedMenuItem=menu.items.items[0].cloneConfig();clonedMenuItem.setText("Email Insights");clonedMenuItem.setIconCls("mki3-email-insights-svg");clonedMenuItem.href=mktoEmailInsightsLink;clonedMenuItem.hrefTarget="_blank";clonedMenuItem.update();menu.add(clonedMenuItem);}
if(deliverabilityToolsMenuItem){deliverabilityToolsMenuItem.href=mktoEmailDeliverabilityToolsLink;deliverabilityToolsMenuItem.update();}else{clonedMenuItem=menu.items.items[0].cloneConfig();clonedMenuItem.setText("Deliverability Tools");clonedMenuItem.setIconCls("mki3-mail-sealed-svg");clonedMenuItem.href=mktoEmailDeliverabilityToolsLink;clonedMenuItem.hrefTarget="_blank";clonedMenuItem.update();menu.add(clonedMenuItem);}}}
if(!menu.isVisible()&&!logoEl.ignoreNextClick){menu.showAt(0,menuTop);menu.setZIndex(logoEl.getStyle('zIndex')-5);}};}};APP.overrideAnalyticsTiles=function(){console.log("Marketo App > Overriding: Analytics Tiles");var isAnalyticsTiles=window.setInterval(function(){if(typeof(MktPage)!=="undefined"&&typeof(MktCanvas)!=="undefined"&&typeof(MktCanvas.getActiveTab().config.mkt3XType)!=="undefined"){window.clearInterval(isAnalyticsTiles);if(MktPage&&MktPage.savedState&&MktPage.savedState.custPrefix.search(mktoAccountStringsMatch)!=-1&&MktCanvas&&MktCanvas.getActiveTab()&&MktCanvas.getActiveTab().config&&MktCanvas.getActiveTab().config.mkt3XType=="analyticsHome"&&MktCanvas.getActiveTab().config.accessZoneId==mktoDefaultWorkspaceId&&MktCanvas.getActiveTab().el&&MktCanvas.getActiveTab().el.dom&&MktCanvas.getActiveTab().el.dom.childNodes&&MktCanvas.getActiveTab().el.dom.childNodes[0]&&MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes&&MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1]&&MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes&&MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0]&&MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes&&MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0]&&MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes&&MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0]&&MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes&&MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0]&&MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes){console.log("Marketo App > Executing: Analytics Tiles");var ii,currTileHTML,tiles=MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes,host="https://app-sjp.marketo.com";for(ii=0;ii<tiles.length;ii++){if(tiles[ii]&&tiles[ii].outerHTML&&tiles[ii].textContent){currTileHTML=tiles[ii].outerHTML;switch(tiles[ii].textContent){case"Email Performance":currTileHTML='<a href="'+host+'/#AR3866B2">'+currTileHTML+'</a>';MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;case"Lead Performance":currTileHTML='<a href="'+host+'/#AR3874B2">'+currTileHTML+'</a>';MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;case"Web Page Activity":currTileHTML='<a href="'+host+'/#AR3876B2">'+currTileHTML+'</a>';MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;case"Opportunity Influence Analyzer":currTileHTML='<a href="'+host+'/#AR1559A1">'+currTileHTML+'</a>';MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;case"Program Analyzer":currTileHTML='<a href="'+host+'/#AR1544A1">'+currTileHTML+'</a>';MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;case"Success Path Analyzer":currTileHTML='<a href="'+host+'/#AR1682A1">'+currTileHTML+'</a>';MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;case"Revenue Explorer":break;case"Email Insights":var hrefMatch=new RegExp(' href=\"[^\"]*\" ','g');currTileHTML=currTileHTML.replace(hrefMatch,' href=\"'+mktoEmailInsightsLink+'\" ');MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;case"Engagement Stream Performance":currTileHTML='<a href="'+host+'/#AR3881B2">'+currTileHTML+'</a>';MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;case"Program Performance":currTileHTML='<a href="'+host+'/#AR3882B2">'+currTileHTML+'</a>';MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;case"Email Link Performance":currTileHTML='<a href="'+host+'/#AR3886B2">'+currTileHTML+'</a>';MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;case"Social Influence":break;case"Leads By Revenue Stage":currTileHTML='<a href="'+host+'/#AR3889B2">'+currTileHTML+'</a>';MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;case"Landing Page Performance":currTileHTML='<a href="'+host+'/#AR3891B2">'+currTileHTML+'</a>';MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;case"Leads By Status":currTileHTML='<a href="'+host+'/#AR3893B2">'+currTileHTML+'</a>';MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;case"Company Web Activity":currTileHTML='<a href="'+host+'/#AR3901B2">'+currTileHTML+'</a>';MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;case"Sales Insight Email Performance":currTileHTML='<a href="'+host+'/#AR3903B2">'+currTileHTML+'</a>';MktCanvas.getActiveTab().el.dom.childNodes[0].childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[ii].outerHTML=currTileHTML;break;default:break;}}}}}},0);};APP.overrideSmartCampaignSaving=function(){console.log("Marketo App > Overriding: Saving for Smart Campaigns");if(typeof(Mkt)!=="undefined"&&Mkt&&Mkt.widgets&&Mkt.widgets.DataPanelManager&&Mkt.widgets.DataPanelManager.prototype&&Mkt.widgets.DataPanelManager.prototype.save){Mkt.widgets.DataPanelManager.prototype.save=function(cause,dp,acceptUpdates){console.log("Marketo App > Executing: Override Saving for Smart Campaigns");this._updateDataPanelOrder(true);var canvas=MktCanvas.getActiveTab();if(!APP.evaluateMenu("button",null,canvas,null)&&toggleState!="false"){if(this.saveQueue.blockingSaveInProgress){this.saveQueue.pendingChangesCount++;this.saveQueue.dataPanelMetas=this._serializeDataPanels();this.saveQueue.dataPanelCount=this.countDataPanels();return;}
var dataPanelMetas;if(this.saveQueue.dataPanelMetas){dataPanelMetas=this.saveQueue.dataPanelMetas;}else{dataPanelMetas=this._serializeDataPanels();}
this.saveQueue.pendingChangesCount=0;this.saveQueue.dataPanelMetas=null;this.saveQueue.dataPanelCount=0;if(dataPanelMetas===null){return;}
if(dataPanelMetas.length===0&&this.isFlow){}
if(this.dpSubtype!=DPConst.RUN_ACTION&&dataPanelMetas){if(this.lastSave.dataPanelMetas&&this.lastSave.dataPanelMetas==dataPanelMetas){return;}else if(this.lastSave.dataPanelMetasUpdated&&this.lastSave.dataPanelMetasUpdated==dataPanelMetas){return;}}
console.debug('Saving '+this.dpType+':',MktFormat.formatJsonStr(dataPanelMetas));if(DPDEBUG){console.debug('Current Save:',dataPanelMetas);if(this.lastSave.dataPanelMetas){console.debug('Previous Save:',this.lastSave.dataPanelMetas);}
if(this.lastSave.dataPanelMetasUpdated){console.debug('Previous Update:',this.lastSave.dataPanelMetasUpdated);}}
this.lastSave.acceptUpdates=acceptUpdates;this.lastSave.dataPanelMetas=dataPanelMetas;this.saveQueue.blockingSaveInProgress=true;this.beforeSaveMessage();var params=Ext.apply({dataPanelMetas:dataPanelMetas,accessZoneId:this.accessZoneId},this.baseSaveParams);if(this.isSmartlist&&this.smartListRuleLogic.customMode()){if(this.smartListRuleLogic.isCustomLogicValid()){var smartListLogicParams=this.smartListRuleLogic.getSmartListLogicSaveParams();Ext.apply(params,smartListLogicParams);}else{console.debug('Data panel save successful. Custom rule logic is not valid');}}
params[this.appVarsBase+'Id']=this.dataPanelStorageId;this.beforeSaveHook();if(DPDEBUG){console.debug("Saving... ",params);}
MktSession.ajaxRequest(this.saveAction,{serializeParms:params,onMySuccess:this.saveSuccess.createDelegate(this),onMyFailure:this.saveFailure.createDelegate(this)});}else{console.log("Marketo App > Disabling: Saving for Smart Campaigns");}};}};APP.overrideSmartCampaignCanvas=function(){console.log("Marketo App > Overriding: Smart Campaign Canvases");if(typeof(Mkt)!=="undefined"&&Mkt&&Mkt.widgets&&Mkt.widgets.DataPanelLayout&&Mkt.widgets.DataPanelLayout.prototype&&Mkt.widgets.DataPanelLayout.prototype.initComponent){Mkt.widgets.DataPanelLayout.prototype.initComponent=function(){console.log("Marketo App > Executing: Override Smart Campaign Canvases");if(typeof(MktCanvas)!=="undefined"&&MktCanvas&&MktCanvas.getActiveTab()&&MktCanvas.getActiveTab().config&&MktCanvas.getActiveTab().config.accessZoneId==mktoDefaultWorkspaceId){console.log("Marketo App > Enabling: Smart Campaign Canvases");this.dpEditable=true;}
DPDEBUG=false;if(this.dpSubtype){this.addClass('mktDataPanelLayout-'+this.dpSubtype);}
if(this.canvas){MktCanvas.mask(this.canvas);}
if(this.dpType=='Smartlist'){this.isSmartlist=true;this.Flow=false;this.SETTINGS='conditions';}else if(this.dpType=='Flow'){this.isSmartlist=false;this.isFlow=true;this.SETTINGS='actions';}
this.items=[];this.items.push({region:'center',margins:!MktPage.isFeatureEnabled('carbolt')?'7 5 10 10':'',layout:'fit',items:this.createManager()});if(this.dpEditable&&this.canvas&&this.paletteWidth>0){this.canvasWidth=MktCanvas.getWidth();var availableWidth=Math.min(this.canvasWidth-700,this.maxPaletteWidth);this.paletteWidth=Math.max(this.paletteWidth,availableWidth);this.items.push({cls:'mktEastPanel',region:'east',margins:!MktPage.isFeatureEnabled('carbolt')?'5 5 5 8':'0 0 0 15',layout:'fit',width:this.paletteWidth,items:this.createPalette()});}
Mkt.widgets.DataPanelLayout.superclass.initComponent.apply(this);if(this.canvas){MktPage.canvasCleanupStack.push(this.canvasCleanup.createDelegate(this));}
if(this.canvas){this.extendCanvasToolbar();}
if(this.canvas){this.extendCanvasGutter();}
if(this.canvas){MktCanvas.addHook(this.canvas,{dp:this});}};}};APP.overrideUpdatePortletOrder=function(){console.log("Marketo App > Overriding: Updating of Portlet Order");if(typeof(Mkt)!=="undefined"&&Mkt&&Mkt.apps&&Mkt.apps.localasset&&Mkt.apps.localasset.LocalAssetPortal&&Mkt.apps.localasset.LocalAssetPortal.prototype&&Mkt.apps.localasset.LocalAssetPortal.prototype.updatePortletOrder){console.log("Marketo App > Executing: Override Updating of Portlet Order");Mkt.apps.localasset.LocalAssetPortal.prototype.updatePortletOrder=function(e){var canvas=MktCanvas.getActiveTab(),disable=APP.evaluateMenu("button",null,canvas,null);if(!disable){var newPortletOrder=[];for(var i=0;i<this.items.length;i++){var itemInfo=this.items.get(i).smartCampaignMetaData;newPortletOrder.push(itemInfo.compTypeId+":"+itemInfo.compId);}
var params={compId:this.programId,portletOrdering:Ext.encode(newPortletOrder)};MktSession.ajaxRequest('marketingEvent/orderLocalAssetPortlets',{serializeParms:params,localAssetManager:this,portletOrdering:newPortletOrder,onMySuccess:this.updatePortletOrderSuccess});}else{console.log("Marketo App > Disabling: Updating of Portlet Order");}};}};APP.overrideTreeNodeExpand=function(){console.log("Marketo App > Overriding: Tree Node Expand");if(typeof(MktAsyncTreeNode)!=="undefined"&&MktAsyncTreeNode&&MktAsyncTreeNode.prototype&&MktAsyncTreeNode.prototype.expand&&userName){MktAsyncTreeNode.prototype.expand=function(){var attr=this.attributes;if(this.text==userWorkspaceName||(this.parentNode.text==userWorkspaceName&&this.attributes.system==true)||(this.parentNode.parentNode!=null&&this.parentNode.parentNode.text==userWorkspaceName&&this.attributes.system==true)){for(var ii=0;ii<this.childNodes.length;ii++){var currFolder=this.childNodes[ii];if(currFolder.attributes.system==false&&currFolder.text.toLowerCase()!==userName){currFolder.ui.hide();currFolder.hidden=true;}}}else if(accountString==mktoAccountStringMaster&&this.attributes.accessZoneId==mktoDefaultWorkspaceId&&this.childNodes.length){if(this.attributes.compType=="Zone"){for(var ii=0;ii<this.childNodes.length;ii++){var currFolder=this.childNodes[ii];if(currFolder.attributes.system==false&&currFolder.attributes.compType=="Marketing Folder"&&currFolder.text.search(mktoWorkingFoldersToHide)!=-1){currFolder.ui.hide();currFolder.hidden=true;}}}else if(this.parentNode.attributes.compType=="Zone"&&this.attributes.system==false&&this.hidden==false&&this.attributes.compType=="Marketing Folder"){for(var ii=0;ii<this.childNodes.length;ii++){var currFolder=this.childNodes[ii];if(currFolder.attributes.system==false&&currFolder.attributes.compType=="Marketing Folder"&&currFolder.text.search(mktoOperationalFolder)!=-1){currFolder.ui.hide();currFolder.hidden=true;}}}}
if(attr.folder){if(attr.cancelFirstExpand){delete this.attributes.cancelFirstExpand;}else if(this.childNodes&&this.childNodes.length>0&&!attr.mktExpanded&&this.attributes&&this.attributes.accessZoneId){if(this.attributes.accessZoneId!=mktoUserWorkspaceId){MktFolder.saveExpandState(this,true);}else{console.log("Marketo App > NOT Saving: Folder Expand State");}}}
MktAsyncTreeNode.superclass.expand.apply(this,arguments);attr.mktExpanded=true;};}};APP.overrideTreeNodeCollapse=function(){console.log("Marketo App > Overriding: Tree Node Collapse");if(typeof(MktAsyncTreeNode)!=="undefined"&&MktAsyncTreeNode&&MktAsyncTreeNode.prototype&&MktAsyncTreeNode.prototype.collapse&&userName){MktAsyncTreeNode.prototype.collapse=function(){var attr=this.attributes,ii;if(this.text==userWorkspaceName||(this.parentNode.text==userWorkspaceName&&this.attributes.system==true)||(this.parentNode.parentNode!=null&&this.parentNode.parentNode.text==userWorkspaceName&&this.attributes.system==true)){for(ii=0;ii<this.childNodes.length;ii++){var currFolder=this.childNodes[ii];if(currFolder.attributes.system==false&&currFolder.text.toLowerCase()!==userName){currFolder.ui.hide();currFolder.hidden=currFolder.ui.elNode.hidden=true;}}}else if(accountString==mktoAccountStringMaster&&this.attributes.accessZoneId==mktoDefaultWorkspaceId&&this.childNodes.length){if(this.attributes.compType=="Zone"){for(var ii=0;ii<this.childNodes.length;ii++){var currFolder=this.childNodes[ii];if(currFolder.attributes.system==false&&currFolder.attributes.compType=="Marketing Folder"&&currFolder.text.search(mktoWorkingFoldersToHide)!=-1){currFolder.ui.hide();currFolder.hidden=true;}}}else if(this.parentNode.attributes.compType=="Zone"&&this.attributes.system==false&&this.hidden==false&&this.attributes.compType=="Marketing Folder"){for(var ii=0;ii<this.childNodes.length;ii++){var currFolder=this.childNodes[ii];if(currFolder.attributes.system==false&&currFolder.attributes.compType=="Marketing Folder"&&currFolder.text.search(mktoOperationalFolder)!=-1){currFolder.ui.hide();currFolder.hidden=true;}}}}
if(attr.suppressAjaxCollapse){delete this.attributes.suppressAjaxCollapse;}else if(isDefined(attr.folder)&&attr.folder&&attr.mktExpanded===true){MktFolder.saveExpandState(this,false);}
MktTreeNode.superclass.collapse.apply(this,arguments);attr.mktExpanded=false;};}};APP.overrideNewProgramCreate=function(){console.log("Marketo App > Overriding: New Program/Segmentation Creation");if(typeof(Mkt)!=="undefined"&&Mkt&&Mkt.widgets&&Mkt.widgets.ModalForm&&Mkt.widgets.ModalForm.prototype&&Mkt.widgets.ModalForm.prototype.okButtonHandler&&userName){Mkt.widgets.ModalForm.prototype.okButtonHandler=function(){console.log("Marketo App > Executing: New Program/Segmentation Creation");if(this.title=="New Program"||this.title=="New Segmentation"){var ii;if(this.title=="New Program"){if(this.getInputItems()){if(this.getInputItems()[1]&&this.getInputItems()[1].fieldLabel=="Name"){if(this.getInputItems()[1].getValue().toLowerCase().search(userName+"$")==-1){this.getInputItems()[1].setValue(this.getInputItems()[1].getValue()+" - "+userName);}}else{for(ii=0;ii<this.getInputItems().length;ii++){if(this.getInputItems()[ii]&&this.getInputItems()[ii].fieldLabel=="Name"){if(this.getInputItems()[ii].getValue().toLowerCase().search(userName+"$")==-1){this.getInputItems()[ii].setValue(this.getInputItems()[ii].getValue()+" - "+userName);}}}}}}else if(this.title=="New Segmentation"){if(this.findByType("textfield")){if(this.findByType("textfield")[0]&&this.findByType("textfield")[0].fieldLabel=="Name"){if(this.findByType("textfield")[0].getValue().toLowerCase().search(userName+"$")==-1){this.findByType("textfield")[0].setValue(this.findByType("textfield")[0].getValue()+" - "+userName);}}else{for(ii=0;ii<this.findByType("textfield").length;ii++){if(this.findByType("textfield")[ii]&&this.findByType("textfield")[ii].fieldLabel=="Name"){if(this.findByType("textfield")[ii].getValue().toLowerCase().search(userName+"$")==-1){this.findByType("textfield")[ii].setValue(this.findByType("textfield")[ii].getValue()+" - "+userName);}}}}}}}
if(this.submitInProgress){return;}
if(this.beforeSubmitCallback()===false){return;};if(this.okCallback&&isFunction(this.okCallback)){this.okCallback();}
if(!this.submitUrl){return;}
if(this.showProgressModal){this.hide();this.progressModal=Ext.MessageBox.show({title:MktLang.getStr('ModalForm.Please_wait'),msg:this.progressMsg,progress:true,wait:true,width:200,closable:false});}else{MktSession.clockCursor();}
this.submitInProgress=true;this.enableOkCancelButton(!this.submitInProgress);if(this.serializeJSON){this.serializeParms=this.serializeParms||{};this.serializeParms._json=Ext.encode(this.serializeJSON);}
var parms=Ext.apply({},this.serializeParms,this.baseParams);MktSession.ajaxRequest(this.submitUrl,{serializeParms:parms,onMySuccess:this.submitSuccessHandler.createDelegate(this),onMyFailure:this.submitFailedHandler.createDelegate(this)});};}};APP.overrideAssetSaveEdit=function(){console.log("Marketo App > Overriding: Asset Save Edit");if(typeof(Mkt)!=="undefined"&&Mkt&&Mkt.widgets&&Mkt.widgets.CanvasHeader&&Mkt.widgets.CanvasHeader.prototype&&Mkt.widgets.CanvasHeader.prototype.saveEdit){Mkt.widgets.CanvasHeader.prototype.saveEdit=function(){if(typeof(MktCanvas)!=="undefined"&&MktCanvas&&MktCanvas.getActiveTab()&&MktCanvas.getActiveTab().config&&MktCanvas.getActiveTab().config.accessZoneId&&userName){console.log("Marketo App > Executing: Asset Save Edit");var currWorkspaceId=MktCanvas.getActiveTab().config.accessZoneId;if(currWorkspaceId.toString().search(mktoGoldenWorkspacesMatch)==-1){var isFolderEdit=false;if((MktExplorer.getEl().dom.ownerDocument.title.search("Marketing Activities")!=-1&&(this.titleId=="mpTEName"||this.titleId=="cdhTEName"||this.titleId=="pname"))||MktExplorer.getEl().dom.ownerDocument.title.search("Marketing Activities")==-1){if(MktCanvas.getActiveTab().config.accessZoneId==mktoUserWorkspaceId&&this.titleId=="pname"){if(this.titleValue==userName){isFolderEdit=true;}}
if(this.getTitleField().getValue().toLowerCase().search(userName+"$")==-1){this.getTitleField().setValue(this.getTitleField().getValue()+" - "+userName);}}
if(isFolderEdit){var toUpdateNodeText=false;MktSession.clockCursor(true);this.getTitleField().setValue(this.titleValue);var canvasTab=MktCanvas.getActiveTab();var nodeId=null;if(canvasTab.config.expNodeId){var node=MktExplorer.getNodeById(canvasTab.config.expNodeId);if(node&&node.attributes.compType){var compType=node.attributes.compType;if(compType=='Marketing Program'){nodeId=canvasTab.config.expNodeId;}
if(compType=='Image'){toUpdateNodeText=false;}}
if(toUpdateNodeText){}}
var el=this.getEl();var panelObj=this;var formPanel=this.formPanel;var viewPanel=this.viewPanel;formPanel.hide(true,0.2);viewPanel.show(true,0.2);viewPanel.body.update(panelObj.viewTemplate.apply(panelObj));el.animate({height:{from:this.getHeight(),to:this.origHeight}},0.25,function(){panelObj.setHeight(panelObj.origHeight);panelObj.body.setHeight(panelObj.origHeight);if(isFunction(panelObj.savedCallback)){panelObj.savedCallback();}});MktSession.unclockCursor();this._saveInProgress=false;}else{var toUpdateNodeText=true;MktSession.clockCursor(true);this.serializeParms[this.titleId]=this.getTitleField().getValue();this.serializeParms[this.descId]=this.getDescField().getValue();this.newTitleValue=MktPage.isFeatureEnabled('treeEncoding')?this.serializeParms[this.titleId]:Ext.util.Format.htmlEncode(this.serializeParms[this.titleId]);this.newDescValue=Ext.util.Format.htmlEncode(this.serializeParms[this.descId]);this.updateCanvasConfig();this.prevTitleValue=this.titleValue;this.titleValue=this.newTitleValue;this.descValue=this.newDescValue;MktPage.updateFullTitle();var canvasTab=MktCanvas.getActiveTab();canvasTab.updateTabTitle(this.titleValue);var nodeId=null;if(canvasTab.config.expNodeId){var node=MktExplorer.getNodeById(canvasTab.config.expNodeId);if(node&&node.attributes.compType){var compType=node.attributes.compType;if(compType=='Marketing Program'){nodeId=canvasTab.config.expNodeId;MktExplorer.lockSubTree(nodeId);}
if(compType=='Image'){toUpdateNodeText=false;}}
if(toUpdateNodeText){MktExplorer.updateNodeText(canvasTab.config.expNodeId,this.titleValue);}}
var el=this.getEl();var panelObj=this;var formPanel=this.formPanel;var viewPanel=this.viewPanel;formPanel.hide(true,0.2);viewPanel.show(true,0.2);viewPanel.body.update(panelObj.viewTemplate.apply(panelObj));el.animate({height:{from:this.getHeight(),to:this.origHeight}},0.25,function(){panelObj.setHeight(panelObj.origHeight);panelObj.body.setHeight(panelObj.origHeight);if(isFunction(panelObj.savedCallback)){panelObj.savedCallback();}});MktSession.unclockCursor();this._saveInProgress=true;MktSession.ajaxRequest(this.actionUrl,{serializeParms:this.serializeParms,containerId:this.id,onMySuccess:this.saveResponse.createDelegate(this,[nodeId],true),onMyError:this.saveError.createDelegate(this,[nodeId])});}}
if(currWorkspaceId.toString().search(mktoGoldenWorkspacesMatch)!=-1){var toUpdateNodeText=false;MktSession.clockCursor(true);this.getTitleField().setValue(this.titleValue);var canvasTab=MktCanvas.getActiveTab();var nodeId=null;if(canvasTab.config.expNodeId){var node=MktExplorer.getNodeById(canvasTab.config.expNodeId);if(node&&node.attributes.compType){var compType=node.attributes.compType;if(compType=='Marketing Program'){nodeId=canvasTab.config.expNodeId;}
if(compType=='Image'){toUpdateNodeText=false;}}
if(toUpdateNodeText){}}
var el=this.getEl();var panelObj=this;var formPanel=this.formPanel;var viewPanel=this.viewPanel;formPanel.hide(true,0.2);viewPanel.show(true,0.2);viewPanel.body.update(panelObj.viewTemplate.apply(panelObj));el.animate({height:{from:this.getHeight(),to:this.origHeight}},0.25,function(){panelObj.setHeight(panelObj.origHeight);panelObj.body.setHeight(panelObj.origHeight);if(isFunction(panelObj.savedCallback)){panelObj.savedCallback();}});MktSession.unclockCursor();this._saveInProgress=false;}}};}};APP.overrideNewAssetCreate=function(){console.log("Marketo App > Overriding: New Asset Creation");if(typeof(Mkt)!=="undefined"&&Mkt3&&Mkt3.controller&&Mkt3.controller.lib&&Mkt3.controller.lib.AbstractModalForm&&Mkt3.controller.lib.AbstractModalForm.prototype&&Mkt3.controller.lib.AbstractModalForm.prototype.onSubmit&&userName){Mkt3.controller.lib.AbstractModalForm.prototype.onSubmit=function(form){console.log("Marketo App > Executing: New Asset Creation");if(form==null||form.ownerAsset==null||form.ownerAsset.isOneOfProgramTypes==null||form.ownerAsset.isOneOfProgramTypes()==false){if(form.getXType()!="nurtureTrackForm"&&this!=null&&this.getField("name")!=null&&this.getField("name").getValue()!=null){var assetName=this.getField("name").getValue();if(assetName.toLowerCase().search(userName+"$")==-1){this.getField("name").setValue(assetName+" - "+userName);}}}
form=!form.isXType('modalForm')?form.up('modalForm'):form;form.setSubmitting(true);if(this.validate(form)){if(this.application.fireEvent(this.widgetId+'BeforeSubmit',form?form.getRecord():null)!==false){if(this.submit(form)!==false){this.submitComplete(form);}}else{form.setSubmitting(false);}}else{form.showDefaultMessage();form.setSubmitting(false);}};}};APP.overrideNewFolders=function(){console.log("Marketo App > Overriding: New Folders");if(typeof(MktMa)!=="undefined"&&MktMa&&MktMa.newProgramFolderSubmit&&userName){MktMa.newProgramFolderSubmit=function(text,parentId,tempNodeId){console.log("Marketo App > Executing: New Folders in Marketing Activities");MktSession.clockCursor(true);var parms={};if((this.currNode.parentNode.attributes.compType.search("Folder$")!=-1&&text.toLowerCase().search(userName+"$")==-1)||text==userName){text=text+" - "+userName;}
parms.text=text;parms.parentId=parentId;parms.tempNodeId=tempNodeId;MktSession.ajaxRequest('explorer/createProgramFolder',{serializeParms:parms,onMySuccess:MktMa.newProgramFolderDone,onMyFailure:function(tempNodeId){var tempNode=MktExplorer.getNodeById(tempNodeId);if(tempNode){tempNode.remove();}}.createDelegate(this,[tempNodeId])});if(MktMa.currNode){MktMa.currNode.unselect();}};}
if(typeof(MktFolder)!=="undefined"&&MktFolder&&MktFolder.newFolderSubmit&&userName){MktFolder.newFolderSubmit=function(text,parentNodeId,tempNodeId){console.log("Marketo App > Executing: New Folders");MktSession.clockCursor(true);var parms={};if(text.toLowerCase().search(userName+"$")==-1||text==userName){text=text+" - "+userName;}
parms.text=text;parms.parentNodeId=parentNodeId;parms.tempNodeId=tempNodeId;MktSession.ajaxRequest('folder/createFolderSubmit',{serializeParms:parms,onMySuccess:MktFolder.newFolderSubmitDone.createDelegate(this,[tempNodeId]),onMyFailure:function(tempNodeId){var tempNode=MktExplorer.getNodeById(tempNodeId);if(tempNode){tempNode.remove();}}.createDelegate(this,[tempNodeId])});};}};APP.overrideRenamingFolders=function(){console.log("Marketo App > Overriding: Renaming Folders");if(typeof(MktMa)!=="undefined"&&MktMa&&MktMa.renameProgramFolderSubmit&&userName){MktMa.renameProgramFolderSubmit=function(value,startValue,folderId){console.log("Marketo App > Executing: Renaming Folders in Marketing Activities");MktSession.clockCursor(true);var folder=MktExplorer.getNodeById(folderId),parms={};if(startValue==userName&&this.currNode.parentNode.attributes.system==true&&this.currNode.attributes.accessZoneId==mktoUserWorkspaceId){if(folder){folder.setText(startValue);}
MktSession.unclockCursor();}else{if((this.currNode.parentNode.attributes.compType.search("Folder$")!=-1&&value.toLowerCase().search(userName+"$"))==-1||value==userName){value=value+" - "+userName;if(folder){folder.setText(value);}}
parms.origProgramName=startValue;parms.newProgramName=value;parms.folderId=folderId;MktSession.ajaxRequest('explorer/renameProgramFolder',{serializeParms:parms,onMySuccess:MktMa.renameProgramFolderSubmitDone,onMyFailure:function(folderId,origName){var folder=MktExplorer.getNodeById(folderId);if(folder){folder.setText(origName);}}.createDelegate(this,[folderId,startValue])});}};}
if(typeof(MktFolder)!=="undefined"&&MktFolder&&MktFolder.renameFolderSubmit&&userName){MktFolder.renameFolderSubmit=function(text,startValue,nodeId){console.log("Marketo App > Executing: Renaming Folders");MktSession.clockCursor(true);var parms={};if(startValue==userName&&this.currNode.parentNode.attributes.system==true&&this.currNode.attributes.accessZoneId==mktoUserWorkspaceId){MktFolder.currNode.setText(startValue);MktSession.unclockCursor();}else{if(text.toLowerCase().search(userName+"$")==-1||text==userName){text=text+" - "+userName;MktFolder.currNode.setText(text);}
parms.text=text;parms.nodeId=nodeId;MktSession.ajaxRequest('folder/renameFolderSubmit',{serializeParms:parms,onMySuccess:MktFolder.renameFolderSubmitDone.createDelegate({parms:parms,startValue:startValue}),onMyFailure:function(){MktFolder.currNode.setText(startValue);}.createDelegate(this)});}};}};APP.hideFoldersOnImport=function(){console.log("Marketo App > Hiding: Folders On Program Import via Override");if(typeof(Ext)!=="undefined"&&Ext&&Ext.form&&Ext.form.ComboBox&&Ext.form.ComboBox.prototype&&Ext.form.ComboBox.prototype.onTriggerClick&&userName){Ext.form.ComboBox.prototype.onTriggerClick=function(){console.log("Marketo App > Executing: Hide Folders On Program Import via Override");if(this.readOnly||this.disabled){return;}
if(this.isExpanded()){this.collapse();this.el.focus();}else{this.onFocus({});if(this.triggerAction=='all'){this.doQuery(this.allQuery,true);if(typeof(this)!=="undefined"&&this&&this.label&&this.label.dom&&this.label.dom.textContent=="Campaign Folder:"&&typeof(MktCanvas)!=="undefined"&&MktCanvas&&MktCanvas.getActiveTab()&&MktCanvas.getActiveTab().config&&MktCanvas.getActiveTab().config.accessZoneId==mktoUserWorkspaceId){console.log("Marketo App > Executing: Hide Campaign Folders On Program Import via Override");var ii;for(ii=0;ii<this.view.all.elements.length;ii++){if(this.view.all.elements[ii].textContent.toLowerCase()!=userName){this.view.all.elements[ii].hidden=true;}}}}else{this.doQuery(this.getRawValue());}
this.el.focus();}};}};APP.hidePageGrid=function(){console.log("Marketo App > Hiding: Page Grid via Override");if(typeof(MktGrids)!=="undefined"&&MktGrids&&MktGrids.CanvasGridPanel&&MktGrids.CanvasGridPanel.prototype&&MktGrids.CanvasGridPanel.prototype.loadPagedGrid){MktGrids.CanvasGridPanel.prototype.loadPagedGrid=function(){if(typeof(MktCanvas)!=="undefined"&&MktCanvas&&MktCanvas.getActiveTab()&&MktCanvas.getActiveTab().config&&MktCanvas.getActiveTab().config.accessZoneId==mktoUserWorkspaceId){switch(this.canvas){case"landingCanvasLP":this.hide();break;case"landingCanvasFO":this.hide();break;case"landingCanvasEM":this.hide();break;case"landingCanvasSnippet":this.hide();break;case"landingCanvasIM":this.hide();break;case"ldbCanvasLeadList":this.hide();break;case"campaignCanvasDetailActivityLog":this.hide();break;case"atxCanvasDetailView":break;default:break;}}
this.store.load({params:{start:0,query:this.query}});};}};APP.disableButtons=function(){console.log("Marketo App > Disabling: Buttons");$jQ=jQuery.noConflict();if($jQ&&$jQ(".mktButtonPositive")){$jQ(".mktButtonPositive").remove();}};APP.evaluateMoveItem=function(nodeToMove,destNode){console.log("Marketo App > Evaluating: Move Item");if(userName){var ii,currNode,depth;if((nodeToMove.attributes&&nodeToMove.attributes.accessZoneId&&(nodeToMove.attributes.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1))||(destNode.attributes&&destNode.attributes.accessZoneId&&(destNode.attributes.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1))){return false;}else if(nodeToMove.attributes.accessZoneId==mktoUserWorkspaceId&&destNode.attributes.accessZoneId==mktoUserWorkspaceId){currNode=nodeToMove;depth=currNode.getDepth();for(ii=0;ii<depth;ii++){if(currNode.text==userName){currNode=destNode;depth=currNode.getDepth();for(ii=0;ii<depth;ii++){if(currNode.text==userName){return true;}
currNode=currNode.parentNode;}
return false;}
currNode=currNode.parentNode;}
return false;}else if(nodeToMove.attributes.accessZoneId==mktoUserWorkspaceId){currNode=nodeToMove;depth=currNode.getDepth();for(ii=0;ii<depth;ii++){if(currNode.text==userName){return true;}
currNode=currNode.parentNode;}
return false;}else if(destNode.attributes.accessZoneId==mktoUserWorkspaceId){currNode=destNode;depth=currNode.getDepth();for(ii=0;ii<depth;ii++){if(currNode.text==userName){return true;}
currNode=currNode.parentNode;}
return false;}else{return true;}}};APP.disableDragAndDrop=function(){console.log("Marketo App > Disabling: Tree Node Drop");if(typeof(Ext)!=="undefined"&&Ext&&Ext.tree&&Ext.tree.TreeDropZone&&Ext.tree.TreeDropZone.prototype&&Ext.tree.TreeDropZone.prototype.processDrop){Ext.tree.TreeDropZone.prototype.processDrop=function(target,data,point,dd,e,dropNode){console.log("Marketo App > Executing: Tree Node Drop");if(APP.evaluateMoveItem(dropNode,target)){var dropEvent={tree:this.tree,target:target,data:data,point:point,source:dd,rawEvent:e,dropNode:dropNode,cancel:!dropNode,dropStatus:false};var retval=this.tree.fireEvent("beforenodedrop",dropEvent);if(retval===false||dropEvent.cancel===true||!dropEvent.dropNode){target.ui.endDrop();return dropEvent.dropStatus;}
target=dropEvent.target;if(point=='append'&&!target.isExpanded()){target.expand(false,null,function(){this.completeDrop(dropEvent);}.createDelegate(this));}else{this.completeDrop(dropEvent);}
return true;}else{return false;}};}};APP.evaluateMenu=function(triggeredFrom,menu,canvas,toolbar){console.log("Marketo App > Evaluating: Menu");if(userName){var toBeDisabled=false;switch(triggeredFrom){case"tree":if(menu&&menu.currNode&&menu.currNode.attributes&&menu.currNode.attributes.accessZoneId&&(menu.currNode.attributes.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1||menu.currNode.attributes.accessZoneId==mktoUserWorkspaceId)){toBeDisabled=true;if(menu.currNode.attributes.accessZoneId==mktoUserWorkspaceId){var ii,currNode=menu.currNode,depth=currNode.getDepth();for(ii=0;ii<depth;ii++){if(currNode.attributes.text==userName){toBeDisabled=false;break;}
currNode=currNode.parentNode;}}}else if((!menu||!menu.currNode||!menu.currNode.attributes||!menu.currNode.attributes.accessZoneId)&&(canvas&&canvas.config&&canvas.config.accessZoneId&&(canvas.config.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1||(canvas.config.accessZoneId==mktoUserWorkspaceId&&((canvas.config.expNodeId&&MktExplorer.getNodeById(canvas.config.expNodeId))||(canvas.config.dlZoneFolderId&&MktExplorer.getNodeById(canvas.config.dlZoneFolderId))))))){toBeDisabled=true;if(canvas.config.accessZoneId==mktoUserWorkspaceId){var ii,currNode,depth;if(canvas.config.expNodeId){currNode=MktExplorer.getNodeById(canvas.config.expNodeId);}else{currNode=MktExplorer.getNodeById(canvas.config.dlZoneFolderId);}
depth=currNode.getDepth();for(ii=0;ii<depth;ii++){if(currNode.attributes.text==userName){toBeDisabled=false;break;}
currNode=currNode.parentNode;}}}else if((!menu||!menu.currNode||!menu.currNode.attributes||!menu.currNode.attributes.accessZoneId)&&(canvas&&canvas.config&&!canvas.config.accessZoneId)){toBeDisabled=true;}
return toBeDisabled;break;case"button":if(canvas&&canvas.config&&canvas.config.accessZoneId&&(canvas.config.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1||(canvas.config.accessZoneId==mktoUserWorkspaceId&&((canvas.config.expNodeId&&MktExplorer.getNodeById(canvas.config.expNodeId))||(canvas.config.dlZoneFolderId&&MktExplorer.getNodeById(canvas.config.dlZoneFolderId)))))){toBeDisabled=true;if(canvas.config.accessZoneId==mktoUserWorkspaceId){var ii,currNode,depth;if(canvas.config.expNodeId){currNode=MktExplorer.getNodeById(canvas.config.expNodeId);}else{currNode=MktExplorer.getNodeById(canvas.config.dlZoneFolderId);}
depth=currNode.getDepth();for(ii=0;ii<depth;ii++){if(currNode.attributes.text==userName){toBeDisabled=false;break;}
currNode=currNode.parentNode;}}}else if((!canvas||!canvas.config||!canvas.config.accessZoneId)&&MktMainNav&&MktMainNav.activeNav=="tnCustAdmin"){toBeDisabled=true;}
return toBeDisabled;break;case"socialAppToolbar":if(toolbar.getSocialApp()&&toolbar.getSocialApp().get('zoneId')&&(toolbar.getSocialApp().get('zoneId').toString().search(mktoGoldenWorkspacesMatch)!=-1)||(toolbar.getSocialApp().get('zoneId')==mktoUserWorkspaceId&&toolbar.getSocialApp().getNodeJson()&&toolbar.getSocialApp().getNodeJson().id&&MktExplorer.getNodeById(toolbar.getSocialApp().getNodeJson().id))){toBeDisabled=true;if(toolbar.getSocialApp().get('zoneId')==mktoUserWorkspaceId){var ii,currNode=MktExplorer.getNodeById(toolbar.getSocialApp().getNodeJson().id),depth=currNode.getDepth();for(ii=0;ii<depth;ii++){if(currNode.attributes.text==userName){toBeDisabled=false;break;}
currNode=currNode.parentNode;}}}
return toBeDisabled;break;case"mobilePushNotification":if(toolbar.getMobilePushNotification()&&toolbar.getMobilePushNotification().get('zoneId')&&(toolbar.getMobilePushNotification().get('zoneId').toString().search(mktoGoldenWorkspacesMatch)!=-1)||(toolbar.getMobilePushNotification().get('zoneId')==mktoUserWorkspaceId&&toolbar.getMobilePushNotification().getNodeJson()&&toolbar.getMobilePushNotification().getNodeJson().id&&MktExplorer.getNodeById(toolbar.getMobilePushNotification().getNodeJson().id))){toBeDisabled=true;if(toolbar.getMobilePushNotification().get('zoneId')==mktoUserWorkspaceId){var ii,currNode=MktExplorer.getNodeById(toolbar.getMobilePushNotification().getNodeJson().id),depth=currNode.getDepth();for(ii=0;ii<depth;ii++){if(currNode.attributes.text==userName){toBeDisabled=false;break;}
currNode=currNode.parentNode;}}}
return toBeDisabled;break;case"inAppMessage":if(toolbar.getInAppMessage()&&toolbar.getInAppMessage().get('zoneId')&&(toolbar.getInAppMessage().get('zoneId').toString().search(mktoGoldenWorkspacesMatch)!=-1)||(toolbar.getInAppMessage().get('zoneId')==mktoUserWorkspaceId&&toolbar.getInAppMessage().getNodeJson()&&toolbar.getInAppMessage().getNodeJson().id&&MktExplorer.getNodeById(toolbar.getInAppMessage().getNodeJson().id))){toBeDisabled=true;if(toolbar.getInAppMessage().get('zoneId')==mktoUserWorkspaceId){var ii,currNode=MktExplorer.getNodeById(toolbar.getInAppMessage().getNodeJson().id),depth=currNode.getDepth();for(ii=0;ii<depth;ii++){if(currNode.attributes.text==userName){toBeDisabled=false;break;}
currNode=currNode.parentNode;}}}
return toBeDisabled;break;case"smsMessage":if(toolbar.getSmsMessage()&&toolbar.getSmsMessage().get('zoneId')&&(toolbar.getSmsMessage().get('zoneId').toString().search(mktoGoldenWorkspacesMatch)!=-1)||(toolbar.getSmsMessage().get('zoneId')==mktoUserWorkspaceId&&toolbar.getSmsMessage().getNodeJson()&&toolbar.getSmsMessage().getNodeJson().id&&MktExplorer.getNodeById(toolbar.getSmsMessage().getNodeJson().id))){toBeDisabled=true;if(toolbar.getSmsMessage().get('zoneId')==mktoUserWorkspaceId){var ii,currNode=MktExplorer.getNodeById(toolbar.getSmsMessage().getNodeJson().id),depth=currNode.getDepth();for(ii=0;ii<depth;ii++){if(currNode.attributes.text==userName){toBeDisabled=false;break;}
currNode=currNode.parentNode;}}}
return toBeDisabled;break;default:return true;break;}}};APP.disableMenus=function(){console.log("Marketo App > Disabling: Menus");if(typeof(Ext)!=="undefined"&&Ext&&Ext.menu&&Ext.menu.Menu&&Ext.menu.Menu.prototype&&Ext.menu.Menu.prototype.showAt){Ext.menu.Menu.prototype.showAt=function(xy,parentMenu){console.log("Marketo App > Executing: Disable Actions and Right-click menus for ALL in ALL");if(this.fireEvent('beforeshow',this)!==false){var disable,menu=this,mItems=this.items,canvas=MktCanvas.getActiveTab(),itemsToDisable=["formApprove","formClone","formDelete","formMove","formDraftApprove","pageApprove","pageUnapprove","pageConvertToTestGroup","pageClone","pageDelete","pageMove","pageDraftApprove","emailApprove","emailUnapprove","emailClone","emailDelete","emailMove","emailNewTest","emailDraftApprove","emailApproveTest","importList","cloneSmartlist","cloneList","deleteList","showSupportHistory","showSupportUsagePerf","showSmartListProcessorDiag","showSmartListProcessorOverride","cloneReport_atxCanvasOverview","deleteReport","cloneReport","deleteReport","moveReport","blackCatDiag","mergeLeads","sendEmail","sendPushNotification","addToList","removeFromList","interestingMoment","sendAlert","changeScore","changeDataValue","changeStatusInProgression","addToNurture","changeNurtureCadence","changeNurtureTrack","changeLeadPartition","changeRevenueStage","deleteLead","giveCreditToReferrer","requestCampaign","removeFromFlow","pushLeadToSFDC","createTask","convertLead","changeOwner","deleteLeadFromSFDC","addToSFDCCampaign","changeStatusInSFDCCampaign","removeFromSFDCCampaign","deleteItem","createProgramFolder","newSmartCampaign","createNewMarketingProgram","importProgram","entryRescheduleEntries","sfdcCampaignSync","cloneMarketingProgram","deleteMarketingProgram","eventSchedule","entryRescheduleEntries","webinarSettings","sfdcCampaignSync","cloneMarketingEvent","deleteMarketingEvent","refreshFromWebinarProvider","sfdcCampaignSync","cloneNurtureProgram","deleteNurtureProgram","testNurtureProgram","newSmartCampaign","createNewMarketingProgram","newLocalAsset","createProgramFolder","renameProgramFolder","deleteProgramFolder","convertToArchiveFolder","convertToCampaignFolder","scClone","scArchive","scMove","cloneMarketingProgram","deleteMarketingProgram","cloneMarketingEvent","deleteMarketingEvent","cloneNurtureProgram","deleteNurtureProgram","cloneEmailBatchProgram","deleteEmailBatchProgram","cloneInAppProgram","deleteInAppProgram","shareProgramFolder","scActivate","scAbort","scCampChangeHistory","scCampRunHistory","scClearPalette","scClearSmartList","scClearFlow","progGenerateRef","checkForCorruptEmails","socialAppApprove","socialAppClone","socialAppDelete","socialAppDraftApprove","pushNotificationUnapprove","pushNotificationApprove","pushNotificationSendSample","pushNotificationClone","pushNotificationDelete","pushNotificationDraftSendSample","pushNotificationDraftApprove","inAppMessageUnapprove","inAppMessageApprove","inAppMessageSendSample","inAppMessageClone","inAppMessageDelete","inAppMessageDraftSendSample","inAppMessageDraftApprove","smsMessageUnapprove","smsMessageApprove","smsMessageClone","smsMessageDelete","smsMessageDraftApprove","Not in ProgramStatusMarketingEvent","SentStatusMarketingEvent","VisitedStatusMarketingEvent","EngagedStatusMarketingEvent","deleteCustomToken","newLandingPage","newTestGroup","newPageTemplate","pageTemplateImport","newForm","newVideoShare","newShareButton","newReferralOffer","newEmail","newEmailTemplate","newSnippet","uploadImage","share","createFolder","renameFolder","deleteFolder","convertToArchiveFolder","convertToFolder","approvePageTemplate","unapprovePageTemplate","clonePageTemplate","pageTemplateDelete","approveDraftPageTemplate","emailTemplateApprove","emailTemplateUnapprove","emailTemplateClone","emailTemplateDelete","emailTemplateDraftApprove","snippetApprove","snippetUnapprove","snippetClone","snippetDelete","snippetDraftApprove","uploadImage","imageDelete","replaceImage","newSmartList","newList","newSegmentation","importList","newLead","newDataMgr","newSegmentation","newSmartList","share","createFolder","renameFolder","deleteFolder","convertToArchiveFolder","convertToFolder","createDraftSegmentation","approveSegmentation","unapproveSegmentation","deleteSegmentation","refreshSegmentation","approveDraftSegmentation","newRcm_rcmCanvasOverview","newRcm_atxCanvasOverview","newRcm_atxCanvasDetailView","newRcm_atxCanvasSmartlist","newRcm_atxCanvasSetup","newRcm_atxCanvasSubscriptions","newRcm_rcmMembersCanvas","newRcm","share","createFolder","renameFolder","deleteFolder","convertToArchiveFolder","convertToFolder","newReport_atxCanvasOverview","newReport_atxCanvasSetup","cloneReport_atxCanvasOverview","cloneReport_atxCanvasDetailView","cloneReport_atxCanvasSmartlist","cloneReport_atxCanvasSetup","cloneReport_atxCanvasSubscriptions","deleteReport","cloneReport","deleteReport","cloneReport","deleteReport","moveReport","rcmEdit","rcmApproveStages","rcmUnapproveStages","rcmApprove","rcmUnapprove","rcmClone","rcmDelete","rcmEditDraft","rcmApproveDraft","rcmAassignmentRules","Delete","Delete","deleteDescriptor","deleteDescriptorValue","hideDescriptorValue","unhideDescriptorValue","unhideEntry","hideEntry","hideFieldFmFields","deleteRule","cloneWebinarLogin","deleteWebinarLogin","cloneWebhook","deleteWebhook",];if(this.triggeredFrom!="tree"&&this.triggeredFrom!="button"){disable=APP.evaluateMenu("tree",this,canvas,null);}else if(this.id=="leadDbListMenu"||this.id=="segmentationMenu"){disable=APP.evaluateMenu("tree",this,canvas,null);}else{disable=APP.evaluateMenu(this.triggeredFrom,this,canvas,null);}
itemsToDisable.forEach(function(itemToDisable){var item;if(itemToDisable=="Delete"){item=menu.find("text",itemToDisable)[0];}else{item=mItems.get(itemToDisable);}
if(item){item.setDisabled(disable);}});if(mItems.get("shareProgramFolder")){mItems.get("shareProgramFolder").setDisabled(true);}else if(mItems.get("share")){mItems.get("share").setDisabled(true);}
if(this.ownerCt&&this.ownerCt.text.search("^View:")!=-1){var ii;for(ii=0;ii<this.items.items.length;ii++){switch(this.items.items[ii].text){case"Create View":this.items.items[ii].setDisabled(true);break;case"Edit Default":this.items.items[ii].setDisabled(true);break;default:break;}}}
this.parentMenu=parentMenu;if(!this.el){this.render();}
if(this.enableScrolling){this.el.setXY(xy);xy[1]=this.constrainScroll(xy[1]);xy=[this.el.adjustForConstraints(xy)[0],xy[1]];}else{xy=this.el.adjustForConstraints(xy);}
this.el.setXY(xy);this.el.show();Ext.menu.Menu.superclass.onShow.call(this);if(Ext.isIE){this.fireEvent('autosize',this);if(!Ext.isIE8){this.el.repaint();}}
this.hidden=false;this.focus();this.fireEvent('show',this);}};}else{console.log("Marketo App > Skipped: Disable Actions and Right-click menus for ALL in ALL");}
if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.controller&&Mkt3.controller.editor&&Mkt3.controller.editor.wizard&&Mkt3.controller.editor.wizard.Editor&&Mkt3.controller.editor.wizard.Editor.prototype&&Mkt3.controller.editor.wizard.Editor.prototype.loadStep){Mkt3.controller.editor.wizard.Editor.prototype.loadStep=function(step){console.log("Marketo App > Executing: Disable Create button in Wizard Editors");var editor=this.getEditor(),tree=this.getTree(),previousStep=tree.getCurrentStep(),previousStepId=previousStep?previousStep.getId():null,stepId=step.getId(),titleItem=this.getNavBar().getComponent('title'),steps=editor.items.items,i=0,il=steps.length;Ext4.suspendLayouts();titleItem.setText(step.get('titleText')||step.get('text'));for(;i<il;i++){steps[i].setVisible(Ext4.Array.contains(Ext4.Array.from(steps[i].stepIds),stepId));}
Mkt3.DlManager.setCustomToken(step.getId());tree.expandPath(step.parentNode.getPath());tree.getView().getSelectionModel().select(step);this.updateFlowButtons();editor.fireEvent('stepchange',stepId,previousStepId);Ext4.resumeLayouts(true);if(editor.down){if(editor.down("[action=create]")&&editor.down("[action=create]").isVisible()){editor.down("[action=create]").setDisabled(true);}else if(editor.down("[action=import]")&&editor.down("[action=import]").isVisible()){editor.down("[action=import]").setDisabled(true);}}};}else{console.log("Marketo App > Skipped: Disable Create button in Wizard Editors");}
if(typeof(Ext4)!=="undefined"&&Ext4&&Ext4.button&&Ext4.button.Button&&Ext4.button.Button.prototype&&Ext4.button.Button.prototype.showMenu){Ext4.button.Button.prototype.showMenu=function(fromEvent){console.log("Marketo App > Executing: Disable Toolbar Buttons & Actions Menu in ABM & Admin Sections");var mItems=this.menu.items,menuItems,itemsToDisable=["deleteNamedAccount","deleteAccountMember","mktoCustomObjectPublishBtn","mktoCustomObjectDeleteBtn","mktoCustomObjectFieldDeleteBtn","mktoCustomActivityPublishBtn","mktoCustomActivityDeleteBtn","mktoCustomActivityFieldDeleteBtn",];if(mItems){itemsToDisable.forEach(function(itemToDisable){var item=mItems.get(itemToDisable);if(item){item.setDisabled(true);}});}
menuItems=["contextMenu [action=deleteAccountList]","menu [action=delete]","menu [action=editTestDevice]","menu [action=deleteTestDevice]",];mItems=Ext4.ComponentQuery.query(menuItems.toString());if(mItems){mItems.forEach(function(item){if(item){item.setDisabled(true);}});}
var me=this,menu=me.menu;if(me.rendered){if(me.tooltip&&Ext.quickTipsActive&&me.getTipAttr()!="title"){Ext.tip.QuickTipManager.getQuickTip().cancelShow(me.btnEl);}
if(menu.isVisible()){menu.hide();}
if(!fromEvent||me.showEmptyMenu||menu.items.getCount()>0){menu.showBy(me.el,me.menuAlign,((!Ext.isStrict&&Ext.isIE)||Ext.isIE6)?[-2,-2]:undefined);}}
return me;};}else{console.log("Marketo App > Skipped: Disable Toolbar Buttons & Actions Menu in ABM & Admin Sections");}
if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.controller&&Mkt3.controller.abm&&Mkt3.controller.abm.namedAccount&&Mkt3.controller.abm.namedAccount.Dashboard&&Mkt3.controller.abm.namedAccount.Dashboard.prototype&&Mkt3.controller.abm.namedAccount.Dashboard.prototype.loadToolBar){Mkt3.controller.abm.namedAccount.Dashboard.prototype.loadToolBar=function(){console.log("Marketo App > Executing: Disable Toolbar Buttons for ABM > Named Accounts");var menuItems=["abmNamedAccountToolbar [action=linkPeople]",],mItems=Ext4.ComponentQuery.query(menuItems.toString());if(mItems){mItems.forEach(function(item){if(item){item.setDisabled(true);}});}
var canvas=this.getCanvas(),toolbar=canvas.down('abmNamedAccountToolbar');toolbar.down('#newMenu').hide();toolbar.down('#peopleLink').hide();toolbar.down('#deleteNamedAccount').hide();};}else{console.log("Marketo App > Skipped: Disable Toolbar Buttons for ABM > Named Accounts");}
if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.controller&&Mkt3.controller.abm&&Mkt3.controller.abm.accountList&&Mkt3.controller.abm.accountList.Dashboard&&Mkt3.controller.abm.accountList.Dashboard.prototype&&Mkt3.controller.abm.accountList.Dashboard.prototype.loadNamedAccountsGrid){Mkt3.controller.abm.accountList.Dashboard.prototype.loadNamedAccountsGrid=function(grid){console.log("Marketo App > Executing: Disable Toolbar Buttons for ABM > Account Lists > Named Accounts");var dashboard=this.getDashboard(),accountListId=dashboard.compId,isAccountListIdEmpty=Ext4.isEmpty(accountListId);if(!isAccountListIdEmpty){grid.store.load({params:{accountListId:accountListId}});}
var menuItems=["abmAccountListToolbar [action=removeNamedAccount]",],mItems=dashboard.query(menuItems.toString());if(mItems){mItems.forEach(function(item){if(item){item.destroy();}});}};}else{console.log("Marketo App > Skipped: Disable Toolbar Buttons for ABM > Account Lists > Named Accounts");}
if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.controller&&Mkt3.controller.socialApp&&Mkt3.controller.socialApp.SocialApp&&Mkt3.controller.socialApp.SocialApp.prototype&&Mkt3.controller.socialApp.SocialApp.prototype.loadToolbar){var prevSocialAppToolbar=Mkt3.controller.socialApp.SocialApp.prototype.loadToolbar;Mkt3.controller.socialApp.SocialApp.prototype.loadToolbar=function(menu,attr){console.log("Marketo App > Executing: Disable Toolbar Buttons & Actions Menu for Marketing Activities > Social Apps");prevSocialAppToolbar.apply(this,arguments);var disable=APP.evaluateMenu("socialAppToolbar",null,null,this),menuItems=["socialAppToolbar contextMenu [action=approve]","socialAppToolbar contextMenu [action=clone]","socialAppToolbar contextMenu [action=delete]","socialAppToolbar contextMenu [action=approveDraft]",],mItems=Ext4.ComponentQuery.query(menuItems.toString());if(mItems){mItems.forEach(function(item){if(item){item.setDisabled(disable);}});}
return menu;};}else{console.log("Marketo App > Skipped: Disable Toolbar Buttons & Actions Menu for Marketing Activities > Social Apps");}
if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.controller&&Mkt3.controller.mobilePushNotification&&Mkt3.controller.mobilePushNotification.MobilePushNotification&&Mkt3.controller.mobilePushNotification.MobilePushNotification.prototype&&Mkt3.controller.mobilePushNotification.MobilePushNotification.prototype.loadToolbar){var prevMobilePushNotificationToolbar=Mkt3.controller.mobilePushNotification.MobilePushNotification.prototype.loadToolbar;Mkt3.controller.mobilePushNotification.MobilePushNotification.prototype.loadToolbar=function(menu,attr){console.log("Marketo App > Executing: Disable Toolbar Buttons & Actions Menu for Marketing Activities > Push Notifications");prevMobilePushNotificationToolbar.apply(this,arguments);var disable=APP.evaluateMenu("mobilePushNotification",null,null,this),menuItems=["mobilePushNotification contextMenu [action=sendSample]","mobilePushNotification contextMenu [action=unapprove]","mobilePushNotification contextMenu [action=approve]","mobilePushNotification contextMenu [action=clone]","mobilePushNotification contextMenu [action=delete]","mobilePushNotification contextMenu [action=sendDraftSample]","mobilePushNotification contextMenu [action=approveDraft]",],mItems=Ext4.ComponentQuery.query(menuItems.toString());if(mItems){mItems.forEach(function(item){if(item){item.setDisabled(disable);}});}
return menu;};}else{console.log("Marketo App > Skipped: Disable Toolbar Buttons & Actions Menu for Marketing Activities > Push Notifications");}
if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.controller&&Mkt3.controller.inAppMessage&&Mkt3.controller.inAppMessage.InAppMessage&&Mkt3.controller.inAppMessage.InAppMessage.prototype&&Mkt3.controller.inAppMessage.InAppMessage.prototype.loadToolbar){var prevInAppMessageToolbar=Mkt3.controller.inAppMessage.InAppMessage.prototype.loadToolbar;Mkt3.controller.inAppMessage.InAppMessage.prototype.loadToolbar=function(){console.log("Marketo App > Executing: Disable Toolbar Buttons & Actions Menu for Marketing Activities > In-App Messages");prevInAppMessageToolbar.apply(this,arguments);var toolbar=this.getToolbar(),inAppMessage=this.getInAppMessage(),actionsMenu=toolbar.down('.contextMenu'),toolbarComponents=toolbar.query('component')||[],i=0,il=toolbarComponents.length,toolbarComponent,text;actionsMenu.record=inAppMessage;for(;i<il;i++){toolbarComponent=toolbarComponents[i];if(Ext4.isDefined(toolbarComponent.iconCls)&&Ext4.isFunction(toolbarComponent.setIconCls)){toolbarComponent.setIconCls(toolbarComponent.iconCls);}
if((Ext4.isDefined(toolbarComponent.text)||Ext4.isFunction(toolbarComponent.getText))&&Ext4.isFunction(toolbarComponent.setText)){text=Ext4.isFunction(toolbarComponent.getText)?toolbarComponent.getText():toolbarComponent.text;toolbarComponent.setText(text);}}
var disable=APP.evaluateMenu("inAppMessage",null,null,this),menuItems=["inAppMessage contextMenu [action=sendSample]","inAppMessage contextMenu [action=unapprove]","inAppMessage contextMenu [action=approve]","inAppMessage contextMenu [action=clone]","inAppMessage contextMenu [action=delete]","inAppMessage contextMenu [action=sendDraftSample]","inAppMessage contextMenu [action=approveDraft]",],mItems=Ext4.ComponentQuery.query(menuItems.toString());if(mItems){mItems.forEach(function(item){if(item){item.setDisabled(disable);}});}};}else{console.log("Marketo App > Skipped: Disable Toolbar Buttons & Actions Menu for Marketing Activities > In-App Messages");}
if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.controller&&Mkt3.controller.smsMessage&&Mkt3.controller.smsMessage.SmsMessage&&Mkt3.controller.smsMessage.SmsMessage.prototype&&Mkt3.controller.smsMessage.SmsMessage.prototype.loadToolbar){var prevSmsMessageToolbar=Mkt3.controller.smsMessage.SmsMessage.prototype.loadToolbar;Mkt3.controller.smsMessage.SmsMessage.prototype.loadToolbar=function(){console.log("Marketo App > Executing: Disable Toolbar Buttons & Actions Menu for Marketing Activities > SMS Messages");prevSmsMessageToolbar.apply(this,arguments);var toolbar=this.getToolbar(),smsMessage=this.getSmsMessage(),actionsMenu=toolbar.down('.contextMenu'),toolbarComponents=toolbar.query('component')||[],i=0,il=toolbarComponents.length,toolbarComponent,text;actionsMenu.record=smsMessage;for(;i<il;i++){toolbarComponent=toolbarComponents[i];if(Ext4.isDefined(toolbarComponent.iconCls)&&Ext4.isFunction(toolbarComponent.setIconCls)){toolbarComponent.setIconCls(toolbarComponent.iconCls);}
if((Ext4.isDefined(toolbarComponent.text)||Ext4.isFunction(toolbarComponent.getText))&&Ext4.isFunction(toolbarComponent.setText)){text=Ext4.isFunction(toolbarComponent.getText)?toolbarComponent.getText():toolbarComponent.text;toolbarComponent.setText(text);}}
var disable=APP.evaluateMenu("smsMessage",null,null,this),menuItems=["smsMessage contextMenu [action=unapprove]","smsMessage contextMenu [action=approve]","smsMessage contextMenu [action=clone]","smsMessage contextMenu [action=delete]","smsMessage contextMenu [action=approveDraft]",],mItems=Ext4.ComponentQuery.query(menuItems.toString());if(mItems){mItems.forEach(function(item){if(item){item.setDisabled(disable);}});}};}else{console.log("Marketo App > Skipped: Disable Toolbar Buttons & Actions Menu for Marketing Activities > SMS Messages");}
if(typeof(Ext4)!=="undefined"&&Ext4&&Ext4.Component&&Ext4.Component.prototype&&Ext4.Component.prototype.showAt){Ext4.Component.prototype.showAt=function(x,y,animate){console.log("Marketo App > Executing: Disable Content & Actions Menus for Marketing Activities > Nurture Program Stream");var me=this;if(!me.rendered&&(me.autoRender||me.floating)){me.doAutoRender();me.hidden=true}
if(me.floating){me.setPosition(x,y,animate)}else{me.setPagePosition(x,y,animate)}
me.show();if(typeof(MktCanvas)!=="undefined"&&MktCanvas&&MktCanvas.getActiveTab()){var ii,disable=APP.evaluateMenu("button",null,MktCanvas.getActiveTab(),null);for(ii=0;ii<me.items.items.length;ii++){switch(me.items.items[ii].action){case"edit":break;case"clone":me.items.items[ii].setDisabled(disable);break;case"activateAllContent":break;case"showArchivedContent":break;case"hideArchivedContent":break;case"editTransitionRules":break;case"delete":me.items.items[ii].setDisabled(disable);break;case"activate":break;case"deactivate":break;case"schedule":break;case"archive":me.items.items[ii].setDisabled(disable);break;case"unarchive":me.items.items[ii].setDisabled(disable);break;case"remove":break;case"emailEditDraft":break;case"emailPreview":break;case"emailApproveDraft":me.items.items[ii].setDisabled(disable);break;case"emailSendTest":break;case"goToEmail":break;case"emailEditDraft":break;case"emailPreviewDraft":break;case"emailSendTestOfDraft":break;case"emailApproveDraft":me.items.items[ii].setDisabled(disable);break;case"programViewAssets":break;case"programViewSetup":break;case"programViewTokens":break;case"programViewMembers":break;case"goToProgram":break;case"mobilePushEditDraft":break;case"mobilePushPreview":break;case"mobilePushApprove":me.items.items[ii].setDisabled(disable);break;case"mobilePushSendTest":break;case"goToPushNotification":break;case"edit":break;case"hide":me.items.items[ii].setDisabled(disable);break;case"unhide":me.items.items[ii].setDisabled(disable);break;default:break;}}}else{var ii,disable=APP.evaluateMenu("button",null,null,null);for(ii=0;ii<me.items.items.length;ii++){switch(me.items.items[ii].action){case"edit":break;case"publish":me.items.items[ii].setDisabled(disable);break;case"discardDraft":break;case"delete":me.items.items[ii].setDisabled(disable);break;case"send":me.items.items[ii].setDisabled(disable);break;case"verify":me.items.items[ii].setDisabled(disable);break;default:break;}}}};}else{console.log("Marketo App > Skipped: Disable Content & Actions Menus for Marketing Activities > Nurture Program Stream");}};APP.overrideDraftEdits=function(){console.log("Marketo App > Overriding: Draft Edit Menu Items");if(typeof(MktDsMenu)!=="undefined"&&MktDsMenu){console.log("Marketo App > Executing: Override Draft Edit Menu Items");var origExtMessageBoxShow=Ext.MessageBox.show;origExt4MessageBoxShow=Ext4.MessageBox.show;origMktMessageShow=MktMessage.show;origPageEditHandler=MktDsMenu.getPageMenu().get("pageEdit").handler,origPageDraftEditHandler=MktDsMenu.getPageMenu().get("pageDraftEdit").handler,origEmailEditHandler=MktDsMenu.getEmailMenu().get("emailEdit").handler,origEmailDraftEditHandler=MktDsMenu.getEmailMenu().get("emailDraftEdit").handler;MktDsMenu.getPageMenu().get("pageDraftEdit").setHandler(function(el){if(attr&&attr.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1){console.log("Marketo App > Executing: Override Draft Edit Menu Items > Landing Page Draft Edit");var triggeredFrom=this.parentMenu.triggeredFrom,xtra=el.parentMenu.xtra;Mkt.app.DesignStudio.Pages.discardDraft({triggeredFrom:triggeredFrom,xtra:xtra});el.parentMenu.hide(true);Ext.MessageBox.hide();Mkt.app.DesignStudio.Pages.editPageDraft({triggeredFrom:triggeredFrom,xtra:xtra});}else{origPageDraftEditHandler.apply(this,arguments);}});MktDsMenu.getEmailMenu().get("emailEdit").setHandler(function(el){if(attr&&attr.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1){console.log("Marketo App > Executing: Override Draft Edit Menu Items > Email Edit");var triggeredFrom=this.parentMenu.triggeredFrom,xtra=el.parentMenu.xtra,newEl=this.getEl();Ext.MessageBox.show=Ext4.MessageBox.show=MktMessage.show=function(){};Mkt.app.DesignStudio.Emails.discardDraft({triggeredFrom:triggeredFrom,xtra:xtra});el.parentMenu.hide(true);Mkt.app.DesignStudio.Emails.editDraft({triggeredFrom:triggeredFrom,xtra:xtra,el:newEl});window.setTimeout(function(){console.log("Marketo App > Restoring: System Messages");Ext.MessageBox.show=origExtMessageBoxShow;Ext4.MessageBox.show=origExt4MessageBoxShow;MktMessage.show=origMktMessageShow;},5000);}else{origEmailEditHandler.apply(this,arguments);}});MktDsMenu.getEmailMenu().get("emailDraftEdit").setHandler(function(el){if(attr&&attr.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1){console.log("Marketo App > Executing: Override Draft Edit Menu Items > Email Draft Edit");var triggeredFrom=this.parentMenu.triggeredFrom,xtra=el.parentMenu.xtra,newEl=this.getEl();Mkt.app.DesignStudio.Emails.discardDraft({triggeredFrom:triggeredFrom,xtra:xtra});el.parentMenu.hide(true);Mkt.app.DesignStudio.Emails.editDraft({triggeredFrom:triggeredFrom,xtra:xtra,el:newEl});}else{origEmailDraftEditHandler.apply(this,arguments);}});}else{console.log("Marketo App > Skipping: Override Draft Edit Menu Items");}};APP.hideToolbarItems=function(){console.log("Marketo App > Hiding: Toolbar Items");if(typeof(Ext)!=="undefined"&&Ext&&Ext.layout&&Ext.layout.ContainerLayout&&Ext.layout.ContainerLayout.prototype&&Ext.layout.ContainerLayout.prototype.renderItem){Ext.layout.ContainerLayout.prototype.renderItem=function(c,position,target){if(c){if(!c.rendered){c.render(target,position);this.configureItem(c,position);}else if(!this.isValidParent(c,target)){if(Ext.isNumber(position)){position=target.dom.childNodes[position];}
target.dom.insertBefore(c.getPositionEl().dom,position||null);c.container=target;this.configureItem(c,position);}}
if(typeof(c)!=="undefined"&&c&&c.topToolbar&&c.topToolbar.items){console.log("Marketo App > Executing: Disable Toolbar items for ALL in ALL");var origExtMessageBoxShow=Ext.MessageBox.show,origExt4MessageBoxShow=Ext4.MessageBox.show,origMktMessageShow=MktMessage.show,item,canvas=MktCanvas.getActiveTab(),disable=APP.evaluateMenu("button",null,canvas,null),itemsToHide=[{"id":"deleteItem","action":"setVisible",},{"id":"deleteSubscription_atxCanvasSubscriptions","action":"setVisible",},{"id":"formEdit_landingFODetail","action":"handler",},{"id":"pageEdit_landingLPDetail","action":"handler",},{"id":"emailEdit_landingEMDetail","action":"handler",},{"id":"gotoDeliverability_landingEMDetail","action":"setVisible",},{"id":"deleteCustomToken","action":"setVisible",},{"id":"importMembers","action":"setDisabled",},{"id":"importTemplate_landingCanvasTM","action":"setDisabled",},{"id":"importTemplate_landingTMDetail","action":"setDisabled",},{"id":"gotoDeliverability_landingCanvasEM","action":"setVisible",},{"id":"imageUpload_landingCanvasIM","action":"setDisabled",},{"id":"imageReplace_landingCanvasIM","action":"setVisible",},{"id":"imageUpload_landingIMDetail","action":"setDisabled",},{"id":"imageReplace_landingIMDetail","action":"setVisible",},{"id":"editDraft_rcmCanvasOverview","action":"setVisible",},{"id":"editLicenses","action":"setVisible",},{"id":"deleteUser","action":"setVisible",},{"id":"resetPassword","action":"setVisible",},{"id":"deleteRole","action":"setVisible",},{"id":"deleteZone","action":"setVisible",},{"id":"deletePartition","action":"setVisible",},{"id":"deleteDomain","action":"setVisible",},{"id":"dkimDetails","action":"setDisabled",},{"id":"refreshCadSfdcObjectSync","action":"setDisabled",},{"id":"enableSync","action":"setVisible",},{"id":"revokeLicenseCadLisAdmin","action":"setVisible",},{"id":"resendLicenseCadLisAdmin","action":"setVisible",},{"id":"configAddinCadLisAdmin","action":"setVisible",},{"text":"Rules Actions","action":"setVisible",},{"id":"deleteRule","action":"setVisible",},{"id":"launchpointActions","action":"setVisible",},{"id":"cadChangeButton","action":"setVisible",},];itemsToHide.forEach(function(itemToHide){if(itemToHide.id){item=c.topToolbar.items.get(itemToHide.id);}else if(itemToHide.text){item=c.topToolbar.find("text",itemToHide.text)[0];}
if(item){if(itemToHide.id=="gotoDeliverability_landingEMDetail"){item.setVisible(false);}else if(itemToHide.action=="setVisible"){item.setVisible(!disable);}else if(itemToHide.action=="setDisabled"){item.setDisabled(disable);}
switch(itemToHide.id){case"pageEdit_landingLPDetail":var origHandler=item.handler;item.setHandler(function(){if(attr&&attr.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1){console.log("Marketo App > Executing: Override Edit Draft Toolbar Button > Landing Page");var discardMsg=Ext.MessageBox.show({title:"MarketoLive",msg:"Discarding Draft",progress:false,wait:false,width:270,closable:true});Mkt.app.DesignStudio.Pages.discardDraft({triggeredFrom:"button",xtra:attr});discardMsg.hide();Mkt.app.DesignStudio.Pages.editPage({triggeredFrom:"button",el:this.getEl()});}else{origHandler.apply(this,arguments);}});break;case"emailEdit_landingEMDetail":var origHandler=item.handler;item.setHandler(function(button,e){if(attr&&attr.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1){console.log("Marketo App > Executing: Override Edit Draft Toolbar Button > Email");Ext.MessageBox.show=Ext4.MessageBox.show=MktMessage.show=function(){};Mkt.app.DesignStudio.Emails.discardDraft({triggeredFrom:'button',xtra:attr,el:this.getEl()});Mkt.app.DesignStudio.Emails.editDraft({triggeredFrom:'button',panelId:attr.panelId});window.setTimeout(function(){console.log("Marketo App > Restoring: System Messages");Ext.MessageBox.show=origExtMessageBoxShow;Ext4.MessageBox.show=origExt4MessageBoxShow;MktMessage.show=origMktMessageShow;},5000);}else{origHandler.apply(this,arguments);}});break;}}});}};}};APP.hideOtherToolbarItems=function(itemsToHide){var isTopToolbarActive=window.setInterval(function(){console.log("Marketo App > Hiding: Other Toolbar Items");if(typeof(MktCanvas)!=="undefined"&&MktCanvas&&MktCanvas.getActiveTab()&&MktCanvas.getActiveTab().getTopToolbar()){console.log("Marketo App > Executing: Hiding Other Toolbar Items");window.clearInterval(isTopToolbarActive);var topToolbar=MktCanvas.getActiveTab().getTopToolbar();itemsToHide.forEach(function(itemToHide){if(itemToHide.id){item=topToolbar.items.get(itemToHide.id);}else if(itemToHide.text){item=topToolbar.find("text",itemToHide.text)[0];}
if(item){if(itemToHide.action=="setVisible"){item.setVisible(false);}else if(itemToHide.action=="setDisabled"){item.setDisabled(true);}}});}},0);};APP.reloadMarketingActivites=function(){var context={compSubtype:null,customToken:"",dlCompCode:"MA",type:"MA"};customToken=Mkt3.DlManager.getCustomToken(),params=Ext.urlDecode(customToken);if(context&&(context.compType==='Marketing Event'||context.compType==='Marketing Program'||context.compSubtype==='marketingprogram'||context.compSubtype==='marketingevent')){Mkt3.MKNodeContext.timingReport={navLoadCal:Ext4.Date.now(),calendarMode:'Program'};}
var alreadyInMA=MktMainNav.activeNav=="tnMA";var ajopts=MktMainNav.commonPreLoad("tnMA",context);if(MktPage.initNav=='yes'){MktExplorer.clear();MktExplorer.mask();var parms=context;if(!MktPage.satellite){MktViewport.setExplorerVisible(true);MktExplorer.loadTree('explorer/generateFullMaExplorer',{serializeParms:parms,onMyFailure:MktMainNav.expFailureResponse.createDelegate(this)});}
parms={};ajopts.serializeParms=parms;if(isDefined(context.panelIndex)){parms.panelIndex=context.panelIndex;}
if(context.isProgramImport){params.id=context.compId;if(MktPage.hasWorkspaces()){MktCanvas.canvasAjaxRequest('explorer/programCanvas',{onMySuccess:function(){Ext4.widget('programOneClickImportForm',{formData:params});MktViewport.setAppMask(false);}});return true;}
MktSession.ajaxRequest('/impExp/downloadTemplate',{serializeParms:params,onMySuccess:function(response,request){if(response.JSONResults){if(response.JSONResults.showImportStatus===true){MktCanvas.canvasAjaxRequest('explorer/programCanvas',{onMySuccess:function(){Mkt.apps.impExp.importProgramStatus();MktViewport.setAppMask(false);}});}else if(response.JSONResults.errorMessage){window.location.hash='#MA';MktPage.showAlertMessage(MktLang.getStr('page.Import_Warning'),MktLang.getStr('page.Import_Failed')+
response.JSONResults.errorMessage,'/images/icons32/error.png');}}}});}else if((context.compSubtype=="marketingfolder"||context.compType=="Marketing Folder")||context.subType=="marketingfolder"){MktMainNav.loadPE(context);}else if((context.compSubtype=="smartcampaign")||(context.subType=="smartcampaign")||(context.compType=="Smart Campaign")){MktMainNav.loadSmartCampaign(context);}else if((context.compSubtype=="marketingevent")||(context.subType=="marketingevent")||(context.compType=="Marketing Event")){MktMainNav.loadMarketingEvent(context);}else if((context.compSubtype=="marketingprogram")||(context.subType=="marketingprogram")||(context.compType=="Marketing Program")){MktMainNav.loadMarketingProgram(context);}else if((context.compSubtype=="nurtureprogram")||(context.subType=="nurtureprogram")||(context.compType=="Nurture Program")){MktMainNav.loadNurtureProgram(context);}else if(context.compSubtype==='emailbatchprogram'||(context.subType==="emailbatchprogram")||(context.compType==="Email Batch Program")){MktMainNav.loadEmailBatchProgram(context);}else if(context.compSubtype==='inApp'||(context.subType==="inAppProgram")||(context.compType==="In-App Program")){MktMainNav.loadInAppProgram(context);}else if(context.nodeType=='Flow'){MktMainNav.loadFlow();}else{if(isUndefined(context.nodeId)&&isUndefined(context.selectedNode)){var pass;}
ajopts.cacheRequest=true;ajopts.onMySuccess=MktMainNav.canvasAjaxRequestComplete.createDelegate(MktMainNav);ajopts.onMyFailure=MktMainNav.canvasAjaxRequestComplete.createDelegate(MktMainNav);MktCanvas.canvasAjaxRequest('explorer/programCanvas',ajopts);}}
return true;};APP.cloneFolder=function(origFolderName,cloneToAffix,cloneToFolderId){var newFolderName,result;if(origFolderName.search(/\([^\)]*\)$/)!=-1){newFolderName=origFolderName.replace(/\([^\)]*\)$/,"("+cloneToAffix+")");}else{newFolderName=origFolderName.text+" ("+cloneToAffix+")";}
result=APP.webRequest('/explorer/createProgramFolder','ajaxHandler=MktSession&mktReqUid='+new Date().getTime()+Ext.id(null,':')+'&text='+newFolderName+'&parentId='+cloneToFolderId+'&tempNodeId=ext-'+cloneToFolderId+'&xsrfId='+MktSecurity.getXsrfId(),'POST',false,"",function(response){console.log(response);response=JSON.parse(response);if(response&&response.JSONResults&&response.JSONResults.appvars&&response.JSONResults.appvars.createProgramFolderResult=="success"){return response;}else{return false;}});return result;};APP.cloneProgram=function(cloneToAffix,cloneToFolderId,origProgramTreeNode){var newProgramName,newProgramType,result;if(origProgramTreeNode.text.search(/\([^\)]*\)$/)!=-1){newProgramName=origProgramTreeNode.text.replace(/\([^\)]*\)$/,"("+cloneToAffix+")");}else{newProgramName=origProgramTreeNode.text+" ("+cloneToAffix+")";}
switch(origProgramTreeNode.compType){case"Marketing Program":newProgramType="program";break;case"Nurture Program":newProgramType="nurture";break;case"Marketing Event":newProgramType="event";break;case"Email Batch Program":newProgramType="emailBatchProgram";break;case"In-App Program":newProgramType="inAppProgram";break;}
if(newProgramType){result=APP.webRequest('/marketingEvent/createMarketingProgramSubmit','ajaxHandler=MktSession&mktReqUid='+new Date().getTime()+Ext.id(null,':')+'&name='+newProgramName+'&description='+'&parentFolderId='+cloneToFolderId+'&cloneFromId='+origProgramTreeNode.compId+'&type='+newProgramType+'&xsrfId='+MktSecurity.getXsrfId(),'POST',false,"",function(response){console.log(response);response=JSON.parse(response);if(response&&response.JSONResults&&response.JSONResults.appvars&&response.JSONResults.appvars.result=="Success"){return response;}else{return false;}});return result;}else{return false;}};APP.getProgramSettings=function(programTreeNode){var result=APP.webRequest('/marketingEvent/getProgramSettingsData','&start=0'+'&query='+'&compId='+programTreeNode.compId+'&compType='+programTreeNode.compType+'&xsrfId='+MktSecurity.getXsrfId(),'POST',false,"",function(response){console.log(response);response=JSON.parse(response);if(response&&response.success){return response;}else{return false;}});return result;};APP.clonePeriodCost=function(origProgramSettingsData,newProgramCompId,numOfMonths,offset,inherit){var currYear=new Date().getFullYear(),currMonth=new Date().getMonth()+1,setPeriodCost;setPeriodCost=function(newProgramCompId,costDate,costAmount){APP.webRequest('/marketingEvent/setCostSubmit','ajaxHandler=MktSession&mktReqUid='+new Date().getTime()+Ext.id(null,':')+'&compId='+newProgramCompId+'&costId='+'&type=period'+'&startDate='+costDate+'&amount='+costAmount.toString()+'&description='+'&xsrfId='+MktSecurity.getXsrfId(),'POST',false,"",function(response){console.log(response);});};if(inherit&&origProgramSettingsData){var currPeriodCost;for(var ii=0;ii<origProgramSettingsData.length;ii++){currPeriodCost=origProgramSettingsData[ii];if(currPeriodCost.itemType=="period"&&currPeriodCost.summaryData.amount&&currPeriodCost.summaryData.startDate){var currCostMonth=currPeriodCost.summaryData.startDate.replace(/^[0-9][0-9][0-9][0-9]-/,''),currCostAmount=currPeriodCost.summaryData.amount,currCostYear,currCostDate;if(currYear>parseInt(currPeriodCost.summaryData.startDate.match(/^[0-9][0-9][0-9][0-9]/))){currCostYear=currYear+(currYear-parseInt(currPeriodCost.summaryData.startDate.match(/^[0-9][0-9][0-9][0-9]/)));}else{currCostYear=parseInt(currPeriodCost.summaryData.startDate.match(/^[0-9][0-9][0-9][0-9]/));}
currCostDate=currCostYear.toString()+'-'+currCostMonth.toString();setPeriodCost(newProgramCompId,currCostDate,currCostAmount);}}}else if(origProgramSettingsData&&origProgramSettingsData[0]&&origProgramSettingsData[0].summaryData&&origProgramSettingsData[0].summaryData.amount){if(!numOfMonths){numOfMonths=24;}
for(var ii=0;ii<numOfMonths;ii++){var currCostDate,currCostAmount;if(currMonth>12){currMonth=1;currYear+=1;}
currCostDate=currYear.toString()+'-'+currMonth.toString();currMonth+=1;currCostAmount=parseInt(origProgramSettingsData[0].summaryData.amount);if(offset){if(Math.random()<=0.5){currCostAmount+=Math.ceil(Math.random()*offset);}else{currCostAmount-=Math.ceil(Math.random()*offset);}}
setPeriodCost(newProgramCompId,currCostDate,currCostAmount);}}};APP.setProgramTag=function(origProgramSettingsData,newProgramCompId,tagName,tagValue){var currSetting,tagData;for(var ii=0;ii<origProgramSettingsData.length;ii++){currSetting=origProgramSettingsData[ii];if(currSetting.summaryData.name==tagName){tagData=encodeURIComponent('{"programId":'+newProgramCompId+',"programDescriptorId":'+parseInt(currSetting.id.replace(/^PD-/,''))+',"descriptorId":'+currSetting.descriptorId+',"descriptorValue":"'+tagValue+'"}');break;}}
if(tagData){APP.webRequest('/marketingEvent/setProgramDescriptorSubmit','ajaxHandler=MktSession&mktReqUid='+new Date().getTime()+Ext.id(null,':')+'&compId='+newProgramCompId+'&_json='+tagData+'&xsrfId='+MktSecurity.getXsrfId(),'POST',false,"",function(response){console.log(response);});}};APP.cloneNurtureCadence=function(origProgramCompId,newProgramCompId){var getNurtureCadence,getOrigNurtureCadenceResponse,getNewNurtureCadenceResponse;getNurtureCadence=function(programCompId){var programFilter=encodeURIComponent('[{"property":"id","value":'+programCompId+'}]'),fields=encodeURIComponent('["+tracks"]'),result;result=APP.webRequest('/data/nurture/retrieve','filter='+programFilter+'&fields='+fields+'&xsrfId='+MktSecurity.getXsrfId(),'POST',false,"",function(response){console.log(response);response=JSON.parse(response);if(response&&response.success){return response;}else{return false;}});return result;};getOrigNurtureCadenceResponse=getNurtureCadence(origProgramCompId);getNewNurtureCadenceResponse=getNurtureCadence(newProgramCompId);if(getOrigNurtureCadenceResponse&&getNewNurtureCadenceResponse&&getOrigNurtureCadenceResponse.data[0].tracks.length==getNewNurtureCadenceResponse.data[0].tracks.length){var currOrigStream,currNewStream,streamCadences='[';for(var ii=0;ii<getOrigNurtureCadenceResponse.data[0].tracks.length;ii++){currOrigStream=getOrigNurtureCadenceResponse.data[0].tracks[ii];currNewStream=getNewNurtureCadenceResponse.data[0].tracks[ii];if(ii!=0){streamCadences+=',';}
streamCadences+='{"id":'+currNewStream.id+',"recurrenceType":"'+currOrigStream.recurrenceType+'","everyNUnit":'+currOrigStream.everyNUnit+',"weekMask":"'+currOrigStream.weekMask+'","startDate":"'+currOrigStream.startDate+'"}';}
streamCadences+=']';streamCadences=streamCadences.replace(/\"null\"/g,'null');APP.webRequest('/data/nurtureTrack/update','data='+encodeURIComponent(streamCadences)+'&xsrfId='+MktSecurity.getXsrfId(),'POST',false,"",function(response){console.log(response);});}};APP.getProgramAssetDetails=function(programCompId){var result=APP.webRequest('/marketingEvent/getLocalAssetDetails','ajaxHandler=MktSession&mktReqUid='+new Date().getTime()+Ext.id(null,':')+'&compId='+programCompId+'&xsrfId='+MktSecurity.getXsrfId(),'POST',false,"",function(response){console.log(response);response=JSON.parse(response);if((response&&response.JSONResults&&response.JSONResults.localAssetInfo)&&(response.JSONResults.localAssetInfo.smartCampaigns||(response.JSONResults.localAssetInfo.assetList[0]&&response.JSONResults.localAssetInfo.assetList[0].tree))){return response.JSONResults.localAssetInfo;}else{return false;}});return result;};APP.cloneSmartCampaignState=function(origProgramCompId,newProgramCompId,forceActivate){var getOrigProgramAssetDetailsResponse,getNewProgramAssetDetailsResponse;getOrigProgramAssetDetailsResponse=APP.getProgramAssetDetails(origProgramCompId);getNewProgramAssetDetailsResponse=APP.getProgramAssetDetails(newProgramCompId);if(getOrigProgramAssetDetailsResponse&&getNewProgramAssetDetailsResponse){var setSmartCampaignState;setSmartCampaignState=function(getOrigProgramAssetDetailsResponse,getNewProgramAssetDetailsResponse){var currOrigProgramSmartCampaign,currNewProgramSmartCampaign,getScheduleResponse;for(var ii=0;ii<getOrigProgramAssetDetailsResponse.smartCampaigns.length;ii++){currOrigProgramSmartCampaign=getOrigProgramAssetDetailsResponse.smartCampaigns[ii];currNewProgramSmartCampaign=getNewProgramAssetDetailsResponse.smartCampaigns[ii];if(currOrigProgramSmartCampaign.compType==currNewProgramSmartCampaign.compType&&currOrigProgramSmartCampaign.compType=="Smart Campaign"&&currOrigProgramSmartCampaign.name==currNewProgramSmartCampaign.name){if(currOrigProgramSmartCampaign.status==7||(currOrigProgramSmartCampaign.status==6&&forceActivate)){APP.webRequest('/smartcampaigns/toggleActiveStatus','ajaxHandler=MktSession&mktReqUid='+new Date().getTime()+Ext.id(null,':')+'&smartCampaignId='+currNewProgramSmartCampaign.compId+'&xsrfId='+MktSecurity.getXsrfId(),'POST',false,"",function(result){console.log(result);});}
if(currOrigProgramSmartCampaign.status==3||currOrigProgramSmartCampaign.status==5){APP.webRequest('/smartcampaigns/editScheduleRS','ajaxHandler=MktSession&mktReqUid='+new Date().getTime()+Ext.id(null,':')+'&isRequest=1'+'&smartCampaignId='+currOrigProgramSmartCampaign.compId+'&xsrfId='+MktSecurity.getXsrfId(),'POST',false,"",function(response){console.log(response);if(response.match(/MktPage\.appVars\.scheduleData = {([^=]|\n|\\n)*}/)[0]){getScheduleResponse=JSON.parse(response.match(/MktPage\.appVars\.scheduleData = {([^=]|\n|\\n)*}/)[0].replace(/MktPage\.appVars\.scheduleData = {/,'{').replace(/\'/g,'"').replace(/\\n */g,'"').replace(/: +/g,'": ').replace(/\"\/\/[^\"]+\"/g,'"').replace(/\"}$/,'}'));}});if(getScheduleResponse){var startAtDate=new Date(Date.parse(getScheduleResponse.start_at)),startAt=startAtDate.getFullYear()+"-"+parseInt(startAtDate.getMonth()+1)+"-"+startAtDate.getDate()+" "+startAtDate.getHours()+":"+startAtDate.getMinutes()+":"+startAtDate.getSeconds();APP.webRequest('/smartcampaigns/recurCampSchedule','ajaxHandler=MktSession&mktReqUid='+new Date().getTime()+Ext.id(null,':')+'&smartCampaignId='+currNewProgramSmartCampaign.compId+'&recurrence_type='+getScheduleResponse.recurrence_type+'&every_n_unit='+getScheduleResponse.every_n_unit+'&start_at='+startAt+'&end_at='+'&every_weekday='+getScheduleResponse.every_weekday+'&week_mask='+getScheduleResponse.week_mask+'&recurDay_of_month='+getScheduleResponse.recurDay_of_month+'&recurMonth_day_type='+getScheduleResponse.recurMonth_day_type+'&recurMonth_week_type='+getScheduleResponse.recurMonth_week_type+'&xsrfId='+MktSecurity.getXsrfId(),'POST',false,"",function(result){console.log(result);});}}}}};if(getOrigProgramAssetDetailsResponse.smartCampaigns.length==getNewProgramAssetDetailsResponse.smartCampaigns.length){setSmartCampaignState(getOrigProgramAssetDetailsResponse,getNewProgramAssetDetailsResponse);}
if(getOrigProgramAssetDetailsResponse.assetList[0].tree.length==getNewProgramAssetDetailsResponse.assetList[0].tree.length){var currOrigProgramAsset,currNewProgramAsset;for(var ii=0;ii<getOrigProgramAssetDetailsResponse.assetList[0].tree.length;ii++){currOrigProgramAsset=getOrigProgramAssetDetailsResponse.assetList[0].tree[ii];currNewProgramAsset=getNewProgramAssetDetailsResponse.assetList[0].tree[ii];if(currOrigProgramAsset.navType=="MA"&&currNewProgramAsset.navType=="MA"){setSmartCampaignState(APP.getProgramAssetDetails(currOrigProgramAsset.compId),APP.getProgramAssetDetails(currNewProgramAsset.compId));}}}}
return getNewProgramAssetDetailsResponse;};APP.setProgramReportFilter=function(getNewProgramAssetDetailsResponse,cloneToFolderId,newProgramCompId){var applyProgramReportFilter;applyProgramReportFilter=function(getNewProgramAssetDetailsResponse,cloneToFolderId){var currNewReport;for(var ii=0;ii<getNewProgramAssetDetailsResponse.assetList[0].tree.length;ii++){currNewReport=getNewProgramAssetDetailsResponse.assetList[0].tree[ii];if(currNewReport.compType=="Report"){var reportFilterType,selectedNodes;if((/^Email/i).test(currNewReport.text)){reportFilterType="maEmail";selectedNodes='["'+cloneToFolderId+'"]';}else if((/^(Engagement|Nurtur)/i).test(currNewReport.text)){reportFilterType="nurtureprogram";selectedNodes='["'+cloneToFolderId+'"]';}else if((/^Landing/i).test(currNewReport.text)){reportFilterType="maLanding";selectedNodes='["'+cloneToFolderId+'"]';}else if((/^Program/i).test(currNewReport.text)){reportFilterType="program";selectedNodes='["'+cloneToFolderId+'"]';}
if(reportFilterType&&selectedNodes){APP.webRequest('/analytics/applyComponentFilter','ajaxHandler=MktSession&mktReqUid='+new Date().getTime()+Ext.id(null,':')+'&nodeIds='+selectedNodes+'&filterType='+reportFilterType+'&reportId='+currNewReport.compId+'&xsrfId='+MktSecurity.getXsrfId(),'POST',false,"",function(response){console.log(response);});}}}};if(cloneToFolderId){if(getNewProgramAssetDetailsResponse){applyProgramReportFilter(getNewProgramAssetDetailsResponse,cloneToFolderId);}else if(newProgramCompId){applyProgramReportFilter(APP.getProgramAssetDetails(newProgramCompId),cloneToFolderId);}}};APP.getTags=function(){var result=APP.webRequest('/marketingEvent/getAllDescriptors','&start=0'+'&xsrfId='+MktSecurity.getXsrfId(),'POST',false,"",function(response){;console.log(response);response=JSON.parse(response);if(response.success){var currTag,jj=0,customTags=[];for(var ii=0;ii<response.data.descriptors.length;ii++){currTag=response.data.descriptors[ii];if(currTag.type!="channel"){customTags[jj]=currTag;jj++;}}
return customTags;}else{return false;}});return result;};APP.applyMassClone=function(forceReload){console.log("Marketo Demo App > Applying: Mass Clone Menu Item");massClone=function(){if(this.triggeredFrom=="tree"&&this.get("newLocalAsset")){var massCloneItem=this.get("newLocalAsset").cloneConfig(),massCloneItemId="cloneVertical",currExpNode=MktExplorer.getNodeById(this.currNode.attributes.id);if(!this.get(massCloneItemId)){massCloneItem.itemId=massCloneItemId;massCloneItem.text="Mass Clone";massCloneItem.setHandler(function(el){var cloneForm=new Mkt.apps.marketingEvent.MarketingEventForm({cloneFromId:this.ownerCt.currNode.attributes.compId,cloneName:this.ownerCt.currNode.attributes.text,accessZoneId:this.ownerCt.currNode.attributes.accessZoneId}),cloneFromField=cloneForm.find("fieldLabel","Clone From")[0].cloneConfig(),scActivationField=cloneForm.find("fieldLabel","Clone To")[0].cloneConfig(),showMoreOptionsField=new Mkt.apps.marketingEvent.MarketingEventForm({cloneFromId:this.ownerCt.currNode.attributes.compId,cloneName:this.ownerCt.currNode.attributes.text,accessZoneId:this.ownerCt.currNode.attributes.accessZoneId}).find("fieldLabel","Clone To")[0].cloneConfig(),periodCostCloneField=new Mkt.apps.marketingEvent.MarketingEventForm({cloneFromId:this.ownerCt.currNode.attributes.compId,cloneName:this.ownerCt.currNode.attributes.text,accessZoneId:this.ownerCt.currNode.attributes.accessZoneId}).find("fieldLabel","Clone To")[0].cloneConfig(),periodCostMonthField=new Mkt.apps.marketingEvent.MarketingEventForm({cloneFromId:this.ownerCt.currNode.attributes.compId,cloneName:this.ownerCt.currNode.attributes.text,accessZoneId:this.ownerCt.currNode.attributes.accessZoneId}).find("fieldLabel","Clone To")[0].cloneConfig(),periodCostOffsetField=new Mkt.apps.marketingEvent.MarketingEventForm({cloneFromId:this.ownerCt.currNode.attributes.compId,cloneName:this.ownerCt.currNode.attributes.text,accessZoneId:this.ownerCt.currNode.attributes.accessZoneId}).find("fieldLabel","Name")[0].cloneConfig(),tagNameField=new Mkt.apps.marketingEvent.MarketingEventForm({cloneFromId:this.ownerCt.currNode.attributes.compId,cloneName:this.ownerCt.currNode.attributes.text,accessZoneId:this.ownerCt.currNode.attributes.accessZoneId}).find("fieldLabel","Clone To")[0].cloneConfig(),tagValueField=new Mkt.apps.marketingEvent.MarketingEventForm({cloneFromId:this.ownerCt.currNode.attributes.compId,cloneName:this.ownerCt.currNode.attributes.text,accessZoneId:this.ownerCt.currNode.attributes.accessZoneId}).find("fieldLabel","Clone To")[0].cloneConfig(),massCloneForm=new Mkt.apps.marketingEvent.MarketingEventForm({currNode:this.ownerCt.currNode}),customTags,currCustomTag,currCustomTagName,currCustomTagValue;el.parentMenu.hide(true);var isCloneVerticalForm=window.setInterval(function(){if(massCloneForm&&massCloneForm.buttons[1]&&massCloneForm.buttons[1].setHandler&&massCloneForm.find("fieldLabel","Channel")[0]&&massCloneForm.find("fieldLabel","Channel")[0].destroy&&massCloneForm.find("fieldLabel","Description")[0]&&massCloneForm.find("fieldLabel","Description")[0].destroy&&massCloneForm.find("fieldLabel","Program Type")[0]&&massCloneForm.find("fieldLabel","Program Type")[0].destroy&&massCloneForm.find("fieldLabel","Campaign Folder")[0]&&massCloneForm.find("fieldLabel","Campaign Folder")[0].fieldLabel&&massCloneForm.find("fieldLabel","Name")[0]&&massCloneForm.find("fieldLabel","Name")[0].fieldLabel&&massCloneForm.items.last().setText&&massCloneForm.items.last().setVisible&&massCloneForm.setWidth&&massCloneForm.setHeight){window.clearInterval(isCloneVerticalForm);massCloneForm.setTitle("Mass Clone");massCloneForm.buttons[1].setText("Clone");massCloneForm.buttons[1].currNode=massCloneForm.currNode;massCloneForm.find("fieldLabel","Channel")[0].destroy();massCloneForm.find("fieldLabel","Description")[0].destroy();massCloneForm.find("fieldLabel","Program Type")[0].destroy();massCloneForm.find("fieldLabel","Campaign Folder")[0].fieldLabel="Clone To";massCloneForm.find("fieldLabel","Name")[0].fieldLabel="Program Affix";showMoreOptionsField.fieldLabel="Show More Options";showMoreOptionsField.itemCls="";showMoreOptionsField.store.data.items[0].set("text","No");showMoreOptionsField.store.data.items[1].set("text","Yes");scActivationField.fieldLabel="SC Activation State";scActivationField.itemCls="";scActivationField.store.data.items[0].set("text","Inherit State");scActivationField.store.data.items[1].set("text","Force Activate");periodCostCloneField.fieldLabel="Period Cost Data";periodCostCloneField.itemCls="";periodCostCloneField.store.data.items[0].set("text","Inherit Data");periodCostCloneField.store.data.items[1].set("text","Baseline Data");periodCostMonthField.fieldLabel="Period Cost Months";periodCostMonthField.itemCls="mktRequired";periodCostMonthField.store.data.items[0].set("text","12 Months");periodCostMonthField.store.data.items[1].set("text","24 Months");periodCostOffsetField.fieldLabel="Period Cost Offset";periodCostOffsetField.itemCls="";tagNameField.fieldLabel="Change Tag Type";tagNameField.itemCls="";tagValueField.fieldLabel="New Tag Value";tagValueField.itemCls="mktRequired";var origOnSelect=showMoreOptionsField.onSelect;showMoreOptionsField.onSelect=function(doFocus){origOnSelect.apply(this,arguments);if(this.value==2){this.ownerCt.find("fieldLabel","SC Activation State")[0].label.setVisible(true);this.ownerCt.find("fieldLabel","SC Activation State")[0].setVisible(true);this.ownerCt.find("fieldLabel","Period Cost Data")[0].label.setVisible(true);this.ownerCt.find("fieldLabel","Period Cost Data")[0].setVisible(true);this.ownerCt.find("fieldLabel","Change Tag Type")[0].label.setVisible(true);this.ownerCt.find("fieldLabel","Change Tag Type")[0].setVisible(true);}else{this.ownerCt.find("fieldLabel","Change Tag Type")[0].setVisible(false);this.ownerCt.find("fieldLabel","Change Tag Type")[0].label.setVisible(false);this.ownerCt.find("fieldLabel","Period Cost Offset")[0].setVisible(false);this.ownerCt.find("fieldLabel","Period Cost Offset")[0].label.setVisible(false);this.ownerCt.find("fieldLabel","Period Cost Months")[0].setVisible(false);this.ownerCt.find("fieldLabel","Period Cost Months")[0].label.setVisible(false);}};periodCostCloneField.onSelect=function(doFocus){origOnSelect.apply(this,arguments);if(this.value==2){this.ownerCt.find("fieldLabel","Period Cost Months")[0].label.setVisible(true);this.ownerCt.find("fieldLabel","Period Cost Months")[0].setVisible(true);this.ownerCt.find("fieldLabel","Period Cost Offset")[0].label.setVisible(true);this.ownerCt.find("fieldLabel","Period Cost Offset")[0].setVisible(true);}else{this.ownerCt.find("fieldLabel","Period Cost Offset")[0].setVisible(false);this.ownerCt.find("fieldLabel","Period Cost Offset")[0].label.setVisible(false);this.ownerCt.find("fieldLabel","Period Cost Months")[0].setVisible(false);this.ownerCt.find("fieldLabel","Period Cost Months")[0].label.setVisible(false);}};tagNameField.onSelect=function(doFocus){origOnSelect.apply(this,arguments);if(this.value){this.ownerCt.find("fieldLabel","New Tag Value")[0].label.setVisible(true);this.ownerCt.find("fieldLabel","New Tag Value")[0].setVisible(true);}else{this.ownerCt.find("fieldLabel","New Tag Value")[0].setVisible(false);this.ownerCt.find("fieldLabel","New Tag Value")[0].label.setVisible(false);}};massCloneForm.insert(0,cloneFromField);massCloneForm.insert(massCloneForm.items.length-1,showMoreOptionsField);massCloneForm.insert(massCloneForm.items.length-1,scActivationField);scActivationField.setVisible(false);massCloneForm.insert(massCloneForm.items.length-1,periodCostCloneField);periodCostCloneField.setVisible(false);massCloneForm.insert(massCloneForm.items.length-1,periodCostMonthField);periodCostMonthField.setVisible(false);massCloneForm.insert(massCloneForm.items.length-1,periodCostOffsetField);periodCostOffsetField.setVisible(false);massCloneForm.insert(massCloneForm.items.length-1,tagNameField);tagNameField.setVisible(false);massCloneForm.insert(massCloneForm.items.length-1,tagValueField);tagValueField.setVisible(false);massCloneForm.buttons[1].setHandler(function(){var waitMsg=new Ext.Window({closable:true,modal:true,width:520,height:225,cls:'mktModalForm',title:'Please Wait ...',html:'<b>Mass Cloning:</b>  <i>'+massCloneForm.currNode.text+'</i><br><br>This may take several minutes depending on the quantity of programs and assets contained therein.'}),cloneToFolderId=massCloneForm.find("fieldLabel","Clone To")[0].getValue(),cloneToAffix=massCloneForm.find("fieldLabel","Program Affix")[0].getValue(),cloneToTreeNode=MktExplorer.getNodeById(cloneToFolderId),scActivationState=scActivationField.getValue(),periodCostClone=periodCostCloneField.getValue(),periodCostOffset=periodCostOffsetField.getValue(),tagName=tagNameField.getValue(),tagValue=tagValueField.getValue(),scForceActivate,inheritPeriodCost,periodCostMonth,numOfPeriodCostMonths,_this=this,waitMsgShow;if(scActivationState==2){scForceActivate=true;}else{scForceActivate=false;}
if(periodCostClone==1){inheritPeriodCost=true;}else{inheritPeriodCost=false;periodCostMonth=periodCostMonthField.getValue();if(periodCostMonth==1){numOfPeriodCostMonths=12;}else if(periodCostMonth==2){numOfPeriodCostMonths=24;}else{numOfPeriodCostMonths=0;}
if(!isNumber(parseInt(periodCostOffset))){periodCostOffset=null;}}
massCloneForm.close();waitMsgShow=waitMsg.show();var isWaitMsgShow=window.setInterval(function(){if(waitMsgShow){window.clearInterval(isWaitMsgShow);var currTreeNode,cloneFolderResponse,cloneProgramResponse,getOrigProgramSettingsResponse,getNewProgramSettingsResponse,getNewProgramAssetDetailsResponse;if(_this.currNode.attributes.compType=="Marketing Folder"){for(var ii=0;_this.currNode.attributes.children&&ii<_this.currNode.attributes.children.length;ii++){currTreeNode=_this.currNode.attributes.children[ii];if(currTreeNode.compType=="Marketing Folder"){cloneFolderResponse=APP.cloneFolder(currTreeNode.text,cloneToAffix,cloneToFolderId);if(cloneFolderResponse){for(var jj=0;currTreeNode.children&&jj<currTreeNode.children.length;jj++){if(currTreeNode.children[jj].compType=="Marketing Folder"){var currFolderTreeNode=currTreeNode.children[jj];cloneFolderResponse=APP.cloneFolder(currFolderTreeNode.text,cloneToAffix,currFolderTreeNode.id);if(cloneFolderResponse){var currOrigProgramTreeNode;for(var kk=0;currFolderTreeNode.children&&kk<currFolderTreeNode.children.length;kk++){currOrigProgramTreeNode=currFolderTreeNode.children[kk];cloneProgramResponse=APP.cloneProgram(cloneToAffix,cloneFolderResponse.JSONResults.actions[0].parameters[0][0].id,currOrigProgramTreeNode);if(cloneProgramResponse){getOrigProgramSettingsResponse=APP.getProgramSettings(currOrigProgramTreeNode);if(getOrigProgramSettingsResponse&&getOrigProgramSettingsResponse.data&&(inheritPeriodCost||numOfPeriodCostMonths>0)){APP.clonePeriodCost(getOrigProgramSettingsResponse.data,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,numOfPeriodCostMonths,parseInt(periodCostOffset),inheritPeriodCost);}
getNewProgramSettingsResponse=APP.getProgramSettings({"compId":cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,"compType":cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compType});if(getNewProgramSettingsResponse&&getNewProgramSettingsResponse.data&&tagName&&tagValue){APP.setProgramTag(getNewProgramSettingsResponse.data,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,tagName,tagValue);}
if(cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compType=="Nurture Program"){APP.cloneNurtureCadence(currOrigProgramTreeNode.compId,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId);}
getNewProgramAssetDetailsResponse=APP.cloneSmartCampaignState(currOrigProgramTreeNode.compId,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,scForceActivate);APP.setProgramReportFilter(getNewProgramAssetDetailsResponse,cloneToFolderId);}}}}else{currOrigProgramTreeNode=currTreeNode.children[jj];cloneProgramResponse=APP.cloneProgram(cloneToAffix,cloneFolderResponse.JSONResults.actions[0].parameters[0][0].id,currOrigProgramTreeNode);if(cloneProgramResponse){getOrigProgramSettingsResponse=APP.getProgramSettings(currOrigProgramTreeNode);if(getOrigProgramSettingsResponse&&getOrigProgramSettingsResponse.data&&(inheritPeriodCost||numOfPeriodCostMonths>0)){APP.clonePeriodCost(getOrigProgramSettingsResponse.data,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,numOfPeriodCostMonths,parseInt(periodCostOffset),inheritPeriodCost);}
getNewProgramSettingsResponse=APP.getProgramSettings({"compId":cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,"compType":cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compType});if(getNewProgramSettingsResponse&&getNewProgramSettingsResponse.data&&tagName&&tagValue){APP.setProgramTag(getNewProgramSettingsResponse.data,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,tagName,tagValue);}
if(cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compType=="Nurture Program"){APP.cloneNurtureCadence(currOrigProgramTreeNode.compId,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId);}
getNewProgramAssetDetailsResponse=APP.cloneSmartCampaignState(currOrigProgramTreeNode.compId,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,scForceActivate);APP.setProgramReportFilter(getNewProgramAssetDetailsResponse,cloneToFolderId);}}}}}else{var currOrigProgramTreeNode=currTreeNode;cloneProgramResponse=APP.cloneProgram(cloneToAffix,cloneToFolderId,currOrigProgramTreeNode);if(cloneProgramResponse){getOrigProgramSettingsResponse=APP.getProgramSettings(currOrigProgramTreeNode);if(getOrigProgramSettingsResponse&&getOrigProgramSettingsResponse.data&&(inheritPeriodCost||numOfPeriodCostMonths>0)){APP.clonePeriodCost(getOrigProgramSettingsResponse.data,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,numOfPeriodCostMonths,parseInt(periodCostOffset),inheritPeriodCost);}
getNewProgramSettingsResponse=APP.getProgramSettings({"compId":cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,"compType":cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compType});if(getNewProgramSettingsResponse&&getNewProgramSettingsResponse.data&&tagName&&tagValue){APP.setProgramTag(getNewProgramSettingsResponse.data,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,tagName,tagValue);}
if(cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compType=="Nurture Program"){APP.cloneNurtureCadence(currOrigProgramTreeNode.compId,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId);}
getNewProgramAssetDetailsResponse=APP.cloneSmartCampaignState(currOrigProgramTreeNode.compId,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,scForceActivate);APP.setProgramReportFilter(getNewProgramAssetDetailsResponse,cloneToFolderId);}}}}else{var currOrigProgramTreeNode=_this.currNode.attributes;cloneProgramResponse=APP.cloneProgram(cloneToAffix,cloneToFolderId,currOrigProgramTreeNode);if(cloneProgramResponse){getOrigProgramSettingsResponse=APP.getProgramSettings(currOrigProgramTreeNode);if(getOrigProgramSettingsResponse&&getOrigProgramSettingsResponse.data&&(inheritPeriodCost||numOfPeriodCostMonths>0)){APP.clonePeriodCost(getOrigProgramSettingsResponse.data,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,numOfPeriodCostMonths,parseInt(periodCostOffset),inheritPeriodCost);}
getNewProgramSettingsResponse=APP.getProgramSettings({"compId":cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,"compType":cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compType});if(getNewProgramSettingsResponse&&getNewProgramSettingsResponse.data&&tagName&&tagValue){APP.setProgramTag(getNewProgramSettingsResponse.data,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,tagName,tagValue);}
if(cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compType=="Nurture Program"){APP.cloneNurtureCadence(currOrigProgramTreeNode.compId,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId);}
getNewProgramAssetDetailsResponse=APP.cloneSmartCampaignState(currOrigProgramTreeNode.compId,cloneProgramResponse.JSONResults.actions[0].parameters[0][0].compId,scForceActivate);APP.setProgramReportFilter(getNewProgramAssetDetailsResponse,cloneToFolderId);}}
APP.reloadMarketingActivites();waitMsg.close();}},0);});massCloneForm.show();showMoreOptionsField.onSelect(showMoreOptionsField.findRecord("text","No"));scActivationField.onSelect(scActivationField.findRecord("text","Inherit State"));periodCostCloneField.onSelect(periodCostCloneField.findRecord("text","Inherit Data"));massCloneForm.setWidth(525);massCloneForm.setHeight(560);massCloneForm.items.last().setText("Programs that have a folder depth greater than 2 will not be cloned.");massCloneForm.items.last().setVisible(true);tagValueField.label.setVisible(false);tagNameField.label.setVisible(false);periodCostMonthField.label.dom.innerHTML="&nbsp;&nbsp;&nbsp; Months:";periodCostMonthField.label.setVisible(false);periodCostOffsetField.label.dom.innerHTML="&nbsp;&nbsp;&nbsp; Cost Offset (+/-):";periodCostOffsetField.label.setVisible(false);tagValueField.label.dom.innerHTML="&nbsp;&nbsp;&nbsp; New Tag Value:";periodCostCloneField.label.setVisible(false);scActivationField.label.setVisible(false);customTags=APP.getTags();currCustomTagName=tagNameField.store.data.items[0].copy(0);currCustomTagValue=tagValueField.store.data.items[0].copy(0);tagNameField.store.removeAll(true);tagValueField.store.removeAll(true);var isCustomTags=window.setInterval(function(){if(customTags){window.clearInterval(isCustomTags);for(var ii=0;ii<customTags.length;ii++){currCustomTag=customTags[ii];currCustomTagName=currCustomTagName.copy(currCustomTag.name);currCustomTagName.set("text",currCustomTag.name);currCustomTagName.data.id=currCustomTag.name;tagNameField.store.add(currCustomTagName);for(var jj=0;jj<currCustomTag.values.length;jj++){currCustomTagValue=currCustomTagValue.copy(currCustomTag.values[jj].value);currCustomTagValue.set("text",currCustomTag.values[jj].value);currCustomTagValue.data.id=currCustomTag.values[jj].value;tagValueField.store.add(currCustomTagValue);}}}},0);}},0);});}
if(this.get(massCloneItemId)){if((this.currNode.attributes.compType=="Marketing Folder"&&!this.currNode.attributes.marketingProgramId&&currExpNode&&currExpNode.isExpandable())||(this.currNode.attributes.compType=="Marketing Program"||this.currNode.attributes.compType=="Nurture Program"||this.currNode.attributes.compType=="Marketing Event"||this.currNode.attributes.compType=="Email Batch Program"||this.currNode.attributes.compType=="In-App Program")){if(forceReload){this.get(massCloneItemId).destroy();this.addItem(massCloneItem);}else{this.get(massCloneItemId).setVisible(true);}}else{this.get(massCloneItemId).setVisible(false);}}else if((this.currNode.attributes.compType=="Marketing Folder"&&!this.currNode.attributes.marketingProgramId&&currExpNode&&currExpNode.isExpandable())||(this.currNode.attributes.compType=="Marketing Program"||this.currNode.attributes.compType=="Nurture Program"||this.currNode.attributes.compType=="Marketing Event"||this.currNode.attributes.compType=="Email Batch Program"||this.currNode.attributes.compType=="In-App Program")){this.addItem(massCloneItem);}}};if(typeof(Ext)!=="undefined"&&Ext&&Ext.menu&&Ext.menu.Menu&&Ext.menu.Menu.prototype&&Ext.menu.Menu.prototype.showAt){console.log("Marketo Demo App > Executing: Applying Mass Clone Menu Item");if(!origMenuShowAtFunc){origMenuShowAtFunc=Ext.menu.Menu.prototype.showAt;}
Ext.menu.Menu.prototype.showAt=function(xy,parentMenu){massClone.apply(this,arguments);origMenuShowAtFunc.apply(this,arguments);};}else{console.log("Marketo Demo App > Skipping: Applying Mass Clone Menu Item");}};APP.getHumanDate=function(){console.log("Marketo App > Getting: Today's Date");var dayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames=["JAN","FEB","MAR","APR","MAY","JUNE","JULY","AUG","SEPT","OCT","NOV","DEC"],date=new Date(),dayOfWeek=dayNames[date.getDay()],month=monthNames[date.getMonth()],dayOfMonth,year=date.getFullYear();switch(date.getDate()){case 1:dayOfMonth="1st";break;case 2:dayOfMonth="2nd";break;case 3:dayOfMonth="3rd";break;default:dayOfMonth=date.getDate()+"th";break;}
return dayOfWeek+", "+month+" the "+dayOfMonth+" "+year;};APP.overlayLandingPage=function(action){console.log("Marketo App > Overlaying: Landing Page");var isLandingPageEditor,clearOverlayVars,overlay,isMktoFreeForm=isMktoBackgroundColorReplaced=isMktoImgReplaced=isMktoHeroBgImgReplaced=isMktoTextReplaced=isMktoSubTextReplaced=isMktoButtonReplaced=isMktoOrigReplaced=desktopPrevReady=phonePrevReady=sideBySideDesktopPrevReady=sideBySidePhonePrevReady=isDesktopReplaced=isPhoneReplaced=isSideBySideDesktopReplaced=isSideBySidePhoneReplaced=false,mktoBodyId="bodyId",mktoFreeFormClassName="mktoMobileShow",logoRegex=new RegExp("primaryImage|primary_image|primary-image|logo|image_1|image-1|image1","i"),heroBgImgIdRegex=new RegExp("hero","i"),mktoMainTextDivIdRegex=new RegExp("^primaryBodyHeader$|^heroHeader$|^mainTitle$|^main-title$|^hero title$|^heroTitle$|^hero-title$|^title$","i"),mktoSubTextDivIdRegex=new RegExp("^section2Header$|^heroHeader2$|^subtitle$|^sub-title$|^hero subtitle$|^heroSubtitle$|^hero-subtitle$","i"),mktoRichMainTextDivClassNameRegex=new RegExp("main title|main_title|mainTitle|main-title|title","i"),mktoRichSubTextDivClassNameRegex=new RegExp("subtitle|sub-title","i"),buttonTextRegex=new RegExp("signup|sign up|call to action|cta|register|more|contribute|submit","i"),saveEditsToggle=APP.getCookie("saveEditsToggleState"),logo=APP.getCookie("logo"),heroBackground=APP.getCookie("heroBackground"),color=APP.getCookie("color"),defaultColor="rgb(42, 83, 112)",logoOrigMaxHeight="55",mktoMainText="You To Our Event",mktoSubText=APP.getHumanDate(),company,companyName,linearGradient,desktopRepeatReadyCount=phoneRepeatReadyCount=sideBySideDesktopRepeatReadyCount=sideBySidePhoneRepeatReadyCount=0,maxRepeatReady=2000,maxOtherRepeatReady=2000;if(saveEditsToggle=="true"||(logo==null&&heroBackground==null&&color==null)){return false;}
if(logo!=null){company=logo.split("https://logo.clearbit.com/")[1].split(".")[0];companyName=company.charAt(0).toUpperCase()+company.slice(1);mktoMainText=companyName+" Invites "+mktoMainText;}else{mktoMainText="We Invite "+mktoMainText;}
if(color){var formButtonStyle=document.createElement("style");formButtonStyle.type="text/css";formButtonStyle.innerHTML=".mktoButton { background-image: none !important; border-radius: 0 !important; border: none !important; background-color: "+color+" !important; }";linearGradient="linear-gradient(to bottom, "+color+", rgb(242, 242, 242)) !important";}
clearOverlayVars=function(){isMktoBackgroundColorReplaced=isMktoImgReplaced=isMktoHeroBgImgReplaced=isMktoTextReplaced=isMktoSubTextReplaced=isMktoButtonReplaced=isMktoOrigReplaced=false;iframeBody=logoImg=textBackground=bannerBackground=mainTitle=subTitle=mktoImgs=mktoTexts=mktoRichTexts=mktoButtons=null;};overlay=function(iframeDocument){if(iframeDocument){var iframeBody=iframeDocument.getElementsByTagName("body")[0],logoImg=iframeDocument.getElementById("lp-logo"),textBackground=iframeDocument.getElementById("background-color"),bannerBackground=iframeDocument.getElementById("bigger-background"),mainTitle=iframeDocument.getElementById("title"),subTitle=iframeDocument.getElementById("sub-title");if(iframeBody&&iframeBody.innerHTML){var mktoHeader=iframeDocument.getElementsByName("header")[0],mktoLogo=iframeDocument.getElementsByName("logo")[0],mktoImgs=iframeBody.getElementsByClassName("lpimg"),mktoHeroBg=iframeDocument.getElementsByName("heroBackground")[0],mktoTitle=iframeDocument.getElementsByName("title")[0],mktoSubtitle=iframeDocument.getElementsByName("subtitle")[0],mktoTexts=iframeBody.getElementsByClassName("mktoText"),mktoRichTexts=iframeBody.getElementsByClassName("richTextSpan"),mktoButton=iframeDocument.getElementsByName("button")[0],mktoButtons=iframeBody.getElementsByTagName("button");if(!isMktoBackgroundColorReplaced&&color&&mktoHeader){console.log("Marketo App > Overlaying: Landing Page Header Background Company Color for Demo Svcs Template");mktoHeader.setAttribute("style",mktoHeader.getAttribute("style")+"; background: "+linearGradient+";");isMktoBackgroundColorReplaced=true;isMktoFreeForm=false;}else if(!isMktoBackgroundColorReplaced&&color&&!bannerBackground&&iframeBody.id==mktoBodyId&&iframeBody.className!=null&&iframeBody.getElementsByTagName("div")&&iframeBody.getElementsByTagName("div")[0]&&iframeBody.getElementsByTagName("div")[0].style){if(iframeBody.className.search(mktoFreeFormClassName)!=-1){console.log("Marketo App > Overlaying: Freeform Landing Page Background Company Color");iframeBody.getElementsByTagName("div")[0].style.backgroundColor=color+" !important";isMktoBackgroundColorReplaced=isMktoFreeForm=true;}else{console.log("Marketo App > Overlaying: Guided Landing Page Background Company Color");iframeBody.getElementsByTagName("div")[0].style.background=linearGradient;isMktoBackgroundColorReplaced=true;isMktoFreeForm=false;}
iframeDocument.getElementsByTagName("head")[0].appendChild(formButtonStyle);}
if(!isMktoImgReplaced&&logo&&(mktoLogo||mktoImgs.length!=0)){if(mktoLogo){console.log("Marketo App > Overlaying: Landing Page Company Logo for Demo Svcs Template");if(mktoLogo.style.height){mktoLogo.style.setProperty("max-height",mktoLogo.style.height);console.log("Marketo App > Overlaying: Landing Page Company Logo Max Height = "+mktoLogo.style.height);}else{mktoLogo.style.setProperty("max-height",mktoLogo.height+"px");console.log("Marketo App > Overlaying: Landing Page Company Logo Max Height = "+mktoLogo.height);}
mktoLogo.setAttribute("src",logo);isMktoImgReplaced=true;}else{for(var ii=0;ii<mktoImgs.length;ii++){var currMktoImg=mktoImgs[ii];if(currMktoImg&&currMktoImg.src&&currMktoImg.parentNode&&currMktoImg.parentNode.tagName=="DIV"&&currMktoImg.parentNode.id.search(logoRegex)!=-1){console.log("Marketo App > Overlaying: Guided Landing Page Company Logo");currMktoImg.setAttribute("src",logo);isMktoImgReplaced=true;break;}else if(currMktoImg&&currMktoImg.src&&currMktoImg.parentNode&&currMktoImg.parentNode.tagName=="SPAN"&&currMktoImg.parentNode.parentNode&&currMktoImg.parentNode.parentNode.className.search(logoRegex)!=-1){console.log("Marketo App > Overlaying: Freeform Landing Page Company Logo");if(currMktoImg.style.height){currMktoImg.style.setProperty("max-height",currMktoImg.style.height);console.log("Marketo App > Overlaying: Freeform Landing Page Company Logo Max Height = "+currMktoImg.style.height);}else{currMktoImg.style.setProperty("max-height",currMktoImg.height+"px");console.log("Marketo App > Overlaying: Freeform Landing Page Company Logo Max Height = "+currMktoImg.height);}
currMktoImg.setAttribute("src",logo);isMktoImgReplaced=true;break;}}}}
if(!isMktoHeroBgImgReplaced&&heroBackground&&(mktoHeroBg||mktoImgs.length!=0)){if(mktoHeroBg&&mktoHeroBg.getAttribute("src")){console.log("Marketo App > Overlaying: Guided Landing Page Hero Company Background for Demo Svcs Template");mktoHeroBg.setAttribute("src",heroBackground);isMktoHeroBgImgReplaced=true;}else{for(var ii=0;ii<mktoImgs.length;ii++){var currMktoImg=mktoImgs[ii];if(currMktoImg.getAttribute("src")&&currMktoImg.getAttribute("id")&&currMktoImg.getAttribute("id").search(heroBgImgIdRegex)!=-1){console.log("Marketo App > Overlaying: Guided Landing Page Hero Company Background");currMktoImg.setAttribute("src",heroBackground);isMktoHeroBgImgReplaced=true;break;}}}}
if((!isMktoSubTextReplaced||!isMktoTextReplaced)&&(mktoTitle||mktoSubtitle||mktoTexts.length!=0)||mktoRichTexts.length!=0){if(mktoTitle){console.log("Marketo App > Overlaying: Landing Page Company Name in Title for Demo Svcs Template");mktoTitle.innerHTML=mktoMainText;isMktoTextReplaced=true;}
if(mktoSubtitle){console.log("Marketo App > Overlaying: Landing Page Company Today's Date in Subtitle for Demo Svcs Template");mktoSubtitle.innerHTML=mktoSubText;isMktoSubTextReplaced=true;}
if(!mktoSubtitle&&!mktoTitle){if(mktoTexts.length!=0){for(var ii=0;ii<mktoTexts.length;ii++){var currMktoText=mktoTexts[ii];if(!isMktoTextReplaced&&currMktoText&&currMktoText.childNodes&&currMktoText.childNodes[0]&&currMktoText.childNodes[0].innerHTML&&currMktoText.id.search(mktoMainTextDivIdRegex)!=-1){console.log("Marketo App > Overlaying: Guided Landing Page Company Name in Title");currMktoText.childNodes[0].innerHTML=mktoMainText;isMktoTextReplaced=true;}
if(!isMktoSubTextReplaced&&currMktoText&&currMktoText.innerHTML&&currMktoText.childElementCount!=null&&currMktoText.id.search(mktoSubTextDivIdRegex)!=-1){if(!currMktoText.childElementCount){console.log("Marketo App > Overlaying: Guided Landing Page Company Today's Date in Subtitle");if(currMktoText.innerHTML){currMktoText.innerHTML=mktoSubText;}else{currMktoText.parentNode.innerHTML=mktoSubText;}
isMktoSubTextReplaced=true;}else if(currMktoText.childNodes&&currMktoText.childNodes[0]){if(!currMktoText.childNodes[0].childElementCount){console.log("Marketo App > Overlaying: Guided Landing Page Company Today's Date in Subtitle");if(currMktoText.childNodes[0].innerHTML){currMktoText.childNodes[0].innerHTML=mktoSubText;}else{currMktoText.innerHTML=mktoSubText;}
isMktoSubTextReplaced=true;}else if(currMktoText.childNodes[0].childNodes&&currMktoText.childNodes[0].childNodes[0]&&!currMktoText.childNodes[0].childNodes[0].childElementCount){console.log("Marketo App > Overlaying: Guided Landing Page Company Today's Date in Subtitle");if(currMktoText.childNodes[0].childNodes[0].innerHTML){currMktoText.childNodes[0].childNodes[0].innerHTML=mktoSubText;}else{currMktoText.childNodes[0].innerHTML=mktoSubText;}
isMktoSubTextReplaced=true;}}}
if(isMktoSubTextReplaced&&isMktoTextReplaced){break;}}}
if(mktoRichTexts.length!=0){for(var ii=0;ii<mktoRichTexts.length;ii++){var currMktoRichText=mktoRichTexts[ii];if(currMktoRichText&&currMktoRichText.innerHTML&&currMktoRichText.childElementCount!=null&&currMktoRichText.parentNode&&currMktoRichText.parentNode.tagName=="DIV"){if(!isMktoTextReplaced&&currMktoRichText.parentNode.className.search(mktoRichMainTextDivClassNameRegex)!=-1){if(!currMktoRichText.childElementCount){console.log("Marketo App > Overlaying: Freeform Landing Page Company Name in Title");if(currMktoRichText.innerHTML){currMktoRichText.innerHTML=mktoMainText;}else{currMktoRichText.parentNode.innerHTML=mktoMainText;}
isMktoTextReplaced=true;}else if(currMktoRichText.childNodes&&currMktoRichText.childNodes[0]){if(!currMktoRichText.childNodes[0].childElementCount){console.log("Marketo App > Overlaying: Freeform Landing Page Company Name in Title");if(currMktoRichText.childNodes[0].innerHTML){currMktoRichText.childNodes[0].innerHTML=mktoMainText;}else{currMktoRichText.innerHTML=mktoMainText;}
isMktoTextReplaced=true;}else if(currMktoRichText.childNodes[0].childNodes&&currMktoRichText.childNodes[0].childNodes[0]&&!currMktoRichText.childNodes[0].childNodes[0].childElementCount){console.log("Marketo App > Overlaying: Freeform Landing Page Company Name in Title");if(currMktoRichText.childNodes[0].childNodes[0].innerHTML){currMktoRichText.childNodes[0].childNodes[0].innerHTML=mktoMainText;}else{currMktoRichText.childNodes[0].innerHTML=mktoMainText;}
isMktoTextReplaced=true;}}}
if(!isMktoSubTextReplaced&&currMktoRichText.parentNode.className.search(mktoRichSubTextDivClassNameRegex)!=-1){if(!currMktoRichText.childElementCount){console.log("Marketo App > Overlaying: Freeform Landing Page Company Today's Date in Subtitle");if(currMktoRichText.innerHTML){currMktoRichText.innerHTML=mktoSubText;}else{currMktoRichText.parentNode.innerHTML=mktoSubText;}
isMktoSubTextReplaced=true;}else if(currMktoRichText.childNodes&&currMktoRichText.childNodes[0]){if(!currMktoRichText.childNodes[0].childElementCount){console.log("Marketo App > Overlaying: Freeform Landing Page Company Today's Date in Subtitle");if(currMktoRichText.childNodes[0].innerHTML){currMktoRichText.childNodes[0].innerHTML=mktoSubText;}else{currMktoRichText.innerHTML=mktoSubText;}
isMktoSubTextReplaced=true;}else if(currMktoRichText.childNodes[0].childNodes&&currMktoRichText.childNodes[0].childNodes[0]&&!currMktoRichText.childNodes[0].childNodes[0].childElementCount){console.log("Marketo App > Overlaying: Freeform Landing Page Company Today's Date in Subtitle");if(currMktoRichText.childNodes[0].childNodes[0].innerHTML){currMktoRichText.childNodes[0].childNodes[0].innerHTML=mktoSubText;}else{currMktoRichText.childNodes[0].innerHTML=mktoSubText;}
isMktoSubTextReplaced=true;}}}}
if(isMktoSubTextReplaced&&isMktoTextReplaced){break;}}}}}
if(!isMktoButtonReplaced&&color&&(mktoButton||mktoButtons.length!=0)){if(mktoButton){console.log("Marketo App > Overlaying: Landing Page Button Company Color for Demo Svcs Template");mktoButton.setAttribute("style",currMktoButton.getAttribute("style")+"; background-color: "+color+" !important;");if(mktoButton.style.getPropertyValue("border")&&mktoButton.style.getPropertyValue("border")!="none"){mktoButton.setAttribute("style",currMktoButton.getAttribute("style")+"; border: 1px solid "+color+" !important;");}
isMktoButtonReplaced=true;}else{for(var ii=0;ii<mktoButtons.length;ii++){var currMktoButton=mktoButtons[ii];if(currMktoButton&&currMktoButton.style&&currMktoButton.style.backgroundColor!=null&&currMktoButton.innerHTML&&currMktoButton.innerHTML.search(buttonTextRegex)!=-1){console.log("Marketo App > Overlaying: Landing Page Button Company Color");currMktoButton.setAttribute("style",currMktoButton.getAttribute("style")+"; background-color: "+color+" !important;");if(currMktoButton.style.getPropertyValue("border")&&currMktoButton.style.getPropertyValue("border")!="none"){currMktoButton.setAttribute("style",currMktoButton.getAttribute("style")+"; border: 1px solid "+color+" !important;");}
isMktoButtonReplaced=true;break;}}}}}
if(logoImg&&textBackground&&textBackground.style&&bannerBackground&&bannerBackground.style&&mainTitle&&subTitle){console.log("Marketo App > Overlaying: Original Landing Page Company Logo & Color");if(logo){logoImg.src=logo;logoImg.onload=function(){var logoHeightsRatio,logoWidth,logoNewWidth,logoNewHeight,logoStyle;if(logoImg.naturalHeight&&logoImg.naturalHeight>logoOrigMaxHeight){logoHeightsRatio=logoImg.naturalHeight/logoOrigMaxHeight;logoWidth=logoImg.naturalWidth/logoHeightsRatio;logoImg.width=logoImg.style.width=logoNewWidth=logoWidth;logoImg.height=logoImg.style.height=logoNewHeight=logoOrigMaxHeight;}else if(logoImg.naturalHeight){logoImg.width=logoImg.style.width=logoNewWidth=logoImg.naturalWidth;logoImg.height=logoImg.style.height=logoNewHeight=logoImg.naturalHeight;}else{logoImg.width=logoImg.height=logoImg.style.width=logoImg.style.height=logoNewWidth=logoNewHeight=logoOrigMaxHeight;}
if(iframeDocument.getElementsByTagName("head")&&iframeDocument.getElementsByTagName("head")[0]){logoStyle=document.createElement("style");logoStyle.innerHTML="#"+logoImg.id+" {width : "+logoNewWidth+"px !important; height : "+logoNewHeight+"px !important;}";iframeDocument.getElementsByTagName("head")[0].appendChild(logoStyle);}
console.log("Marketo App > Overlaying: Original Landing Page Company Logo Dimensions = "+logoNewWidth+" x "+logoNewHeight);};}
if(color){textBackground.style.backgroundColor=color;bannerBackground.style.backgroundColor=color;iframeDocument.getElementsByTagName("head")[0].appendChild(formButtonStyle);}
mainTitle.innerHTML=mktoMainText;subTitle.innerHTML=mktoSubText;isMktoOrigReplaced=isMktoFreeForm=true;}
if((isMktoButtonReplaced&&isMktoSubTextReplaced&&isMktoTextReplaced&&isMktoHeroBgImgReplaced&&isMktoImgReplaced&&isMktoBackgroundColorReplaced)||isMktoOrigReplaced){clearOverlayVars();return true;}}
return false;};isLandingPageEditor=window.setInterval(function(){if(action=="edit"){console.log("Marketo App > Overlaying: Landing Page Designer");if(document.getElementsByTagName("iframe")[0]&&document.getElementsByTagName("iframe")[0].contentWindow&&document.getElementsByTagName("iframe")[0].contentWindow.document&&document.getElementsByTagName("iframe")[0].contentWindow.document.readyState=="complete"){if(overlay(document.getElementsByTagName("iframe")[0].contentWindow.document)||desktopRepeatReadyCount>=maxRepeatReady){console.log("Marketo App > Overlayed: Landing Page Desktop Designer = "+desktopRepeatReadyCount);isDesktopReplaced=true;clearOverlayVars();}else if(desktopPrevReady){desktopRepeatReadyCount++;}else{desktopRepeatReadyCount=1;}
desktopPrevReady=true;}else{desktopPrevReady=false;}
if(isMktoFreeForm&&!isPhoneReplaced&&document.getElementsByTagName("iframe")[1]&&document.getElementsByTagName("iframe")[1].contentWindow&&document.getElementsByTagName("iframe")[1].contentWindow.document&&document.getElementsByTagName("iframe")[1].contentWindow.document.readyState=="complete"){if(overlay(document.getElementsByTagName("iframe")[1].contentWindow.document)||phoneRepeatReadyCount>=maxRepeatReady){console.log("Marketo App > Overlayed: Freeform Landing Page Phone Designer = "+phoneRepeatReadyCount);isPhoneReplaced=true;clearOverlayVars();}else if(phonePrevReady){phoneRepeatReadyCount++;}else{phoneRepeatReadyCount=1;}
phonePrevReady=true;}else{phonePrevReady=false;}
if((!isMktoFreeForm&&isDesktopReplaced&&!document.getElementsByTagName("iframe")[1].contentWindow.document.getElementsByTagName("body")[0].innerHTML)||(isMktoFreeForm&&isPhoneReplaced&&isDesktopReplaced)){console.log("Marketo App > Overlaying: Landing Page Interval is Cleared");window.clearInterval(isLandingPageEditor);clearOverlayVars();return true;}}else if(action=="preview"){console.log("Marketo App > Overlaying: Landing Page Previewer");if(!isDesktopReplaced&&document.getElementsByTagName("iframe")[2]&&document.getElementsByTagName("iframe")[2].contentWindow&&document.getElementsByTagName("iframe")[2].contentWindow.document&&document.getElementsByTagName("iframe")[2].contentWindow.document.readyState=="complete"){if(overlay(document.getElementsByTagName("iframe")[2].contentWindow.document)||desktopRepeatReadyCount>=maxRepeatReady){console.log("Marketo App > Overlayed: Landing Page Desktop Preview = "+desktopRepeatReadyCount);isDesktopReplaced=true;clearOverlayVars();}else if(desktopPrevReady){desktopRepeatReadyCount++;}else{desktopRepeatReadyCount=1;}
desktopPrevReady=true;}else{desktopPrevReady=false;}
if(!isPhoneReplaced&&document.getElementsByTagName("iframe")[3]&&document.getElementsByTagName("iframe")[3].contentWindow&&document.getElementsByTagName("iframe")[3].contentWindow.document&&document.getElementsByTagName("iframe")[3].contentWindow.document.readyState=="complete"){if(overlay(document.getElementsByTagName("iframe")[3].contentWindow.document)||phoneRepeatReadyCount>=maxOtherRepeatReady){console.log("Marketo App > Overlayed: Landing Page Phone Preview = "+phoneRepeatReadyCount);isPhoneReplaced=true;clearOverlayVars();}else if(phonePrevReady){phoneRepeatReadyCount++;}else{phoneRepeatReadyCount=1;}
phonePrevReady=true;}else{phonePrevReady=false;}
if(!isSideBySideDesktopReplaced&&document.getElementsByTagName("iframe")[0]&&document.getElementsByTagName("iframe")[0].contentWindow&&document.getElementsByTagName("iframe")[0].contentWindow.document&&document.getElementsByTagName("iframe")[0].contentWindow.document.readyState=="complete"){if(overlay(document.getElementsByTagName("iframe")[0].contentWindow.document)||sideBySideDesktopRepeatReadyCount>=maxOtherRepeatReady){console.log("Marketo App > Overlayed: Landing Page Side by Side Desktop Preview = "+sideBySideDesktopRepeatReadyCount);isSideBySideDesktopReplaced=true;clearOverlayVars();}else if(sideBySideDesktopPrevReady){sideBySideDesktopRepeatReadyCount++;}else{sideBySideDesktopRepeatReadyCount=1;}
sideBySideDesktopPrevReady=true;}else{sideBySideDesktopPrevReady=false;}
if(!isSideBySidePhoneReplaced&&document.getElementsByTagName("iframe")[1]&&document.getElementsByTagName("iframe")[1].contentWindow&&document.getElementsByTagName("iframe")[1].contentWindow.document&&document.getElementsByTagName("iframe")[1].contentWindow.document.readyState=="complete"){if(overlay(document.getElementsByTagName("iframe")[1].contentWindow.document)||sideBySidePhoneRepeatReadyCount>=maxOtherRepeatReady){console.log("Marketo App > Overlayed: Landing Page Side by Side Phone Preview = "+sideBySidePhoneRepeatReadyCount);isSideBySidePhoneReplaced=true;clearOverlayVars();}else if(sideBySidePhonePrevReady){sideBySidePhoneRepeatReadyCount++;}else{sideBySidePhoneRepeatReadyCount=1;}
sideBySidePhonePrevReady=true;}else{sideBySidePhonePrevReady=false;}
if(isSideBySidePhoneReplaced&&isSideBySideDesktopReplaced&&isPhoneReplaced&&isDesktopReplaced){console.log("Marketo App > Overlaying: Landing Page Interval is Cleared");window.clearInterval(isLandingPageEditor);clearOverlayVars();return true;}}},0);};APP.overlayEmail=function(action){console.log("Marketo App > Overlaying: Email");var isEmailEditor2,clearOverlayVars,overlay,isMktoHeaderBgColorReplaced=isMktoImgReplaced=isMktoHeroBgReplaced=isMktoTextReplaced=isMktoSubTextReplaced=isMktoButtonReplaced=isMktoEmail1Replaced=editorPrevReady=desktopPrevReady=phonePrevReady=isDesktopPreviewReplaced=isPhonePreviewReplaced=false,logoMktoNameRegex=new RegExp("logo","i"),mainTitleMktoNameRegex=new RegExp("^main title$|^mainTitle$|^main-title$|^hero title$|^heroTitle$|^hero-title$|^title$","i"),subTitleMktoNameRegex=new RegExp("^subtitle$|^sub-title$|^hero subtitle$|^heroSubtitle$|^hero-subtitle$","i"),buttonTextRegex=new RegExp("signup|sign up|call to action|cta|register|more|contribute","i"),saveEditsToggle=APP.getCookie("saveEditsToggleState"),logo=APP.getCookie("logo"),heroBackground=APP.getCookie("heroBackground"),color=APP.getCookie("color"),defaultColor="rgb(42, 83, 112)",logoMaxHeight="55",mktoMainText="You<br>PREMIER BUSINESS EVENT<br>OF THE YEAR",mktoSubText=APP.getHumanDate(),company,companyName,editorRepeatReadyCount=desktopRepeatReadyCount=phoneRepeatReadyCount=0,maxRepeatReady=2000,maxPreviewRepeatReady=3000;if(saveEditsToggle=="true"||(logo==null&&heroBackground==null&&color==null)){return false;}
if(logo!=null){company=logo.split("https://logo.clearbit.com/")[1].split(".")[0];companyName=company.charAt(0).toUpperCase()+company.slice(1);mktoMainText=companyName+" Invites "+mktoMainText;}else{mktoMainText="We Invite "+mktoMainText;}
clearOverlayVars=function(){isMktoHeaderBgColorReplaced=isMktoImgReplaced=isMktoHeroBgReplaced=isMktoTextReplaced=isMktoSubTextReplaced=isMktoButtonReplaced=isMktoEmail1Replaced=false;emailBody=mktoImgs=mktoTexts=mktoButtons=logoSwapCompany=logoSwapContainer=logoSwapCompanyContainer=logoBkg=buttonBkg=null;};overlay=function(emailDocument){if(emailDocument){var emailBody=emailDocument.getElementsByTagName("body")[0],logoSwapCompany=emailDocument.getElementById("logo-swap-company"),logoSwapContainer=emailDocument.getElementById("logo-swap-container"),logoSwapCompanyContainer=emailDocument.getElementById("logo-swap-company-container"),logoBkg=emailDocument.getElementById("logo-bkg"),buttonBkg=emailDocument.getElementById("button-bkg");if(emailBody&&emailBody.innerHTML){var mktoHeader=emailDocument.getElementsByName("header")[0],mktoLogo=emailDocument.getElementsByName("logo")[0],mktoImgs=emailBody.getElementsByClassName("mktoImg"),mktoHeroBg=emailDocument.getElementsByName("heroBackground")[0],mktoTds=emailBody.getElementsByTagName("td"),mktoTitle=emailDocument.getElementsByName("title")[0],mktoSubtitle=emailDocument.getElementsByName("subtitle")[0],mktoTexts=emailBody.getElementsByClassName("mktoText"),mktoButton=emailDocument.getElementsByName("button")[0],mktoButtons=emailBody.getElementsByClassName("secondary-font button");if(!isMktoHeaderBgColorReplaced&&color&&mktoHeader){console.log("Marketo App > Overlaying: Email 2.0 Header Background Company Color for Demo Svcs Template");mktoHeader.style.setProperty("background-color",color);mktoHeader.setAttribute("bgColor",color);isMktoHeaderBgColorReplaced=true;}
if(!isMktoImgReplaced&&logo&&(mktoLogo||mktoImgs.length!=0)){if(mktoLogo){console.log("Marketo App > Overlaying: Email 2.0 Company Logo for Demo Svcs Template");if(mktoLogo.style.height){mktoLogo.style.setProperty("max-height",mktoLogo.style.height);console.log("Marketo App > Overlaying: Email 2.0 Company Logo Max Height = "+mktoLogo.style.height);}else{mktoLogo.style.setProperty("max-height",mktoLogo.height+"px");console.log("Marketo App > Overlaying: Email 2.0 Company Logo Max Height = "+mktoLogo.height);}
mktoLogo.setAttribute("src",logo);isMktoImgReplaced=true;}else{for(var ii=0;ii<mktoImgs.length;ii++){var currMktoImg=mktoImgs[ii],currMktoImgMktoName;if(currMktoImg.getAttribute("mktoname")){currMktoImgMktoName=currMktoImg.getAttribute("mktoname");}else if(currMktoImg.getAttribute("id")){currMktoImgMktoName=currMktoImg.getAttribute("id");}
if(currMktoImgMktoName&&currMktoImgMktoName.search(logoMktoNameRegex)!=-1){var currMktoImgTag=currMktoImg.getElementsByTagName("img")[0];if(currMktoImgTag&&currMktoImgTag.getAttribute("src")){console.log("Marketo App > Overlaying: Email 2.0 Company Logo");if(currMktoImgTag.style.height){currMktoImgTag.style.setProperty("max-height",currMktoImgTag.style.height);console.log("Marketo App > Overlaying: Email 2.0 Company Logo Max Height = "+currMktoImgTag.style.height);}else{currMktoImgTag.style.setProperty("max-height",currMktoImgTag.height+"px");console.log("Marketo App > Overlaying: Email 2.0 Company Logo Max Height = "+currMktoImgTag.height);}
currMktoImgTag.setAttribute("src",logo);isMktoImgReplaced=true;break;}}}}}
if(!isMktoHeroBgReplaced&&heroBackground&&(mktoHeroBg||mktoTds.length!=0)){if(mktoHeroBg){console.log("Marketo App > Overlaying: Email 2.0 Hero Company Background for Demo Svcs Template");mktoHeroBg.style.setProperty("background-image","url('"+heroBackground+"')");mktoHeroBg.setAttribute("background",heroBackground);mktoHeroBg.style.setProperty("background-size","cover");isMktoHeroBgReplaced=true;}else{for(var ii=0;ii<mktoTds.length;ii++){var currMktoTd=mktoTds[ii];if(currMktoTd&&currMktoTd.getAttribute("background")){console.log("Marketo App > Overlaying: Email 2.0 Hero Company Background");currMktoTd.setAttribute("background",heroBackground);currMktoTd.style.setProperty("background-image","url('"+heroBackground+"')");currMktoTd.style.setProperty("background-size","cover");isMktoHeroBgReplaced=true;break;}}}}
if((!isMktoSubTextReplaced||!isMktoTextReplaced)&&(mktoTitle||mktoSubtitle||mktoTexts.length!=0)){if(mktoTitle){console.log("Marketo App > Overlaying: Email 2.0 Company Name in Title for Demo Svcs Template");mktoTitle.innerHTML=mktoMainText;isMktoTextReplaced=true;}
if(mktoSubtitle){console.log("Marketo App > Overlaying: Email 2.0 Company Today's Date in Subtitle for Demo Svcs Template");mktoSubtitle.innerHTML=mktoSubText;isMktoSubTextReplaced=true;}
if(!mktoSubtitle&&!mktoTitle){for(var ii=0;ii<mktoTexts.length;ii++){var currMktoText=mktoTexts[ii],currMktoTextMktoName;if(currMktoText.getAttribute("mktoname")){currMktoTextMktoName=currMktoText.getAttribute("mktoname");}else if(currMktoText.getAttribute("id")){currMktoTextMktoName=currMktoText.getAttribute("id");}
if(currMktoTextMktoName&&currMktoTextMktoName.search(mainTitleMktoNameRegex)!=-1){if(currMktoText.innerHTML){console.log("Marketo App > Overlaying: Email 2.0 Company Name in Title");currMktoText.innerHTML=mktoMainText;isMktoTextReplaced=true;}}else if(currMktoTextMktoName&&currMktoTextMktoName.search(subTitleMktoNameRegex)!=-1){if(currMktoText.innerHTML){console.log("Marketo App > Overlaying: Email 2.0 Company Today's Date in Subtitle");currMktoText.innerHTML=mktoSubText;isMktoSubTextReplaced=true;}}
if(isMktoSubTextReplaced&&isMktoTextReplaced){break;}}}}
if(!isMktoButtonReplaced&&color&&(mktoButton||mktoButtons.length!=0)){if(mktoButton){console.log("Marketo App > Overlaying: Email 2.0 Button Company Color for Demo Svcs Template");mktoButton.style.setProperty("background-color",color);if(mktoButton.style.getPropertyValue("border")&&mktoButton.style.getPropertyValue("border")!="none"){mktoButton.style.setProperty("border","1px solid "+color);}
isMktoButtonReplaced=true;}else{for(var ii=0;ii<mktoButtons.length;ii++){var currMktoButton=mktoButtons[ii];if(currMktoButton.innerHTML&&currMktoButton.innerHTML.search(buttonTextRegex)!=-1){if(currMktoButton.style&&currMktoButton.style.backgroundColor){console.log("Marketo App > Overlaying: Email 2.0 Button Company Color");currMktoButton.style.backgroundColor=color;if(currMktoButton.style.getPropertyValue("border")&&currMktoButton.style.getPropertyValue("border")!="none"){currMktoButton.style.setProperty("border","1px solid "+color);}
isMktoButtonReplaced=true;break;}}}}}}
if(logoSwapCompanyContainer&&logoSwapContainer&&logoSwapCompany&&logoBkg){console.log("Marketo App > Overlaying: Email 1.0 Company Logo & Color");if(color){logoBkg.style.backgroundColor=color;}
if(logo){logoSwapCompany.setAttribute("src",logo);logoSwapCompany.onload=function(){var logoHeightsRatio,logoWidth,logoNewWidth,logoNewHeight,logoStyle;if(logoSwapCompany.naturalHeight&&logoSwapCompany.naturalHeight>logoMaxHeight){logoHeightsRatio=logoSwapCompany.naturalHeight/logoMaxHeight;logoWidth=logoSwapCompany.naturalWidth/logoHeightsRatio;logoSwapCompany.width=logoNewWidth=logoWidth;logoSwapCompany.height=logoNewHeight=logoMaxHeight;}else if(logoSwapCompany.naturalHeight){logoSwapCompany.width=logoNewWidth=logoSwapCompany.naturalWidth;logoSwapCompany.height=logoNewHeight=logoSwapCompany.naturalHeight;}else{logoSwapCompany.width=logoSwapCompany.height=logoNewWidth=logoNewHeight=logoMaxHeight;}
if(emailDocument.getElementsByTagName("head")&&emailDocument.getElementsByTagName("head")[0]){logoStyle=document.createElement("style");logoStyle.innerHTML="#"+logoSwapCompany.id+" {width : "+logoNewWidth+"px !important; height : "+logoNewHeight+"px !important;}";emailDocument.getElementsByTagName("head")[0].appendChild(logoStyle);}
console.log("Marketo App > Overlaying: Email 1.0 Company Logo Dimensions = "+logoNewWidth+" x "+logoNewHeight);}
logoSwapContainer.style.display="none";logoSwapCompanyContainer.style.display="block";}
if(buttonBkg&&color){buttonBkg.style.setProperty("background-color",color);}
isMktoEmail1Replaced=true;}
if((isMktoButtonReplaced&&isMktoSubTextReplaced&&isMktoTextReplaced&&isMktoImgReplaced&&isMktoHeroBgReplaced&&(!mktoHeader||(mktoHeader&&isMktoHeaderBgColorReplaced)))||isMktoEmail1Replaced){clearOverlayVars();return true;}}
return false;};isEmailEditor2=window.setInterval(function(){if(action=="edit"){console.log("Marketo App > Overlaying: Email Designer");if(document.getElementsByTagName("iframe")[0]&&document.getElementsByTagName("iframe")[0].contentWindow&&document.getElementsByTagName("iframe")[0].contentWindow.document&&document.getElementsByTagName("iframe")[0].contentWindow.document.readyState=="complete"){if(overlay(document.getElementsByTagName("iframe")[0].contentWindow.document)||editorRepeatReadyCount>=maxRepeatReady){console.log("Marketo App > Overlayed: Email Designer = "+editorRepeatReadyCount);console.log("Marketo App > Overlaying: Email Interval is Cleared");window.clearInterval(isEmailEditor2);clearOverlayVars();return true;}else if(editorPrevReady){editorRepeatReadyCount++;}else{editorRepeatReadyCount=1;}
editorPrevReady=true;}else{editorPrevReady=false;}}else if(action=="preview"){console.log("Marketo App > Overlaying: Email Previewer");if(!isDesktopPreviewReplaced&&document.getElementsByTagName("iframe")[2]&&document.getElementsByTagName("iframe")[2].contentWindow&&document.getElementsByTagName("iframe")[2].contentWindow.document&&document.getElementsByTagName("iframe")[2].contentWindow.document.readyState=="complete"){if(overlay(document.getElementsByTagName("iframe")[2].contentWindow.document)||desktopRepeatReadyCount>=maxPreviewRepeatReady){console.log("Marketo App > Overlayed: Email Desktop Preview = "+desktopRepeatReadyCount);isDesktopPreviewReplaced=true;clearOverlayVars();}else if(desktopPrevReady){desktopRepeatReadyCount++;}else{desktopRepeatReadyCount=1;}
desktopPrevReady=true;}else{desktopPrevReady=false;}
if(!isPhonePreviewReplaced&&document.getElementsByTagName("iframe")[3]&&document.getElementsByTagName("iframe")[3].contentWindow&&document.getElementsByTagName("iframe")[3].contentWindow.document&&document.getElementsByTagName("iframe")[3].contentWindow.document.readyState=="complete"){if(overlay(document.getElementsByTagName("iframe")[3].contentWindow.document)||phoneRepeatReadyCount>=maxPreviewRepeatReady){console.log("Marketo App > Overlayed: Email Phone Preview = "+phoneRepeatReadyCount);isPhonePreviewReplaced=true;clearOverlayVars();}else if(phonePrevReady){phoneRepeatReadyCount++;}else{phoneRepeatReadyCount=1;}
phonePrevReady=true;}else{phonePrevReady=false;}
if(isPhonePreviewReplaced&&isDesktopPreviewReplaced){console.log("Marketo App > Overlaying: Email Interval is Cleared");window.clearInterval(isEmailEditor2);clearOverlayVars();return true;}}},0);};APP.saveLandingPageEdits=function(mode,asset){var saveEditsToggle=APP.getCookie("saveEditsToggleState"),logo=APP.getCookie("logo"),heroBackground=APP.getCookie("heroBackground"),color=APP.getCookie("color");if(saveEditsToggle=="true"&&(logo!=null||heroBackground!=null||color!=null)){var httpRegEx=new RegExp("^http|^$","i"),textRegex=new RegExp("^[^#]|^$","i"),colorRegex=new RegExp("^#[0-9a-f]{3,6}$|^rgb|^$","i"),logoRegex=new RegExp("logo|headerLogo|header-logo|^$","i"),heroBgRegex=new RegExp("heroBackground|hero-background|heroBkg|hero-bkg|heroBg|hero-bg|hero1Bg|hero-1-bg|hero1Bkg|hero-1-bkg|hero1Background|^$","i"),titleRegex=new RegExp("^(mainTitle|main-title|heroTitle|hero-title|title|)$","i"),subtitleRegex=new RegExp("^(subtitle|sub-title|heroSubtitle|hero-subtitle|)$","i"),buttonBgColorRegex=new RegExp("^(heroButtonBgColor|hero-button-bg-color|heroButtonBackgroundColor|hero-button-background-color|heroBkgColor|hero-bkg-color|)$","i"),buttonBorderColorRegex=new RegExp("^(heroButtonBorderColor|hero-button-border-color|heroBorderColor|hero-border-color|)$","i"),headerBgColor="headerBgColor",headerLogoImg="headerLogoImg",heroBgImg="heroBgImg",heroTitle="heroTitle",heroSubtitle="heroSubtitle",formButtonBgColor="formButtonBgColor",footerLogoImg="footerLogoImg",title="You To Our Event",subtitle=APP.getHumanDate(),company,companyName,editAssetVars,waitForLoadMsg;waitForLoadMsg=new Ext.Window({closable:true,modal:true,width:500,height:250,cls:'mktModalForm',title:"Please Wait for Page to Load",html:"<u>Saving Edits</u> <br>Wait until this page completely loads before closing. <br><br><u>To Disable This Feature:</u> <br>Clear the selected company via the MarketoLive extension.",});if(logo!=null){company=logo.split("https://logo.clearbit.com/")[1].split(".")[0];companyName=company.charAt(0).toUpperCase()+company.slice(1);title=companyName+" Invites "+title;}else{title="We Invite "+title;}
editAssetVars=function(asset){var assetVars=asset.getResponsiveVarValues(),isLandingPageEditorFragmentStore,count=0,isTitleUpdated=isSubtitleUpdated=false;waitForLoadMsg.show();isLandingPageEditorComponentStore=window.setInterval(function(){if(asset.componentsStore&&asset.componentsStore.getAt&&asset.componentsStore.findExact&&Mkt3.controller&&Mkt3.controller.editor&&Mkt3.controller.editor.predefinedLayoutLandingPage&&Mkt3.controller.editor.predefinedLayoutLandingPage.LPEditorPredefinedLayout&&Mkt3.controller.editor.predefinedLayoutLandingPage.LPEditorPredefinedLayout.prototype&&Mkt3.controller.editor.predefinedLayoutLandingPage.LPEditorPredefinedLayout.prototype.updateRichTextComponent){if(!isTitleUpdated&&asset.componentsStore.findExact("name","title")&&asset.componentsStore.getAt(asset.componentsStore.findExact("name","title"))&&asset.componentsStore.getAt(asset.componentsStore.findExact("name","title")).fragmentsStore&&asset.componentsStore.getAt(asset.componentsStore.findExact("name","title")).fragmentsStore.data&&asset.componentsStore.getAt(asset.componentsStore.findExact("name","title")).fragmentsStore.data.items&&asset.componentsStore.getAt(asset.componentsStore.findExact("name","title")).fragmentsStore.data.items[0]){var newTitle=asset.componentsStore.getAt(asset.componentsStore.findExact("name","title")).fragmentsStore.data.items[0];newTitle.data.content=newTitle.data.body="<div>"+title+"</div>";Mkt3.controller.editor.predefinedLayoutLandingPage.LPEditorPredefinedLayout.prototype.updateRichTextComponent.call(Mkt3.app.controllers.get("Mkt3.controller.editor.predefinedLayoutLandingPage.LPEditorPredefinedLayout"),newTitle);isTitleUpdated=true;}
if(!isSubtitleUpdated&&asset.componentsStore.findExact("name","subtitle")&&asset.componentsStore.getAt(asset.componentsStore.findExact("name","subtitle"))&&asset.componentsStore.getAt(asset.componentsStore.findExact("name","subtitle")).fragmentsStore&&asset.componentsStore.getAt(asset.componentsStore.findExact("name","subtitle")).fragmentsStore.data&&asset.componentsStore.getAt(asset.componentsStore.findExact("name","subtitle")).fragmentsStore.data.items&&asset.componentsStore.getAt(asset.componentsStore.findExact("name","subtitle")).fragmentsStore.data.items[0]){var newSubtitle=asset.componentsStore.getAt(asset.componentsStore.findExact("name","subtitle")).fragmentsStore.data.items[0];newSubtitle.data.content=newSubtitle.data.body=subtitle;Mkt3.controller.editor.predefinedLayoutLandingPage.LPEditorPredefinedLayout.prototype.updateRichTextComponent.call(Mkt3.app.controllers.get("Mkt3.controller.editor.predefinedLayoutLandingPage.LPEditorPredefinedLayout"),newSubtitle);isSubtitleUpdated=true;}
if(count>1000||(isSubtitleUpdated&&isTitleUpdated)){console.log("Marketo Demo App > Updated: Landing Page Title & Subtitle: "+count);window.clearInterval(isLandingPageEditorComponentStore);}
count++;}},0);asset.setResponsiveVarValue(headerBgColor,color);asset.setResponsiveVarValue(headerLogoImg,logo);asset.setResponsiveVarValue(heroBgImg,heroBackground);asset.setResponsiveVarValue(formButtonBgColor,color);asset.setResponsiveVarValue(footerLogoImg,logo);for(var ii=0;ii<Object.keys(assetVars).length;ii++){var currVariableKey=Object.keys(assetVars)[ii],currVariableValue=Object.values(assetVars)[ii].toString();if(currVariableValue==null){currVariableValue="";}
if(currVariableKey.search(logoRegex)!=-1){if(currVariableValue.search(httpRegEx)!=-1){waitForLoadMsg.show();asset.setResponsiveVarValue(currVariableKey,logo);}}else if(currVariableKey.search(heroBgRegex)!=-1){if(currVariableValue.search(httpRegEx)!=-1){waitForLoadMsg.show();asset.setResponsiveVarValue(currVariableKey,heroBackground);}}else if(currVariableKey.search(titleRegex)!=-1){if(currVariableValue.search(textRegex)!=-1){waitForLoadMsg.show();asset.setResponsiveVarValue(currVariableKey,title);}}else if(currVariableKey.search(subtitleRegex)!=-1){if(currVariableValue.search(textRegex)!=-1){waitForLoadMsg.show();asset.setResponsiveVarValue(currVariableKey,subtitle);}}else if(currVariableKey.search(buttonBgColorRegex)!=-1){if(currVariableValue.search(colorRegex)!=-1){waitForLoadMsg.show();asset.setResponsiveVarValue(currVariableKey,color);}}else if(currVariableKey.search(buttonBorderColorRegex)!=-1){if(currVariableValue.search(colorRegex)!=-1){waitForLoadMsg.show();asset.setResponsiveVarValue(currVariableKey,color);}}}
if(waitForLoadMsg.isVisible()){window.setTimeout(function(){waitForLoadMsg.hide();},7500);}};console.log("Marketo Demo App > Editing: Landing Page Variables");if(mode=="edit"){if(asset){editAssetVars(asset);}else{var isLandingPageEditorVariables=window.setInterval(function(){if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.app&&Mkt3.app.controllers&&Mkt3.app.controllers.get("Mkt3.controller.editor.LandingPage")&&Mkt3.app.controllers.get("Mkt3.controller.editor.LandingPage").getLandingPage()&&Mkt3.app.controllers.get("Mkt3.controller.editor.LandingPage").getLandingPage().getResponsiveVarValues()&&Mkt3.app.controllers.get("Mkt3.controller.editor.LandingPage").getLandingPage().setResponsiveVarValue&&Mkt3.app.controllers.get("Mkt3.controller.editor.LandingPage").getLandingPage()){console.log("Marketo Demo App > Editing: Landing Page Editor Variables");window.clearInterval(isLandingPageEditorVariables);editAssetVars(Mkt3.app.controllers.get("Mkt3.controller.editor.LandingPage").getLandingPage());}},0);}}else if(mode=="preview"){console.log("Marketo Demo App > Editing: Landing Page Previewer Variables");}}};APP.saveEmailEdits=function(mode,asset){var saveEditsToggle=APP.getCookie("saveEditsToggleState"),logo=APP.getCookie("logo"),heroBackground=APP.getCookie("heroBackground"),color=APP.getCookie("color");if(saveEditsToggle=="true"&&(logo!=null||heroBackground!=null||color!=null)){var httpRegEx=new RegExp("^http|^$","i"),textRegex=new RegExp("^[^#]|^$","i"),colorRegex=new RegExp("^#[0-9a-f]{3,6}$|^rgb|^$","i"),logoIds=["heroLogo","footerLogo","headerLogo","logoFooter","logo"],heroBgRegex=new RegExp("heroBackground|hero-background|heroBkg|hero-bkg|heroBg|hero-bg","i"),titleIds=["title","heroTitle","mainTitle"],subtitleIds=["subtitle","herosubTitle"],headerBgColorRegex=new RegExp("^(headerBgColor|header-bg-color|headerBackgroundColor|header-background-color|headerBkgColor|header-bkg-color|)$","i"),buttonBgColorRegex=new RegExp("^(heroButtonBgColor|hero-button-bg-color|heroButtonBackgroundColor|hero-button-background-color|heroBkgColor|hero-bkg-color|)$","i"),buttonBorderColorRegex=new RegExp("^(heroButtonBorderColor|hero-button-border-color|heroBorderColor|hero-border-color|)$","i"),logo=APP.getCookie("logo"),heroBackground=APP.getCookie("heroBackground"),color=APP.getCookie("color"),title="You To<br>PREMIER BUSINESS EVENT<br>OF THE YEAR",subtitle=APP.getHumanDate(),titleMatch,company,companyName,editHtml,editAssetVars,waitForLoadMsg,waitForReloadMsg;waitForLoadMsg=new Ext.Window({closable:true,modal:true,width:500,height:250,cls:'mktModalForm',title:"Please Wait for Page to Load",html:"<u>Saving Edits to Hero Background & Button Background Color</u> <br>Wait until this page completely loads before closing. <br><br><u>To Disable This Feature:</u> <br>Clear the selected company via the MarketoLive extension.",});waitForReloadMsg=new Ext.Window({closable:true,modal:true,width:500,height:250,cls:'mktModalForm',title:"Please Wait for Page to Reload",html:"<u>Saving Edits to Logo, Title, & Subtitle</u> <br>Wait for this page to reload automatically. <br><br><u>To Disable This Feature:</u> <br>Clear the selected company via the MarketoLive extension.",});if(logo!=null){company=logo.split("https://logo.clearbit.com/")[1].split(".")[0];companyName=company.charAt(0).toUpperCase()+company.slice(1);title=companyName+" Invites "+title;titleMatch=companyName+" Invites";}else{title="We Invite "+title;titleMatch="We Invite";}
editHtml=function(){APP.webRequest('/emaileditor/downloadHtmlFile2?xsrfId='+MktSecurity.getXsrfId()+'&emailId='+Mkt3.DL.dl.compId,null,'GET',true,'document',function(response){var isLogoReplaced,isTitleReplaced,isSubtitleReplaced;if(logo){for(var ii=0;ii<logoIds.length;ii++){var currElement=response.getElementById(logoIds[ii]);if(currElement&&currElement.className.search("mktoImg")!=-1&&currElement.getElementsByTagName("img")[0]&&currElement.getElementsByTagName("img")[0].getAttribute("src")!=logo){console.log("Marketo Demo App > Replacing: Logo > "+logo);isLogoReplaced=true;currElement.getElementsByTagName("img")[0].setAttribute("src",logo);}}}
if(title){for(var ii=0;ii<titleIds.length;ii++){var currElement=response.getElementById(titleIds[ii]);if(currElement&&currElement.className.search("mktoText")!=-1&&currElement.innerHTML!=title&&currElement.innerHTML.search(titleMatch)==-1){console.log("Marketo Demo App > Replacing: Title > "+title);isTitleReplaced=true;currElement.innerHTML=title;break;}}}
if(subtitle){for(var ii=0;ii<subtitleIds.length;ii++){var currElement=response.getElementById(subtitleIds[ii]);if(currElement&&currElement.className.search("mktoText")==-1&&currElement.innerHTML!=subtitle&&currElement.innerHTML.search(subtitle)!=-1){console.log("Marketo Demo App > Replacing: Subtitle > "+subtitle);isSubtitleReplaced=true;currElement.innerHTML=subtitle;break;}}}
if(isLogoReplaced||isTitleReplaced||isSubtitleReplaced){var updateHtml;updateHtml=function(){APP.webRequest('/emaileditor/updateContent2','ajaxHandler=MktSession&mktReqUid='+new Date().getTime()+Ext.id(null,':')+'&emailId='+Mkt3.DL.dl.compId+'&content='+encodeURIComponent(new XMLSerializer().serializeToString(response))+'&xsrfId='+MktSecurity.getXsrfId(),'POST',true,"",function(result){console.log(result);window.stop();window.location.reload();});};if(waitForLoadMsg.isVisible()){waitForLoadMsg.hide();}
waitForReloadMsg.show();updateHtml();}});};editAssetVars=function(asset){var assetVars=asset.getVariableValues();for(var ii=0;ii<Object.keys(assetVars).length;ii++){var currVariableKey=Object.keys(assetVars)[ii]
currVariableValue=Object.values(assetVars)[ii];if(currVariableValue==null){currVariableValue="";}
if(currVariableKey.search(heroBgRegex)!=-1){if(currVariableValue!=heroBackground&&currVariableValue.search(httpRegEx)!=-1){waitForLoadMsg.show();asset.setVariableValue(currVariableKey,heroBackground);}}else if(currVariableKey.search(headerBgColorRegex)!=-1){if(currVariableValue!=color&&currVariableValue.search(colorRegex)!=-1){waitForLoadMsg.show();asset.setVariableValue(currVariableKey,color);}}else if(currVariableKey.search(buttonBgColorRegex)!=-1){if(currVariableValue!=color&&currVariableValue.search(colorRegex)!=-1){waitForLoadMsg.show();asset.setVariableValue(currVariableKey,color);}}else if(currVariableKey.search(buttonBorderColorRegex)!=-1){if(currVariableValue!=color&&currVariableValue.search(colorRegex)!=-1){waitForLoadMsg.show();asset.setVariableValue(currVariableKey,color);}}}
if(waitForLoadMsg.isVisible()){window.setTimeout(function(){Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailEditor").reloadEmail();waitForLoadMsg.hide();},7500);}};console.log("Marketo Demo App > Editing: Email Variables");if(mode=="edit"){var isWebRequestSession=window.setInterval(function(){console.log("Marketo Demo App > Waiting: Web Request Session Data");if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.DL&&Mkt3.DL.dl&&Mkt3.DL.dl.compId&&typeof(MktSecurity)!=="undefined"&&MktSecurity&&MktSecurity.getXsrfId()&&typeof(Ext)!=="undefined"&&Ext&&Ext.id(null,':')){console.log("Marketo Demo App > Editing: Email HTML");window.clearInterval(isWebRequestSession);editHtml();}},0);if(asset){editAssetVars(asset);}else{var isEmailEditorVariables=window.setInterval(function(){console.log("Marketo Demo App > Waiting: Email Editor Variables");if(!waitForReloadMsg.isVisible()&&typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.app&&Mkt3.app.controllers&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailEditor")&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailEditor").getEmail()&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailEditor").getEmail().getVariableValues()&&Object.keys(Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailEditor").getEmail().getVariableValues()).length!=0&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailEditor").getEmail().setVariableValue){console.log("Marketo Demo App > Editing: Email Editor Variables");window.clearInterval(isEmailEditorVariables);editAssetVars(Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailEditor").getEmail());}},0);}}else if(mode=="preview"){console.log("Marketo Demo App > Editing: Email Previewer Variables");}}};APP.disableAnalyticsSaving=function(assetType,mode){console.log("Marketo App > Disabling: Analytics Saving for "+assetType);var isAnalyticsAsset;isAnalyticsAsset=window.setInterval(function(){if(typeof(MktCanvas)!=="undefined"&&MktCanvas&&MktCanvas.getActiveTab()&&MktCanvas.getActiveTab().config&&MktCanvas.getActiveTab().config.accessZoneId){window.clearInterval(isAnalyticsAsset);var assetNode=MktCanvas.getActiveTab().config,heapEvent={name:"",assetName:"",assetType:assetNode.compType,assetId:assetNode.expNodeId,workspaceId:assetNode.accessZoneId,workspaceName:""},titleReplaceRegex=new RegExp("\\([^\\)]+\\)$");switch(mode){case"edit":APP.disableSaving();APP.disableMenus();APP.hideToolbarItems();APP.disableFormSaveButtons();heapEvent.assetArea="Editor";break;case"preview":APP.disableFormSaveButtons();heapEvent.assetArea="Previewer";break;default:APP.disableSaving();APP.disableMenus();APP.hideToolbarItems();APP.disableFormSaveButtons();heapEvent.assetArea="Full Screen";}
switch(assetType){case"report":heapEvent.assetName=assetNode.title;break;case"model":heapEvent.assetName=assetNode.satelliteTitle;if(heapEvent.assetName.search(titleReplaceRegex)!=-1){heapEvent.assetName=heapEvent.assetName.replace(titleReplaceRegex,"").trimRight();}
if(heapEvent.assetName.search(/"/)!=-1){heapEvent.assetName=heapEvent.assetName.replace(/"/g,"");}
break;}
if(heapEvent.assetType.charAt(0).search(/[a-z]/)!=-1){var firstChar=heapEvent.assetType.charAt(0);heapEvent.assetType=firstChar.toUpperCase()+heapEvent.assetType.slice(1);}
heapEvent.workspaceName=APP.getWorkspaceName(assetNode.accessZoneId);if(assetNode.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1){heapEvent.name=heapEvent.workspaceName;}else if(assetNode.accessZoneId==mktoUserWorkspaceId){heapEvent.name=heapEvent.workspaceName;heapEvent.userFolder=userName;}else{heapEvent.name="User's Workspace"}
APP.heapTrack("track",heapEvent);}},0);};APP.disableDesignerSaving=function(assetType,mode){console.log("Marketo App > Disabling: Designer (Edit/Preview) Saving & Toolbar Menus for "+assetType);var isAppController;isAppController=window.setInterval(function(){if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.app&&Mkt3.app.controllers&&Mkt3.app.controllers.get){window.clearInterval(isAppController);var disableDesignerAsset,assetNode,menuItems;disableDesignerAsset=function(assetNode,menuItems,disableFunc){console.log("Marketo App > Executing: Disabling Designer (Edit/Preview)");var heapEvent={name:"",assetName:"",assetType:assetNode.compType,assetId:assetNode.id,workspaceId:assetNode.accessZoneId,workspaceName:""};switch(mode){case"edit":heapEvent.assetArea="Editor";break;case"preview":heapEvent.assetArea="Previewer";break;default:heapEvent.assetArea="Designer";break;}
heapEvent.workspaceName=APP.getWorkspaceName(assetNode.accessZoneId);if(assetNode.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1){heapEvent.name=heapEvent.workspaceName;}else if(assetNode.accessZoneId==mktoUserWorkspaceId){heapEvent.name=heapEvent.workspaceName;heapEvent.userFolder=userName;}else{heapEvent.name="User's Workspace"}
if(assetNode.text.search(".")!=-1){heapEvent.assetName=assetNode.text.split(".")[1];}else{heapEvent.assetName=assetNode.text;}
APP.heapTrack("track",heapEvent);if(assetNode.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1||toggleState=="false"){if(disableFunc){disableFunc();}
if(typeof(Ext4)!=="undefined"&&Ext4&&Ext4.ComponentQuery&&Ext4.ComponentQuery.query){var mItems=Ext4.ComponentQuery.query(menuItems.toString());if(mItems){console.log("Marketo App > Disabling Designer Toolbar Menus");mItems.forEach(function(item){if(item){if(item.itemId=="createButton"){item.setVisible(false);}else{item.setDisabled(true);}}});}}}};switch(assetType){case"landingPage":switch(mode){case"edit":var isLandingPageEditor=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.editor.LandingPage"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.editor.LandingPage")&&Mkt3.app.controllers.get("Mkt3.controller.editor.LandingPage").getLandingPage()&&Mkt3.app.controllers.get("Mkt3.controller.editor.LandingPage").getLandingPage().getNodeJson()){console.log("Marketo App > Disabling: Landing Page Editor: Saving & Toolbar Menus");window.clearInterval(isLandingPageEditor);var asset=Mkt3.app.controllers.get("Mkt3.controller.editor.LandingPage").getLandingPage();assetNode=asset.getNodeJson();menuItems=["lpEditor menu [action=approveAndClose]","lpEditor menu [action=disableMobileVersion]","lpEditor menu [action=uploadImage]","lpEditor menu [action=grabImages]",];disableDesignerAsset(assetNode,menuItems,APP.disablePropertyPanelSaving);APP.overlayLandingPage("edit");APP.saveLandingPageEdits("edit",asset);}},0);break;case"preview":var isLandingPagePreviewer=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.previewer.LandingPage"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.previewer.LandingPage")&&Mkt3.app.controllers.get("Mkt3.controller.previewer.LandingPage").getLandingPage()&&Mkt3.app.controllers.get("Mkt3.controller.previewer.LandingPage").getLandingPage().getNodeJson()){console.log("Marketo App > Disabling: Landing Page Previewer: Saving & Toolbar Menus");window.clearInterval(isLandingPagePreviewer);assetNode=Mkt3.app.controllers.get("Mkt3.controller.previewer.LandingPage").getLandingPage().getNodeJson();menuItems=["landingPagePreviewer menu [action=approveAndClose]",];disableDesignerAsset(assetNode,menuItems);APP.overlayLandingPage("preview");}},0);break;case"templateEdit":var isLandingPageTemplateEditor=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.editor.landingPageTemplate.LandingPageTemplate"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.editor.landingPageTemplate.LandingPageTemplate")&&Mkt3.app.controllers.get("Mkt3.controller.editor.landingPageTemplate.LandingPageTemplate").getTemplate()&&Mkt3.app.controllers.get("Mkt3.controller.editor.landingPageTemplate.LandingPageTemplate").getTemplate().get&&Mkt3.app.controllers.get("Mkt3.controller.editor.landingPageTemplate.LandingPageTemplate").getTemplate().getNodeJson){console.log("Marketo App > Disabling: Landing Page Template Editor: Saving & Toolbar Menus");window.clearInterval(isLandingPageTemplateEditor);var asset=Mkt3.app.controllers.get("Mkt3.controller.editor.landingPageTemplate.LandingPageTemplate").getTemplate();if(asset.get("zoneId")){assetNode=asset.getNodeJson();}else{assetNode={text:asset.get("name"),compType:"Landing Page Template",id:"LT"+asset.getId(),accessZoneId:-1};}
menuItems=["toolbar [action=upgrade]","menu [action=showMunchkinToggler]","menu [action=approve]",];disableDesignerAsset(assetNode,menuItems,APP.disableSaving);}},0);break;case"templatePreview":var isLandingPageTemplatePreview=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.previewer.LandingPageTemplate"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.previewer.LandingPageTemplate")&&Mkt3.app.controllers.get("Mkt3.controller.previewer.LandingPageTemplate").getTemplate()&&Mkt3.app.controllers.get("Mkt3.controller.previewer.LandingPageTemplate").getTemplate().get&&Mkt3.app.controllers.get("Mkt3.controller.previewer.LandingPageTemplate").getTemplate().getNodeJson){console.log("Marketo App > Disabling: Landing Page Template Previewer: Saving & Toolbar Menus");window.clearInterval(isLandingPageTemplatePreview);var asset=Mkt3.app.controllers.get("Mkt3.controller.previewer.LandingPageTemplate").getTemplate();if(asset.get("zoneId")){assetNode=asset.getNodeJson();}else{assetNode={text:asset.get("name"),compType:"Landing Page Template",id:"LT"+asset.getId(),accessZoneId:-1};}
menuItems=[];disableDesignerAsset(assetNode,menuItems);}},0);break;}
break;case"email":switch(mode){case"edit":var isEmailEditor=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailEditor"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailEditor")&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailEditor").getEmail()&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailEditor").getEmail().getNodeJson()){console.log("Marketo App > Disabling: Email Editor: Saving & Toolbar Menus");window.clearInterval(isEmailEditor);var asset=Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailEditor").getEmail();assetNode=asset.getNodeJson();menuItems=["emailEditor2 menu [action=approveEmail]","emailEditor2 menu [action=sendTestEmail]","emailEditor2 menu [action=uploadImage]","emailEditor2 menu [action=grabImages]","emailEditor2 menu [action=saveAsTemplate]",];disableDesignerAsset(assetNode,menuItems);APP.overlayEmail("edit");APP.saveEmailEdits("edit",asset);}},0);break;case"preview":var isEmailPreviewer=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.editor.email2.Preview"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.Preview")&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.Preview").getEmail()&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.Preview").getEmail().getNodeJson()){console.log("Marketo App > Disabling: Email Previewer: Saving & Toolbar Menus");window.clearInterval(isEmailPreviewer);assetNode=Mkt3.app.controllers.get("Mkt3.controller.editor.email2.Preview").getEmail().getNodeJson();menuItems=["email2EditorPreviewToolbar [action=sendSampleEmail]","emailPreview menu [action=approveEmail]","emailPreview menu [action=sendSampleEmail]",];disableDesignerAsset(assetNode,menuItems);APP.overlayEmail("preview");}},0);break;case"templateEdit":var isEmailTemplateEditor=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailTemplate"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailTemplate")&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailTemplate").getTemplate()&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailTemplate").getTemplate().getNodeJson()){console.log("Marketo App > Disabling: Email Template Editor: Saving & Toolbar Menus");window.clearInterval(isEmailTemplateEditor);var asset=Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailTemplate").getTemplate();assetNode=asset.getNodeJson();menuItems=["menu [action=approveTemplate]","menu [action=sendSample]","menu [action=inlineCss]",];disableDesignerAsset(assetNode,menuItems,APP.disableSaving);}},0);break;case"templatePicker":var isEmailTemplatePicker=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailTemplatePicker"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailTemplatePicker")&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailTemplatePicker").getEmailTemplatePicker()&&Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailTemplatePicker").getEmailTemplatePicker().accessZoneId){console.log("Marketo App > Disabling: Email Template Picker: Saving & Toolbar Menus");window.clearInterval(isEmailTemplatePicker);var asset=Mkt3.app.controllers.get("Mkt3.controller.editor.email2.EmailTemplatePicker").getEmailTemplatePicker();assetNode={text:"Email Template Picker",compType:"Email Template Picker",id:"EM",accessZoneId:parseInt(asset.accessZoneId)};menuItems=["toolbar [itemId=createButton]",];disableDesignerAsset(assetNode,menuItems);}},0);break;}
break;case"form":switch(mode){case"edit":var isFormEditor=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.editor.Form"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.editor.Form")&&Mkt3.app.controllers.get("Mkt3.controller.editor.Form").getForm()&&Mkt3.app.controllers.get("Mkt3.controller.editor.Form").getForm().getNodeJson()){console.log("Marketo App > Disabling: Form Editor: Saving & Toolbar Menus");window.clearInterval(isFormEditor);assetNode=Mkt3.app.controllers.get("Mkt3.controller.editor.Form").getForm().getNodeJson();menuItems=["formEditor toolbar [action=approveAndClose]","formEditor toolbar [action=finish]",];disableDesignerAsset(assetNode,menuItems,APP.disableSaving);}},0);break;case"preview":var isFormPreviewer=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.previewer.Form"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.previewer.Form")&&Mkt3.app.controllers.get("Mkt3.controller.previewer.Form").getForm()&&Mkt3.app.controllers.get("Mkt3.controller.previewer.Form").getForm().getNodeJson()){console.log("Marketo App > Disabling: Form Previewer: Saving & Toolbar Menus");window.clearInterval(isFormPreviewer);assetNode=Mkt3.app.controllers.get("Mkt3.controller.previewer.Form").getForm().getNodeJson();menuItems=[];disableDesignerAsset(assetNode,menuItems);}},0);break;}
break;case"pushNotification":switch(mode){case"edit":var isPushNotificationEditor=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.editor.mobilePushNotification.MobilePushNotification"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.editor.mobilePushNotification.MobilePushNotification")&&Mkt3.app.controllers.get("Mkt3.controller.editor.mobilePushNotification.MobilePushNotification").getMobilePushNotification()&&Mkt3.app.controllers.get("Mkt3.controller.editor.mobilePushNotification.MobilePushNotification").getMobilePushNotification().getNodeJson()){console.log("Marketo App > Disabling: Push Notification Editor: Saving & Toolbar Menus");window.clearInterval(isPushNotificationEditor);assetNode=Mkt3.app.controllers.get("Mkt3.controller.editor.mobilePushNotification.MobilePushNotification").getMobilePushNotification().getNodeJson();menuItems=["mobilePushNotificationEditor toolbar [action=sendDraftSample]","mobilePushNotificationEditor toolbar [action=finish]","mobilePushNotificationEditor toolbar [action=approveAndClose]",];disableDesignerAsset(assetNode,menuItems,APP.disableSaving);}},0);break;case"preview":var isPushNotificationPreview=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.previewer.MobilePushNotification"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.previewer.MobilePushNotification")&&Mkt3.app.controllers.get("Mkt3.controller.previewer.MobilePushNotification").getMobilePushNotification()&&Mkt3.app.controllers.get("Mkt3.controller.previewer.MobilePushNotification").getMobilePushNotification().getNodeJson()){console.log("Marketo App > Disabling: Push Notification Previewer: Saving & Toolbar Menus");window.clearInterval(isPushNotificationPreview);assetNode=Mkt3.app.controllers.get("Mkt3.controller.previewer.MobilePushNotification").getMobilePushNotification().getNodeJson();menuItems=["mobilePushNotificationPreviewer toolbar [action=sendDraftSample]",];disableDesignerAsset(assetNode,menuItems);}},0);break;}
break;case"inAppMessage":switch(mode){case"edit":var isInAppMessageEditor=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.editor.inAppMessage.InAppMessage"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.editor.inAppMessage.InAppMessage")&&Mkt3.app.controllers.get("Mkt3.controller.editor.inAppMessage.InAppMessage").getInAppMessage()&&Mkt3.app.controllers.get("Mkt3.controller.editor.inAppMessage.InAppMessage").getInAppMessage().getNodeJson()){console.log("Marketo App > Disabling: In-App Message Editor: Saving & Toolbar Menus");window.clearInterval(isInAppMessageEditor);assetNode=Mkt3.app.controllers.get("Mkt3.controller.editor.inAppMessage.InAppMessage").getInAppMessage().getNodeJson();menuItems=["inAppMessageEditor toolbar [action=sendSample]","inAppMessageEditor menu [action=sendSample]","inAppMessageEditor menu [action=approveAndClose]",];disableDesignerAsset(assetNode,menuItems,APP.disableSaving);}},0);break;case"preview":var isInAppMessagePreviewer=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.previewer.InAppMessage"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.previewer.InAppMessage")&&Mkt3.app.controllers.get("Mkt3.controller.previewer.InAppMessage").getInAppMessage()&&Mkt3.app.controllers.get("Mkt3.controller.previewer.InAppMessage").getInAppMessage().getNodeJson()){console.log("Marketo App > Disabling: In-App Message Previewer: Saving & Toolbar Menus");window.clearInterval(isInAppMessagePreviewer);assetNode=Mkt3.app.controllers.get("Mkt3.controller.previewer.InAppMessage").getInAppMessage().getNodeJson();menuItems=["inAppMessagePreviewer toolbar [action=approveAndClose]",];disableDesignerAsset(assetNode,menuItems);}},0);break;default:break;}
break;case"smsMessage":switch(mode){case"edit":var isSmsMessageEditor=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.editor.SmsMessage"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.editor.SmsMessage")&&Mkt3.app.controllers.get("Mkt3.controller.editor.SmsMessage").getSmsMessage()&&Mkt3.app.controllers.get("Mkt3.controller.editor.SmsMessage").getSmsMessage().getNodeJson()){console.log("Marketo App > Disabling: SMS Message Editor: Saving & Toolbar Menus");window.clearInterval(isSmsMessageEditor);assetNode=Mkt3.app.controllers.get("Mkt3.controller.editor.SmsMessage").getSmsMessage().getNodeJson();menuItems=["smsMessageEditor menu [action=approveAndClose]",];disableDesignerAsset(assetNode,menuItems,APP.disableSaving);}},0);break;case"preview":break;}
break;case"socialApp":switch(mode){case"edit":var isSocialAppEditor=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.editor.SocialApp"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.editor.SocialApp")&&Mkt3.app.controllers.get("Mkt3.controller.editor.SocialApp").getSocialApp()&&Mkt3.app.controllers.get("Mkt3.controller.editor.SocialApp").getSocialApp().getNodeJson()){console.log("Marketo App > Disabling: Social App Editor: Saving & Toolbar Menus");window.clearInterval(isSocialAppEditor);assetNode=Mkt3.app.controllers.get("Mkt3.controller.editor.SocialApp").getSocialApp().getNodeJson();menuItems=["socialAppEditor toolbar [action=approveAndClose]","socialAppEditor toolbar [action=finish]",];disableDesignerAsset(assetNode,menuItems,APP.disableSaving);}},0);break;case"preview":var isSocialAppPreviewer=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.previewer.SocialApp"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.previewer.SocialApp")&&Mkt3.app.controllers.get("Mkt3.controller.previewer.SocialApp").getSocialApp()&&Mkt3.app.controllers.get("Mkt3.controller.previewer.SocialApp").getSocialApp().getNodeJson()){console.log("Marketo App > Disabling: Social App Previewer: Saving & Toolbar Menus");window.clearInterval(isSocialAppPreviewer);assetNode=Mkt3.app.controllers.get("Mkt3.controller.previewer.SocialApp").getSocialApp().getNodeJson();menuItems=[];disableDesignerAsset(assetNode,menuItems);}},0);break;}
break;case"abTest":switch(mode){case"edit":console.log("Marketo App > Executing: A/B Test Editor: Saving & Toolbar Menus");var isAbTestEditor=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.editor.testGroup.TestGroup"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.editor.testGroup.TestGroup")&&Mkt3.app.controllers.get("Mkt3.controller.editor.testGroup.TestGroup").getTestGroup()&&Mkt3.app.controllers.get("Mkt3.controller.editor.testGroup.TestGroup").getTestGroup().getNodeJson()){console.log("Marketo App > Disabling: A/B Test Editor: Saving & Toolbar Menus");window.clearInterval(isAbTestEditor);assetNode=Mkt3.app.controllers.get("Mkt3.controller.editor.testGroup.TestGroup").getTestGroup().getNodeJson();menuItems=["testGroupEditor toolbar [action=finish]",];disableDesignerAsset(assetNode,menuItems,APP.disableSaving);}},0);break;case"preview":break;}
break;case"snippet":switch(mode){case"edit":console.log("Marketo App > Executing: Snippet Editor: Saving & Toolbar Menus");var isSnippetEditor=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.editor.Snippet"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.editor.Snippet")&&Mkt3.app.controllers.get("Mkt3.controller.editor.Snippet").getSnippet()&&Mkt3.app.controllers.get("Mkt3.controller.editor.Snippet").getSnippet().getNodeJson()){console.log("Marketo App > Disabling: Snippet Editor: Saving & Toolbar Menus");window.clearInterval(isSnippetEditor);assetNode=Mkt3.app.controllers.get("Mkt3.controller.editor.Snippet").getSnippet().getNodeJson();menuItems=[];disableDesignerAsset(assetNode,menuItems,APP.disableSaving);}},0);break;case"preview":console.log("Marketo App > Executing: Snippet Previewer: Saving & Toolbar Menus");var isSnippetEditor=window.setInterval(function(){if(typeof(Mkt3.app.controllers.get("Mkt3.controller.previewer.Snippet"))!=="undefined"&&Mkt3.app.controllers.get("Mkt3.controller.previewer.Snippet")&&Mkt3.app.controllers.get("Mkt3.controller.previewer.Snippet").getSnippet()&&Mkt3.app.controllers.get("Mkt3.controller.previewer.Snippet").getSnippet().getNodeJson()){console.log("Marketo App > Disabling: Snippet Previewer: Saving & Toolbar Menus");window.clearInterval(isSnippetEditor);assetNode=Mkt3.app.controllers.get("Mkt3.controller.previewer.Snippet").getSnippet().getNodeJson();menuItems=[];disableDesignerAsset(assetNode,menuItems);}},0);break;}
break;}}},0);};APP.disableFormSaveButtons=function(){console.log("Marketo App > Disabling: Form Window Save Buttons");if(typeof(Ext4)!=="undefined"&&Ext4&&Ext4.Component&&Ext4.Component.prototype&&Ext4.Component.prototype.show){Ext4.Component.prototype.show=function(animateTarget,cb,scope){console.log("Marketo App > Executing: Disable Form Window Save Buttons");if(this.getXType()=="createNamedAccountForm"||this.getXType()=="addToAccountListForm"||this.getXType()=="assignTeamMemberForm"||this.getXType()=="createAccountListForm"||this.getXType()=="analyticsReportSubscriptionForm"||this.getXType()=="fileUploadForm"||this.getXType()=="adminUserInviteWizard"||this.getXType()=="adminEditLicensesForm"||this.getXType()=="adminSubscriptionInformationForm"||this.getXType()=="adminAccountSettingsForm"||this.getXType()=="deleteZoneForm"||this.getXType()=="adminTinyMceSettingForm"||this.getXType()=="emailEditorSettingsForm"||this.getXType()=="emailAddMultipleDomainForm"||this.getXType()=="adminAddDomainForm"||this.getXType()=="adminScoreSettingsForm"||this.getXType()=="adminCrmFieldSettingsForm"||this.getXType()=="adminAccountTeamForm"||this.getXType()=="adminAbmReportSettingsForm"||this.getXType()=="adminFieldHtmlEncodeForm"||this.getXType()=="mktocustomactivityActivityTypeForm"||this.getXType()=="mktocustomactivityActivityTypeEditForm"||this.getXType()=="mktocustomactivityActivityTypeFormStepThree"||this.getXType()=="mktocustomobjectObjectForm"||this.getXType()=="mktocustomobjectFieldForm"||this.getXType()=="adminSpecifyPluginContactForm"||this.getXType()=="wildcardRedirectForm"||this.getXType()=="mktowsEditIpRestrictionForm"||this.getXType()=="launchpointServiceIntegrationSettingsForm"||this.getXType()=="vespaAppForm"||this.getXType()=="vespaSendForm"||this.getXType()=="vespaConfigurePushAccessForm"||this.getXType()=="vespaNewDeviceForm"||this.getXType()=="adminTagsAddCalendarEntryTypeForm"||this.getXType()=="featureSwitchForm"){var me=this,menuItems=["[action=submit]","[action=import]",],mItems=this.query(menuItems.toString());if(mItems){mItems.forEach(function(item){if(item){item.setDisabled(true);if(me.getXType()=="emailAddMultipleDomainForm"){item.stayDisabled=true;}}});}}
var me=this,rendered=me.rendered;if(rendered&&me.isVisible()){if(me.toFrontOnShow&&me.floating){me.toFront();}}else{if(me.fireEvent("beforeshow",me)!==false){me.hidden=false;if(!rendered&&(me.autoRender||me.floating)){me.doAutoRender();rendered=me.rendered;}
if(rendered){me.beforeShow();me.onShow.apply(me,arguments);me.afterShow.apply(me,arguments);}}else{me.onShowVeto();}}
if(me.stayDisabled){me.setVisible(false);}
return me;};}};APP.disableAdminSaveButtons=function(){console.log("Marketo App > Disabling: Admin Section Save Buttons");if(typeof(Ext)!=="undefined"&&Ext&&Ext.Window&&Ext.Window.prototype&&Ext.Window.prototype.show){Ext.Window.prototype.show=function(animateTarget,cb,scope){if(typeof(MktCanvas)!=="undefined"&&MktCanvas&&MktCanvas.getActiveTab()&&MktCanvas.getActiveTab().title&&typeof(this)!=="undefined"&&this&&this.buttons&&this.buttons.length){var activeTabTitle=MktCanvas.getActiveTab().title,toDisable,ii,currButton;switch(activeTabTitle){case"Login Settings":toDisable=true;break;case"Users":toDisable=true;break;case"Roles":toDisable=true;break;case"Workspaces":toDisable=true;break;case"Lead Partitions":toDisable=true;break;case"Person Partitions":toDisable=true;break;case"Location":toDisable=true;break;case"Smart Campaign":toDisable=true;break;case"Communication Limits":toDisable=true;break;case"Tags":toDisable=true;break;case"Field Management":toDisable=true;break;case"Salesforce Objects Sync":toDisable=true;break;case"Salesforce":toDisable=true;break;case"Sales Insight":toDisable=true;break;case"Email Add-in":toDisable=true;break;case"Landing Pages":toDisable=true;break;case"Rules":toDisable=true;break;case"Munchkin":toDisable=true;break;case"Installed Services":toDisable=true;break;case"Webhooks":toDisable=true;break;case"Single Sign-On":toDisable=true;break;case"Revenue Cycle Analytics":toDisable=true;break;case"Treasure Chest":toDisable=true;break;default:break;}
if(toDisable){for(ii=this.buttons.length-1;ii>=0;ii--){currButton=this.buttons[ii];if(currButton.cls=="mktButtonPositive"||currButton.iconCls=="mkiOk"){currButton.setDisabled(true);break;}}}}
if(!this.rendered){this.render(Ext.getBody());}
if(this.hidden===false){this.toFront();return this;}
if(this.fireEvent('beforeshow',this)===false){return this;}
if(cb){this.on('show',cb,scope,{single:true});}
this.hidden=false;if(Ext.isDefined(animateTarget)){this.setAnimateTarget(animateTarget);}
this.beforeShow();if(this.animateTarget){this.animShow();}else{this.afterShow();}
return this;};}};APP.limitNurturePrograms=function(){console.log("Marketo App > Limiting: Nurture Programs");if(typeof(Mkt)!=="undefined"&&Mkt&&Mkt.apps&&Mkt.apps.marketingEvent&&Mkt.apps.marketingEvent.MarketingEventForm&&Mkt.apps.marketingEvent.MarketingEventForm.prototype&&Mkt.apps.marketingEvent.MarketingEventForm.prototype.beforeSubmitCallback){var previousMarketingEventForm=Mkt.apps.marketingEvent.MarketingEventForm.prototype.beforeSubmitCallback;Mkt.apps.marketingEvent.MarketingEventForm.prototype.beforeSubmitCallback=function(){console.log("Marketo App > Executing: Limit Nurture Programs");var limit_exceeded=false,rootNode=MktExplorer.boundTree.root,compType="Nurture Program",matches=[],node=rootNode.cascade(function(){var attr=this.attributes;if(attr&&attr.xtra){if(attr.xtra.compType==compType&&attr.xtra.accessZoneId==MktCanvas.getActiveTab().config.accessZoneId){matches.push(this);}}},undefined,[compType]);if(matches.length>=3){limit_exceeded=true;}
if(limit_exceeded==true){var nutureProgramMessageBox=Ext.MessageBox.show({title:"MarketoLive",msg:"Users are limited to 3 nurture programs each.",width:400,closable:true});nutureProgramMessageBox.show;return false;}else{return previousMarketingEventForm.apply(this,arguments);}};}};APP.injectAnalyzerNavBar=function(){var isPodsLoaded=window.setInterval(function(){if(typeof(PODS)!=="undefined"){console.log("Marketo App > Injecting: Analyzer Navigation Bar");window.clearInterval(isPodsLoaded);var pod=new PODS.Pod(PODS.getCookie("userPod"));for(var y=0;y<pod.valueSet.length;y++){if(currentUrl==pod.valueSet[y].url){console.log("Marketo App > Updating: CSS for Analyzer Navigation Bar");$j=jQuery.noConflict();var currPosition='#'+pod.valueSet[y].position;$j(currPosition).parent().css('display','block');$j(currPosition).parent().siblings().css('display','none');$j(currPosition).removeClass('analyzer-button').addClass('analyzer-title');$j(currPosition).siblings().removeClass('analyzer-title').addClass('analyzer-button');$j("#modeler,#success-path-analyzer,#opportunity-influence-analyzer,#program-analyzer").bind("click",function(e){console.log("Marketo App > Identifying: Current Analyzer");for(var x=0;x<pod.valueSet.length;x++){if(e.target.id==pod.valueSet[x].position){currPosition=x;}}
window.location=pod.valueSet[currPosition].url;});}}}},0);};APP.overrideSaving=function(){console.log("Marketo App > Overriding: Saving for Nurture Streams");if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.data&&Mkt3.data.Store&&Mkt3.data.Store.prototype&&Mkt3.data.Store.prototype.sync){var prevDataStoreSync=Mkt3.data.Store.prototype.sync;Mkt3.data.Store.prototype.sync=function(){if(window.location.href.search("\/#"+mktoCalendarFragment)!=-1){Mkt3.data.Store.prototype.sync=prevDataStoreSync;}else{var disable;if(typeof(MktCanvas)!=="undefined"&&MktCanvas&&MktCanvas.getActiveTab()&&toggleState!="false"){disable=APP.evaluateMenu("button",null,MktCanvas.getActiveTab(),null);}else if(toggleState=="false"){disable=true;}
if(!disable){if(this.autoSyncSuspended){this.autoSync=true;this.autoSyncSuspended=false;}
if(this.getProxy()instanceof Mkt3.data.proxy.AjaxPost){Mkt3.Synchronizer.sync(this);}else{this.callParent(arguments);}}else{}}};}
if(typeof(Ext4)!=="undefined"&&Ext4&&Ext4.data&&Ext4.data.Model&&Ext4.data.Model.prototype&&Ext4.data.Model.prototype.destroy){Ext4.data.Model.prototype.destroy=function(options){var disable;if(typeof(MktCanvas)!=="undefined"&&MktCanvas&&MktCanvas.getActiveTab()&&toggleState!="false"){disable=APP.evaluateMenu("button",null,MktCanvas.getActiveTab(),null);}else if(toggleState=="false"){disable=true;}
if(!disable){options=Ext.apply({records:[this],action:'destroy'},options);var me=this,isNotPhantom=me.phantom!==true,scope=options.scope||me,stores=me.stores,i=0,storeCount,store,args,operation,callback;operation=new Ext.data.Operation(options);callback=function(operation){args=[me,operation];if(operation.wasSuccessful()){for(storeCount=stores.length;i<storeCount;i++){store=stores[i];store.remove(me,true);if(isNotPhantom){store.fireEvent('write',store,operation);}}
me.clearListeners();Ext.callback(options.success,scope,args);}else{Ext.callback(options.failure,scope,args);}
Ext.callback(options.callback,scope,args);};if(isNotPhantom){me.getProxy().destroy(operation,callback,me);}else{operation.complete=operation.success=true;operation.resultSet=me.getProxy().reader.nullResultSet;callback(operation);}
return me;}else{}};}};APP.enableSaving=function(){console.log("Marketo App > Enabling: Saving for Editors");if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.data&&Mkt3.data.Store&&Mkt3.data.Store.prototype&&Mkt3.data.Store.prototype.sync){Mkt3.data.Store.prototype.sync=function(){console.log("Marketo App > Executing: Enable Saving for Editors (sync)");if(this.autoSyncSuspended){this.autoSync=true;this.autoSyncSuspended=false;}
if(this.getProxy()instanceof Mkt3.data.proxy.AjaxPost){Mkt3.Synchronizer.sync(this);}else{this.callParent(arguments);}};}
if(typeof(Ext4)!=="undefined"&&Ext4&&Ext4.data&&Ext4.data.Model&&Ext4.data.Model.prototype&&Ext4.data.Model.prototype.destroy){Ext4.data.Model.prototype.destroy=function(options){console.log("Marketo App > Executing: Enable Saving for Editors (destroy)");options=Ext.apply({records:[this],action:'destroy'},options);var me=this,isNotPhantom=me.phantom!==true,scope=options.scope||me,stores=me.stores,i=0,storeCount,store,args,operation,callback;operation=new Ext.data.Operation(options);callback=function(operation){args=[me,operation];if(operation.wasSuccessful()){for(storeCount=stores.length;i<storeCount;i++){store=stores[i];store.remove(me,true);if(isNotPhantom){store.fireEvent('write',store,operation);}}
me.clearListeners();Ext.callback(options.success,scope,args);}else{Ext.callback(options.failure,scope,args);}
Ext.callback(options.callback,scope,args);};if(isNotPhantom){me.getProxy().destroy(operation,callback,me);}else{operation.complete=operation.success=true;operation.resultSet=me.getProxy().reader.nullResultSet;callback(operation);}
return me;};}};APP.disableSaving=function(){console.log("Marketo App > Disabling: Saving for Editors");if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.data&&Mkt3.data.Store&&Mkt3.data.Store.prototype&&Mkt3.data.Store.prototype.sync){Mkt3.data.Store.prototype.sync=function(){console.log("Marketo App > Executing: Disable Saving for Editors (sync)");};}
if(typeof(Ext4)!=="undefined"&&Ext4&&Ext4.data&&Ext4.data.Model&&Ext4.data.Model.prototype&&Ext4.data.Model.prototype.destroy){Ext4.data.Model.prototype.destroy=function(){console.log("Marketo App > Executing: Disable Saving for Editors (destroy)");};}
if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.controller&&Mkt3.controller.editor){if(Mkt3.controller.editor.email2&&Mkt3.controller.editor.email2.EmailEditor&&Mkt3.controller.editor.email2.EmailEditor.prototype&&Mkt3.controller.editor.email2.EmailEditor.prototype.changeModuleOrder){Mkt3.controller.editor.email2.EmailEditor.prototype.changeModuleOrder=function(moduleComponent,orderDelta){console.log("Marketo App > Executing: Disable Saving for Editors (changeModuleOrder)");};}
if(Mkt3.controller.editor.form&&Mkt3.controller.editor.form.settings&&Mkt3.controller.editor.form.settings.FieldSelection&&Mkt3.controller.editor.form.settings.FieldSelection.prototype&&Mkt3.controller.editor.form.settings.FieldSelection.prototype.deleteFormField){Mkt3.controller.editor.form.settings.FieldSelection.prototype.deleteFormField=function(formField){console.log("Marketo App > Executing: Enable Deleting Form Field");var formFieldWidget=formField.getFieldWidget(),formFieldId,childFieldIndex,childFormField,allFormFields;if(formFieldWidget&&formFieldWidget.get('datatype')==='fieldset'){allFormFields=this.getForm().getFormFields();formFieldId=formField.get('id');for(childFieldIndex=0;childFieldIndex<allFormFields.getCount();childFieldIndex++){childFormField=allFormFields.getAt(childFieldIndex);if(childFormField.get('fieldsetFieldId')==formFieldId){this.deleteFormField(childFormField);}}}
formField.destroy({scope:this,callback:function(field,response){if(response.success){if(formFieldWidget){formFieldWidget.destroy();}}}});this.renumberWidgets();};}}};APP.disableRequests=function(){console.log("Marketo App > Disabling: Specific Requests");if(typeof(MktSession)!=="undefined"&&MktSession&&MktSession.ajaxRequest){var origFunc=MktSession.ajaxRequest;MktSession.ajaxRequest=function(url,opts){switch(url){case"leadDatabase/updateLead":case"fieldManagement/analyticsOptionsSubmit":console.log("Marketo App > Executing: Disable Specific Requests");return null;break;case"analytics/editReportSettings":case"analytics/applyComponentFilter":case"analytics/setReportSegmentation":if(typeof(MktExplorer)!=="undefined"&&MktExplorer&&MktExplorer.getNodeById&&opts&&opts.serializeParms){if(opts.serializeParms.nodeId&&MktExplorer.getNodeById(opts.serializeParms.nodeId)&&MktExplorer.getNodeById(opts.serializeParms.nodeId).attributes&&MktExplorer.getNodeById(opts.serializeParms.nodeId).attributes.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1){console.log("Marketo App > Executing: Disable Specific Requests");return null;}else if(opts.serializeParms.reportId&&MktExplorer.getNodeById(mktoAnalyticsFragment+opts.serializeParms.reportId)&&MktExplorer.getNodeById(mktoAnalyticsFragment+opts.serializeParms.reportId).attributes&&MktExplorer.getNodeById(mktoAnalyticsFragment+opts.serializeParms.reportId).attributes.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1){console.log("Marketo App > Executing: Disable Specific Requests");return null;}}
break;}
if(url.search("^salesforce/enableSynch")!=-1){console.log("Marketo App > Executing: Disable Specific Requests");return null;};origFunc.apply(this,arguments);};}};APP.openAdBridgeModal=function(){console.log("Marketo App > Opening: Ad Bridge Modal Window");var isAdBridgeSmartList=window.setInterval(function(){if(typeof(document.getElementsByClassName("x-btn-text mkiUserTarget")[0])!=="undefined"){window.clearInterval(isAdBridgeSmartList);if(document&&document.getElementsByClassName("x-btn-text mkiUserTarget")&&document.getElementsByClassName("x-btn-text mkiUserTarget")[0]&&document.getElementsByClassName("x-btn-text mkiUserTarget")[0].type=="button"){console.log("Marketo App > Executing: Open Ad Bridge Modal Window");document.getElementsByClassName("x-btn-text mkiUserTarget")[0].click();}}},0);};APP.resetGoldenLandingPageProps=function(){console.log("Marketo App > Resetting: Golden Landing Pages Properties/Variables");if(typeof(MktSecurity)!=="undefined"&&MktSecurity&&MktSecurity.getXsrfId()){switch(currUrlFragment){case mktoDefaultDiyLandingPageResponsiveEditFragment:console.log("Marketo App > Executing: Resetting Landing Page Responsive Properties/Variables");APP.webRequest('https://'+mktoDesignerHost+'/data/landingPage/update?context=LPE11822&data=%5B%7B%22id%22%3A11822%2C%22responsiveOptions%22%3A%7B%22variables%22%3A%7B%22gradient1%22%3A%22%232A5370%22%2C%22gradient2%22%3A%22%23F2F2F2%22%2C%22showSection2%22%3Atrue%2C%22showSection3%22%3Atrue%2C%22showSection4%22%3Atrue%2C%22showFooter%22%3Atrue%2C%22showSocialButtons%22%3Atrue%2C%22section4ButtonLabel%22%3A%22Need%20More%20Info%3F%22%2C%22section4ButtonLink%22%3A%22%23%22%2C%22section3LeftButtonLabel%22%3A%22Join%20Us%22%2C%22section4BgColor%22%3A%22%23F2F2F2%22%2C%22footerBgColor%22%3A%22%232A5370%22%2C%22section2BgColor%22%3A%22%23F2F2F2%22%2C%22section3BgColor%22%3A%22%232A5370%22%2C%22section3LeftButtonLink%22%3A%22https%3A%2F%2Fwww.marketo.com%22%2C%22section3RightButtonLabel%22%3A%22Sign%20Up%22%7D%7D%7D%5D&xsrfId='+MktSecurity.getXsrfId(),null,'POST',true,"",function(result){console.log(result);});break;}}};APP.discardLandingPageDrafts=function(lpIds){console.log("Marketo App > Discarding: Landing Page Drafts");if(typeof(mktLPLManager)!=="undefined"&&mktLPLManager&&mktLPLManager.doModifyPages){console.log("Marketo App > Executing: Discard Landing Page Drafts");var ii,prevForbiddenMsg,prevNotFoundMsg,prevSystemErrorMsg,lpMessageBox=Ext.MessageBox.show({title:"MarketoLive",msg:"Discarding Landing Page Drafts",progress:false,wait:false,width:270,closable:true});if(typeof(MktMessage)!=="undefined"&&MktMessage){if(MktMessage.show403Forbidden){prevForbiddenMsg=MktMessage.show403Forbidden;MktMessage.show403Forbidden=function(){};}
if(MktMessage.showNotFound){prevNotFoundMsg=MktMessage.showNotFound;MktMessage.showNotFound=function(){};}
if(MktMessage.showSystemError){prevSystemErrorMsg=MktMessage.showSystemError;MktMessage.showSystemError=function(){};}}
for(ii=0;ii<Object.keys(lpIds).length;ii++){var lpIdKey=Object.keys(lpIds)[ii],lpIdVal=lpIds[lpIdKey];mktLPLManager.doModifyPages('revert',{[lpIdKey]:lpIdVal,beForDemoAccount:true});if(lpMessageBox&&lpMessageBox.hide){lpMessageBox.hide();}}
console.log("Marketo App > Finished: Discarding Landing Pages");window.setTimeout(function(){console.log("Marketo App > Re-enabling: System Messages");MktMessage.show403Forbidden=prevForbiddenMsg;MktMessage.showNotFound=prevNotFoundMsg;MktMessage.showSystemError=prevSystemErrorMsg;},15000);}};APP.discardEmailDrafts=function(emIds){console.log("Marketo App > Discarding: Email Drafts");if(typeof(mktEmManager)!=="undefined"&&mktEmManager&&mktEmManager.discardDraft){console.log("Marketo App > Executing: Discard Email Drafts");var emMessageBox=Ext.MessageBox.show({title:"MarketoLive",msg:"Discarding Email Drafts",progress:false,wait:false,width:270,closable:true});mktEmManager.discardDraft(emIds);if(emMessageBox&&emMessageBox.hide){emMessageBox.hide();}}};APP.discardOtherDrafts=function(assetType,assetIds){console.log("Marketo App > Discarding: "+assetType+" Drafts");if(typeof(Ext4)!=="undefined"&&Ext4&&Ext4.getStore&&Ext4.create&&typeof(Mkt3)!=="undefined"&&Mkt3){console.log("Marketo App > Executing: Discard "+assetType+" Drafts");var assetStore=Ext4.getStore(assetType),otherMessageBox=Ext.MessageBox.show({title:"MarketoLive",msg:"Discarding Other Drafts",progress:false,wait:false,width:270,closable:true});if(otherMessageBox&&otherMessageBox.hide){otherMessageBox.hide();}
if(!assetStore){assetStore=Ext4.create('Mkt3.store.'+assetType,{storeId:assetType});}
assetStore.load({filters:[{property:'id',value:assetIds}],callback:function(assets){for(var i=0;i<assets.length;i++){var asset=assets[i];asset.discard(function(success){if(success){asset.updateNode();}},this);}}});}};APP.discardDrafts=function(accountString,assetType){console.log("Marketo App > Discarding: Golden Assets for instance: "+accountString);var lpIds={},emIds=[],formIds=[],pushIds=[],inAppIds=[],smsIds=[],socIds=[];switch(accountString){case mktoAccountString106:lpIds["dpageid_11826"]="dpageid_11826";lpIds["dpageid_11822"]="dpageid_11822";lpIds["dpageid_8819"]="dpageid_8819";lpIds["dpageid_8941"]="dpageid_8941";lpIds["dpageid_4876"]="dpageid_4876";lpIds["dpageid_4872"]="dpageid_4872";lpIds["dpageid_4874"]="dpageid_4874";emIds.push(15464);emIds.push(21424);emIds.push(20931);emIds.push(18113,18106,18111,18110);emIds.push(10010,10179,10180,12845,10181,10182,10183,10184);emIds.push(4894,3764,3765,3767,3766,3762);emIds.push(12818,12820,12819,12816,12811,12815,12812,12813,12814,12821,12817,12823);emIds.push(12900,12901,12899,12898);emIds.push(12902,12903,12904);formIds.push(3576,1749,1900);pushIds.push(29,23);inAppIds.push(309,446);smsIds.push(1);socIds.push(587,491,484);lpIds["dpageid_11856"]="dpageid_11856";lpIds["dpageid_12420"]="dpageid_12420";lpIds["dpageid_12418"]="dpageid_12418";lpIds["dpageid_11552"]="dpageid_11552";lpIds["dpageid_11550"]="dpageid_11550";lpIds["dpageid_11553"]="dpageid_11553";lpIds["dpageid_12345"]="dpageid_12345";lpIds["dpageid_11556"]="dpageid_11556";emIds.push(16474);emIds.push(18117,18118,18122,18119,18116,18123,18120,18121,18124);emIds.push(16118,16119,16120,16122,16121,16117);emIds.push(16331,16332,16338,16333,16123,16339,16335,16336,17868);emIds.push(16125,16129,16126,16124,16132,16131,16130,16128,16127,16133,16137,16136);emIds.push(18126);formIds.push(3018,3708,3020,3021);pushIds.push(99,216,103,218);socIds.push(853);lpIds["dpageid_13187"]="dpageid_13187";lpIds["dpageid_13185"]="dpageid_13185";lpIds["dpageid_12709"]="dpageid_12709";lpIds["dpageid_12720"]="dpageid_12720";lpIds["dpageid_12717"]="dpageid_12717";lpIds["dpageid_12719"]="dpageid_12719";emIds.push(22818);emIds.push(20350,20368);formIds.push(4970,4968,4969);formIds.push(3952,4476,3953);pushIds.push(465,189);inAppIds.push(464);inAppIds.push(448);socIds.push(1238,1239,1240,1241,1242);socIds.push(1091,1090,1093,1092,1094);lpIds["dpageid_12569"]="dpageid_12569";lpIds["dpageid_12932"]="dpageid_12932";lpIds["dpageid_13165"]="dpageid_13165";lpIds["dpageid_12586"]="dpageid_12586";lpIds["dpageid_12517"]="dpageid_12517";emIds.push(20327,21812);formIds.push(3816,3818,3828);pushIds.push(164);inAppIds.push(449);socIds.push(1021,1023,1025,1022,1020);lpIds["dpageid_12250"]="dpageid_12250";lpIds["dpageid_12934"]="dpageid_12934";lpIds["dpageid_12401"]="dpageid_12401";lpIds["dpageid_13167"]="dpageid_13167";lpIds["dpageid_12248"]="dpageid_12248";lpIds["dpageid_12177"]="dpageid_12177";emIds.push(20329);formIds.push(3313,4125,3559);pushIds.push(132);inAppIds.push(450);socIds.push(860,1024,861,859,858);break;case mktoAccountString106d:lpIds["dpageid_11826"]="dpageid_11826";lpIds["dpageid_11822"]="dpageid_11822";lpIds["dpageid_8819"]="dpageid_8819";lpIds["dpageid_8941"]="dpageid_8941";lpIds["dpageid_4876"]="dpageid_4876";lpIds["dpageid_4872"]="dpageid_4872";lpIds["dpageid_4874"]="dpageid_4874";emIds.push(15464);emIds.push(18113,18106,18111,18110);emIds.push(10010,10179,10180,12845,10181,10182,10183,10184);emIds.push(4894,3764,3765,3767,3766,3762);emIds.push(12818,12820,12819,12816,12811,12815,12812,12813,12814,12821,12817,12823);emIds.push(12900,12901,12899,12898);emIds.push(12902,12903,12904);formIds.push(3576,1749,1900);pushIds.push(29,23);socIds.push(586,587,491,484);lpIds["dpageid_11856"]="dpageid_11856";lpIds["dpageid_12420"]="dpageid_12420";lpIds["dpageid_12418"]="dpageid_12418";lpIds["dpageid_11552"]="dpageid_11552";lpIds["dpageid_11550"]="dpageid_11550";lpIds["dpageid_11553"]="dpageid_11553";lpIds["dpageid_12345"]="dpageid_12345";lpIds["dpageid_11556"]="dpageid_11556";emIds.push(16474,17254,16403);emIds.push(18117,18118,18122,18119,18116,18123,18120,18121,18124);emIds.push(16118,16119,16120,16122,16121,16117);emIds.push(16331,16332,16338,16333,16123,16339,16335,16336,17868);emIds.push(16125,16129,16126,16124,16132,16131,16130,16128,16127,16133,16137,16136);emIds.push(18126);formIds.push(3018,3708,3020,3021);pushIds.push(99,216,103,218);socIds.push(853);lpIds["dpageid_13187"]="dpageid_13187";lpIds["dpageid_13185"]="dpageid_13185";lpIds["dpageid_12709"]="dpageid_12709";lpIds["dpageid_12720"]="dpageid_12720";lpIds["dpageid_12717"]="dpageid_12717";lpIds["dpageid_12719"]="dpageid_12719";emIds.push(20350,20368);formIds.push(3952,3955,3953);pushIds.push(187);socIds.push(1091,1090,1093,1092,1094);lpIds["dpageid_12569"]="dpageid_12569";lpIds["dpageid_12932"]="dpageid_12932";lpIds["dpageid_13165"]="dpageid_13165";lpIds["dpageid_12586"]="dpageid_12586";lpIds["dpageid_12517"]="dpageid_12517";emIds.push(20327);formIds.push(3816,3818,3828);pushIds.push(169);socIds.push(1021,1023,1025,1022,1020);lpIds["dpageid_12250"]="dpageid_12250";lpIds["dpageid_12934"]="dpageid_12934";lpIds["dpageid_12401"]="dpageid_12401";lpIds["dpageid_13167"]="dpageid_13167";lpIds["dpageid_12248"]="dpageid_12248";lpIds["dpageid_12177"]="dpageid_12177";emIds.push(20329);formIds.push(3313,4125,3559);pushIds.push(131);socIds.push(860,1024,861,859,858);lpIds["dpageid_13280"]="dpageid_13280";lpIds["dpageid_13278"]="dpageid_13278";lpIds["dpageid_13276"]="dpageid_13276";lpIds["dpageid_13503"]="dpageid_13503";lpIds["dpageid_13505"]="dpageid_13505";lpIds["dpageid_13283"]="dpageid_13283";lpIds["dpageid_13282"]="dpageid_13282";lpIds["dpageid_13289"]="dpageid_13289";lpIds["dpageid_13286"]="dpageid_13286";lpIds["dpageid_13288"]="dpageid_13288";lpIds["dpageid_13346"]="dpageid_13346";lpIds["dpageid_13345"]="dpageid_13345";lpIds["dpageid_13347"]="dpageid_13347";lpIds["dpageid_13319"]="dpageid_13319";lpIds["dpageid_13332"]="dpageid_13332";lpIds["dpageid_13329"]="dpageid_13329";lpIds["dpageid_13331"]="dpageid_13331";lpIds["dpageid_13528"]="dpageid_13528";lpIds["dpageid_13563"]="dpageid_13563";lpIds["dpageid_13529"]="dpageid_13529";lpIds["dpageid_13475"]="dpageid_13475";break;}
switch(assetType){case"landingPage":var canDiscardLandingPageDrafts=window.setInterval(function(){if(typeof(mktLPLManager)!=="undefined"&&mktLPLManager){window.clearInterval(canDiscardLandingPageDrafts);APP.discardLandingPageDrafts(lpIds);}},0);break;case"email":var canDiscardEmailDrafts=window.setInterval(function(){if(typeof(mktEmManager)!=="undefined"&&mktEmManager.discardDraft){window.clearInterval(canDiscardEmailDrafts);APP.discardEmailDrafts(emIds);}},0);break;case"other":var canDiscardOtherDrafts=window.setInterval(function(){if(typeof(Ext4)!=="undefined"&&Ext4&&Ext4.getStore&&Ext4.create&&typeof(Mkt3)!=="undefined"&&Mkt3){window.clearInterval(canDiscardOtherDrafts);APP.discardOtherDrafts("Form",formIds);APP.discardOtherDrafts("MobilePushNotification",pushIds);APP.discardOtherDrafts("InAppMessage",inAppIds);APP.discardOtherDrafts("SmsMessage",smsIds);APP.discardOtherDrafts("SocialApp",socIds);}},0);break;case"all":var canDiscardLandingPageDrafts,canDiscardEmailDrafts,canDiscardOtherDrafts;canDiscardLandingPageDrafts=window.setInterval(function(){if(typeof(mktLPLManager)!=="undefined"&&mktLPLManager){window.clearInterval(canDiscardLandingPageDrafts);APP.discardLandingPageDrafts(lpIds);}},0);canDiscardEmailDrafts=window.setInterval(function(){if(typeof(mktEmManager)!=="undefined"&&mktEmManager.discardDraft){window.clearInterval(canDiscardEmailDrafts);APP.discardEmailDrafts(emIds);}},0);canDiscardOtherDrafts=window.setInterval(function(){if(typeof(Ext4)!=="undefined"&&Ext4&&Ext4.getStore&&Ext4.create&&typeof(Mkt3)!=="undefined"&&Mkt3){window.clearInterval(canDiscardOtherDrafts);APP.discardOtherDrafts("Form",formIds);APP.discardOtherDrafts("MobilePushNotification",pushIds);APP.discardOtherDrafts("InAppMessage",inAppIds);APP.discardOtherDrafts("SmsMessage",smsIds);APP.discardOtherDrafts("SocialApp",socIds);}},0);break;}}
APP.trackNodeClick=function(){console.log("Marketo App > Tracking: Tree Node Click");if(typeof(Ext)!=="undefined"&&Ext&&Ext.tree&&Ext.tree.TreeEventModel&&Ext.tree.TreeEventModel.prototype&&Ext.tree.TreeEventModel.prototype.onNodeClick){Ext.tree.TreeEventModel.prototype.onNodeClick=function(e,node){if(node&&node.text&&node.attributes&&node.attributes.accessZoneId){var currNode=node,heapEvent={name:"",assetName:currNode.text,assetId:currNode.attributes.id,assetType:currNode.attributes.compType,assetPath:"",workspaceId:currNode.attributes.accessZoneId,workspaceName:""};heapEvent.assetPath=currNode.text;for(var ii=0;ii<node.getDepth()-1;ii++){currNode=currNode.parentNode;heapEvent.assetPath=currNode.text+" > "+heapEvent.assetPath;}
heapEvent.workspaceName=APP.getWorkspaceName(currNode.attributes.accessZoneId);if(currNode.attributes.accessZoneId.toString().search(mktoGoldenWorkspacesMatch)!=-1){heapEvent.name=heapEvent.workspaceName;if(heapEvent.workspaceName=="Admin"){heapEvent.assetType="Admin Area";heapEvent.workspaceId=0;}}else if(currNode.attributes.accessZoneId==mktoUserWorkspaceId){heapEvent.name=heapEvent.workspaceName;heapEvent.userFolder=userName;}else{heapEvent.name="User's Workspace"}
APP.heapTrack("track",heapEvent);}
node.ui.onClick(e);}}};APP.heapTrack=function(action,event){var isHeapAnalytics=window.setInterval(function(){if(typeof(heap)!=="undefined"&&heap){window.clearInterval(isHeapAnalytics);switch(action){case"id":var oneLoginEmail=APP.getCookie("onelogin_email"),oneLoginFirstName=APP.getCookie("onelogin_first_name"),oneLoginLastName=APP.getCookie("onelogin_last_name");if(MktPage&&MktPage.userid){console.log("Marketo App > Heap Analytics ID: "+MktPage.userid);heap.identify(MktPage.userid);}
if(oneLoginFirstName&&oneLoginLastName){heap.addUserProperties({Name:oneLoginFirstName+" "+oneLoginLastName});}else if(MktPage&&MktPage.userName){heap.addUserProperties({Name:MktPage.userName.replace(/ ?\[[^\]]+\]/,"")});}
if(MktPage&&MktPage.userName){var roleSubstring=MktPage.userName.search(/\[[^\]]+\]/);if(roleSubstring!=-1){heap.addUserProperties({Role:MktPage.userName.substring(roleSubstring).replace(/^\[([^\]]+)]$/,"$1")});}}
if(oneLoginEmail){heap.addUserProperties({Email:oneLoginEmail});}
if(MktPage&&MktPage.savedState&&MktPage.savedState.custPrefix){if(MktPage.savedState.custPrefix==mktoAccountString106){heap.addUserProperties({Environment:"Internal"});}else if(MktPage.savedState.custPrefix==mktoAccountString106d){heap.addUserProperties({Environment:"Partner"});}else if(MktPage.savedState.custPrefix==mktoAccountStringMaster){heap.addUserProperties({Environment:"Master"});}}
break;case"track":var heapApp,heapArea,heapEventProps;if(MktPage&&MktPage.friendlyName){heapApp=MktPage.friendlyName;}else{heapApp="Marketo";}
if(MktPage&&MktPage.baseTitle){heapArea=MktPage.baseTitle.split("•")[0].trimRight();}else{heapArea="Unknown";}
if(event){heapEventProps={app:heapApp,assetName:event.assetName,assetId:event.assetId,assetType:event.assetType,assetPath:event.assetPath,workspaceId:event.workspaceId,workspaceName:event.workspaceName,userFolder:event.userFolder,area:"",environment:"",url:currentUrl};if(event.assetArea){heapEventProps.area=event.assetArea;}else{heapEventProps.area=heapArea;}
if(MktPage&&MktPage.savedState&&MktPage.savedState.custPrefix){if(MktPage.savedState.custPrefix==mktoAccountString106){heapEventProps.environment="Internal";}else if(MktPage.savedState.custPrefix==mktoAccountString106d){heapEventProps.environment="Partner";}else if(MktPage.savedState.custPrefix==mktoAccountStringMaster){heapEventProps.environment="Master";}}
console.log("Marketo App > Tracking: Heap Event: "+event.name+"\n"+JSON.stringify(heapEventProps,null,2));heap.track(event.name,heapEventProps);}
break;}}},0);};var toggleState=APP.getCookie("toggleState");if(toggleState==null){toggleState=true;}
var isMktPageApp=window.setInterval(function(){if(typeof(MktPage)!=="undefined"){console.log("Marketo App > Location: Marketo Page");var userId;if(MktPage.savedState&&MktPage.savedState.custPrefix&&MktPage.savedState.custPrefix!=""&&MktPage.userid&&MktPage.userid!=""&&Mkt3&&Mkt3.DL&&Mkt3.DL.getDlToken()&&Mkt3.DL.getDlToken()!=""){window.clearInterval(isMktPageApp);accountString=MktPage.savedState.custPrefix;userId=MktPage.userid.toLowerCase();currUrlFragment=Mkt3.DL.getDlToken();if(Mkt3.DL.dl&&Mkt3.DL.dl.dlCompCode){currCompFragment=Mkt3.DL.dl.dlCompCode;}
if(userId.search("\.demo@marketo.com$")!=-1){userName=userId.split(".demo")[0];}else{userName=userId.split("@")[0];if(userName=="marketolive"){userName=userId.split("@")[1].split(".")[0];}}}
if(userId&&userId.search(adminUserNamesMatch)!=-1){console.log("Marketo App > User: Admin");APP.validateDemoExtensionCheck(true);APP.applyMassClone();if(toggleState!="false"){return;}else{console.log("Marketo App > User: Admin is now a normal user");}}
chrome.runtime.sendMessage(extensionId,{action:"checkExtensionVersion",minVersion:extensionMinVersion},null,function(response){if(response==null||response.isValidExtension){chrome.runtime.sendMessage(extensionId,{action:"checkBadExtension"},null,function(response){if(response!=null&&response.isValidExtension!=null){APP.validateDemoExtensionCheck(response.isValidExtension);APP.overrideSuperballMenuItems(response.isValidExtension);restoreEmailInsights=true;if(currUrlFragment&&currUrlFragment==mktoMyMarketoFragment){APP.overrideHomeTiles(response.isValidExtension);}}else{APP.validateDemoExtensionCheck(true);}});}else{APP.validateDemoExtensionCheck(false);}});if(MktPage.userid&&MktPage.userName){var mktoRole=MktPage.userName.match(/\[[^\]]+\]/);if(mktoRole!=null){mktoRole=mktoRole[0].replace(/^\[([^\]]+)]$/,"$1");}
chrome.runtime.sendMessage(extensionId,{action:"setMktoCookies",mktoUserId:MktPage.userid,mktoName:MktPage.userName.replace(/ ?\[[^\]]+\]/,""),mktoRole:mktoRole},null,function(response){console.log();});}
if(currUrlFragment){if(currUrlFragment==mktoMyMarketoFragment){APP.overrideHomeTiles(restoreEmailInsights);APP.heapTrack("track",{name:"My Marketo",assetName:"Home"});}else if(currUrlFragment.search(mktoDisableButtonsFragmentMatch)!=-1){APP.disableButtons();}else if(currUrlFragment==mktoAnalyticsDefaultFragment){APP.overrideAnalyticsTiles();}else if(currUrlFragment==mktoAdBridgeSmartListFragment){console.log("Marketo App > Location: Ad Bridge Smart List");APP.openAdBridgeModal();}else if(currUrlFragment==mktoAdminSalesforceFragment){console.log("Marketo App > Location: Admin > Salesforce");APP.hideOtherToolbarItems([{id:"enableSync",action:"setVisible"}]);}else if(currUrlFragment==mktoAdminRcaCustomFieldSync){console.log("Marketo App > Location: Admin > Revenue Cycle Analytics > Custom Field Sync");APP.hideOtherToolbarItems([{id:"cadChangeButton",action:"setVisible"}]);}}
if(currUrlFragment&&currUrlFragment.search(mktoAnalyticsFragmentMatch)==-1&&(!currCompFragment||(currCompFragment.search(mktoAbmFragmentMatch)==-1&&currCompFragment.search(mktoDesignersFragmentMatch)==-1))){if(accountString.search(mktoAccountStringsMatch)!=-1){APP.overrideTreeNodeExpand();APP.overrideTreeNodeCollapse();APP.overrideSaving();APP.disableDragAndDrop();APP.disableMenus();APP.hideToolbarItems();APP.overrideDraftEdits();APP.disableFormSaveButtons();APP.disableAdminSaveButtons();APP.overrideSmartCampaignSaving();APP.trackNodeClick();APP.overrideUpdatePortletOrder();APP.overrideNewProgramCreate();APP.overrideAssetSaveEdit();APP.overrideNewAssetCreate();APP.overrideNewFolders();APP.overrideRenamingFolders();APP.hideFoldersOnImport();APP.disableConfirmationMessage();APP.disableRequests();APP.heapTrack("track",{name:"Last Loaded",assetName:"Page"});}else if(accountString==mktoAccountStringMaster){APP.overrideTreeNodeExpand();APP.overrideTreeNodeCollapse();APP.overrideSaving();APP.disableDragAndDrop();APP.disableMenus();APP.hideToolbarItems();APP.overrideDraftEdits();APP.disableFormSaveButtons();APP.disableAdminSaveButtons();APP.overrideSmartCampaignSaving();APP.trackNodeClick();APP.overrideUpdatePortletOrder();APP.disableConfirmationMessage();APP.disableRequests();APP.heapTrack("track",{name:"Last Loaded",assetName:"Page"});}else if(accountString==mktoAccountStringQe){APP.disableMenus();APP.hideToolbarItems();APP.disableFormSaveButtons();APP.disableAdminSaveButtons();}else if(toggleState=="false"){APP.overrideSaving();APP.overrideSmartCampaignSaving();APP.overrideUpdatePortletOrder();APP.disableConfirmationMessage();}}else if(currCompFragment){console.log("Marketo App > Location: Designers, ABM Areas");switch(currCompFragment){case mktoAbmDiscoverMarketoCompaniesFragment:case mktoAbmDiscoverCrmAccountsFragment:case mktoAbmNamedAccountFragment:console.log("Marketo App > Location: Account Based Marketing Areas");APP.disableMenus();APP.hideToolbarItems();APP.disableFormSaveButtons();APP.disableAdminSaveButtons();APP.heapTrack("track",{name:"Last Loaded",assetName:"Page"});break;case mktoLandingPageEditFragment:console.log("Marketo App > Location: Landing Page Editor");APP.resetGoldenLandingPageProps();APP.disableDesignerSaving("landingPage","edit");break;case mktoLandingPagePreviewFragment:console.log("Marketo App > Location: Landing Page Previewer");APP.disableDesignerSaving("landingPage","preview");break;case mktoLandingPagePreviewDraftFragment:console.log("Marketo App > Location: Landing Page Draft Previewer");APP.disableDesignerSaving("landingPage","preview");break;case mktoLandingPageTemplateEditFragment:console.log("Marketo App > Location: Landing Page Template Editor");APP.disableDesignerSaving("landingPage","templateEdit");break;case mktoLandingPageTemplatePreviewFragment:console.log("Marketo App > Location: Landing Page Template Previewer");APP.disableDesignerSaving("landingPage","templatePreview");break;case mktoEmailEditFragment:if(currUrlFragment==mktoEmailEditFragment){console.log("Marketo App > Location: Email Template Picker");APP.disableDesignerSaving("email","templatePicker");}else if(currUrlFragment.search(mktoEmailPreviewFragmentRegex)==-1){console.log("Marketo App > Location: Email Editor");APP.disableDesignerSaving("email","edit");}else{console.log("Marketo App > Location: Email Previewer");APP.disableDesignerSaving("email","preview");}
break;case mktoEmailTemplateEditFragment:console.log("Marketo App > Location: Email Template Editor");APP.disableDesignerSaving("email","templateEdit");break;case mktoFormEditFragment:console.log("Marketo App > Location: Form Editor");APP.disableDesignerSaving("form","edit");break;case mktoFormPreviewFragment:console.log("Marketo App > Location: Form Previewer");APP.disableDesignerSaving("form","preview");break;case mktoFormPreviewDraftFragment:console.log("Marketo App > Location: Form Draft Previewer");APP.disableDesignerSaving("form","preview");break;case mktoPushNotificationEditFragment:console.log("Marketo App > Location: Push Notification Editor");APP.disableDesignerSaving("pushNotification","edit");break;case mktoMobilePushNotificationPreviewFragment:console.log("Marketo App > Location: Push Notification Previewer");APP.disableDesignerSaving("pushNotification","preview");break;case mktoInAppMessageEditFragment:console.log("Marketo App > Location: In-App Message Editor");APP.disableDesignerSaving("inAppMessage","edit");break;case mktoInAppMessagePreviewFragment:console.log("Marketo App > Location: In-App Message Previewer");APP.disableDesignerSaving("inAppMessage","preview");break;case mktoSmsMessageEditFragment:console.log("Marketo App > Location: SMS Message Editor");APP.disableDesignerSaving("smsMessage","edit");break;case mktoSocialAppEditFragment:console.log("Marketo App > Location: Social App Editor");APP.disableDesignerSaving("socialApp","edit");break;case mktoSocialAppPreviewFragment:console.log("Marketo App > Location: Social App Previewer");APP.disableDesignerSaving("socialApp","preview");break;case mktoAbTestEditFragment:console.log("Marketo App > Location: A/B Test Wizard");APP.disableDesignerSaving("abTest","edit");break;case mktoEmailTestGroupEditFragment:console.log("Marketo App > Location: Email Test Group Wizard");APP.disableDesignerSaving("abTest","edit");break;case mktoSnippetEditFragment:console.log("Marketo App > Location: Snippet Editor");APP.disableDesignerSaving("snippet","edit");break;case mktoSnippetPreviewFragment:console.log("Marketo App > Location: Snippet Previewer");APP.disableDesignerSaving("snippet","preview");break;default:break;}}else if(currUrlFragment&&currUrlFragment.search(mktoAnalyticsFragmentMatch)!=-1){if(currUrlFragment.search(mktoAnalyzersFragmentMatch)!=-1){console.log("Marketo App > Location: Golden Analytics");APP.injectAnalyzerNavBar();}
if(currUrlFragment.search(mktoReportFragmentRegex)!=-1){console.log("Marketo App > Location: Fullscreen Report");APP.disableAnalyticsSaving("report");}else if(currUrlFragment.search(mktoModelerFragmentRegex)!=-1){if(currentUrl.search(mktoModelerPreviewFragmentRegex)==-1){console.log("Marketo App > Location: Revenue Cycle Model Editor");APP.disableAnalyticsSaving("model","edit");}else{console.log("Marketo App > Location: Revenue Cycle Model Previewer");APP.disableAnalyticsSaving("model","preview");}}}else if(document.location.pathname==mktoPersonDetailPath){console.log("Marketo App > Location: Lead Database > Person Detail");window.clearInterval(isMktPageApp);APP.disableRequests();APP.heapTrack("track",{name:"Last Loaded",assetName:"Page"});}
window.onhashchange=function(){console.log("Marketo App > Window: Hash Changed");currentUrl=window.location.href;var isNewUrlFragment=window.setInterval(function(){if(typeof(Mkt3)!=="undefined"&&Mkt3&&Mkt3.DL&&Mkt3.DL.getDlToken()){if(currUrlFragment!=Mkt3.DL.getDlToken()){window.clearInterval(isNewUrlFragment);currUrlFragment=Mkt3.DL.getDlToken();console.log("Marketo App > Loaded: New URL Fragment = "+currUrlFragment);if(currUrlFragment==mktoMyMarketoFragment){APP.overrideHomeTiles(restoreEmailInsights);APP.heapTrack("track",{name:"My Marketo",assetName:"Home"});}else if(currUrlFragment.search(mktoDisableButtonsFragmentMatch)!=-1){APP.disableButtons();}else if(currUrlFragment==mktoAnalyticsDefaultFragment){APP.overrideAnalyticsTiles();}else if(currUrlFragment==mktoAdminSalesforceFragment){console.log("Marketo App > Location: Admin > Salesforce");APP.hideOtherToolbarItems([{id:"enableSync",action:"setVisible"}]);}else if(currUrlFragment==mktoAdminRcaCustomFieldSync){console.log("Marketo App > Location: Admin > Revenue Cycle Analytics > Custom Field Sync");APP.hideOtherToolbarItems([{id:"cadChangeButton",action:"setVisible"}]);}
if(Mkt3.DL.dl&&Mkt3.DL.dl.dlCompCode){currCompFragment=Mkt3.DL.dl.dlCompCode;if(currCompFragment.search(mktoDesignersFragmentMatch)!=-1){console.log("Marketo App > Location: Designers/Wizards");switch(currCompFragment){case mktoLandingPageEditFragment:console.log("Marketo App > Location: Landing Page Editor");APP.resetGoldenLandingPageProps();APP.disableDesignerSaving("landingPage","edit");break;case mktoLandingPagePreviewFragment:console.log("Marketo App > Location: Landing Page Previewer");APP.disableDesignerSaving("landingPage","preview");break;case mktoLandingPagePreviewDraftFragment:console.log("Marketo App > Location: Landing Page Draft Previewer");APP.disableDesignerSaving("landingPage","preview");break;case mktoLandingPageTemplateEditFragment:console.log("Marketo App > Location: Landing Page Template Editor");APP.disableDesignerSaving("landingPage","templateEdit");break;case mktoLandingPageTemplatePreviewFragment:console.log("Marketo App > Location: Landing Page Template Previewer");APP.disableDesignerSaving("landingPage","templatePreview");break;case mktoEmailEditFragment:if(currUrlFragment==mktoEmailEditFragment){console.log("Marketo App > Location: Email Template Picker");APP.disableDesignerSaving("email","templatePicker");}else if(currUrlFragment.search(mktoEmailPreviewFragmentRegex)==-1){console.log("Marketo App > Location: Email Editor");APP.disableDesignerSaving("email","edit");}else{console.log("Marketo App > Location: Email Previewer");APP.disableDesignerSaving("email","preview");}
break;case mktoEmailTemplateEditFragment:console.log("Marketo App > Location: Email Template Editor");APP.disableDesignerSaving("email","templateEdit");break;case mktoFormEditFragment:console.log("Marketo App > Location: Form Editor");APP.disableDesignerSaving("form","edit");break;case mktoFormPreviewFragment:console.log("Marketo App > Location: Form Previewer");APP.disableDesignerSaving("form","preview");break;case mktoFormPreviewDraftFragment:console.log("Marketo App > Location: Form Draft Previewer");APP.disableDesignerSaving("form","preview");break;case mktoPushNotificationEditFragment:console.log("Marketo App > Location: Push Notification Editor");APP.disableDesignerSaving("pushNotification","edit");break;case mktoMobilePushNotificationPreviewFragment:console.log("Marketo App > Location: Push Notification Previewer");APP.disableDesignerSaving("pushNotification","preview");break;case mktoInAppMessageEditFragment:console.log("Marketo App > Location: In-App Message Editor");APP.disableDesignerSaving("inAppMessage","edit");break;case mktoInAppMessagePreviewFragment:console.log("Marketo App > Location: In-App Message Previewer");APP.disableDesignerSaving("inAppMessage","preview");break;case mktoSmsMessageEditFragment:console.log("Marketo App > Location: SMS Message Editor");APP.disableDesignerSaving("smsMessage","edit");break;case mktoSocialAppEditFragment:console.log("Marketo App > Location: Social App Editor");APP.disableDesignerSaving("socialApp","edit");break;case mktoSocialAppPreviewFragment:console.log("Marketo App > Location: Social App Previewer");APP.disableDesignerSaving("socialApp","preview");break;case mktoAbTestEditFragment:console.log("Marketo App > Location: A/B Test Wizard");APP.disableDesignerSaving("abTest","edit");break;case mktoEmailTestGroupEditFragment:console.log("Marketo App > Location: Email Test Group Wizard");APP.disableDesignerSaving("abTest","edit");break;case mktoSnippetEditFragment:console.log("Marketo App > Location: Snippet Editor");APP.disableDesignerSaving("snippet","edit");break;case mktoSnippetPreviewFragment:console.log("Marketo App > Location: Snippet Previewer");APP.disableDesignerSaving("snippet","preview");break;default:break;}}}}}},0);};APP.overrideSuperballMenuItems();APP.heapTrack("id");}},0);